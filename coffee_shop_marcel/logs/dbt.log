[0m03:24:53.986831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7b132abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7afdbfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7afdbfc40>]}


============================== 03:24:53.989680 | e11144c9-0c4c-4117-a566-88b32f31c216 ==============================
[0m03:24:53.989680 [info ] [MainThread]: Running with dbt=1.5.2
[0m03:24:53.990490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m03:24:54.355851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e11144c9-0c4c-4117-a566-88b32f31c216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ae2ae860>]}
[0m03:24:54.373132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e11144c9-0c4c-4117-a566-88b32f31c216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ae2e14b0>]}
[0m03:24:54.374014 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m03:24:54.385407 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m03:24:54.386116 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:24:54.386853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e11144c9-0c4c-4117-a566-88b32f31c216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ae2e0250>]}
[0m03:24:55.248696 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m03:24:55.263792 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m03:24:55.347000 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_marcel.example
[0m03:24:55.353362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e11144c9-0c4c-4117-a566-88b32f31c216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7adc542b0>]}
[0m03:24:55.361290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e11144c9-0c4c-4117-a566-88b32f31c216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ae2e2f50>]}
[0m03:24:55.361910 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m03:24:55.362729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e11144c9-0c4c-4117-a566-88b32f31c216', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ae206200>]}
[0m03:24:55.364723 [info ] [MainThread]: 
[0m03:24:55.365830 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:24:55.367415 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m03:24:55.368016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:04.378742 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
  '
[0m03:25:04.380941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:25:04.381448 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m03:25:04.382007 [info ] [MainThread]: 
[0m03:25:04.382743 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 9.02 seconds (9.02s).
[0m03:25:04.383846 [error] [MainThread]: Encountered an error:
Database Error
  Runtime Error
    
    dbt encountered an error while trying to read your profiles.yml file.
    
    Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
    
[0m03:25:04.385292 [debug] [MainThread]: Command `dbt run` failed at 03:25:04.385066 after 10.41 seconds
[0m03:25:04.386122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7b132abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7adc54b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7adc557b0>]}
[0m03:25:04.387290 [debug] [MainThread]: Flushing usage events
[0m03:28:03.256395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc799102b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc797bbfd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc797bbfbe0>]}


============================== 03:28:03.262744 | 25246403-16c3-43ab-8d61-7ac4d38f7ed2 ==============================
[0m03:28:03.262744 [info ] [MainThread]: Running with dbt=1.5.2
[0m03:28:03.263784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m03:28:03.640791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25246403-16c3-43ab-8d61-7ac4d38f7ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7960a5c90>]}
[0m03:28:03.660238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25246403-16c3-43ab-8d61-7ac4d38f7ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7960e0040>]}
[0m03:28:03.661138 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m03:28:03.672785 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m03:28:03.698136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:28:03.698571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:28:03.699497 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_marcel.example
[0m03:28:03.710941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25246403-16c3-43ab-8d61-7ac4d38f7ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc795e95930>]}
[0m03:28:03.724170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25246403-16c3-43ab-8d61-7ac4d38f7ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc795e615d0>]}
[0m03:28:03.725000 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m03:28:03.726401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25246403-16c3-43ab-8d61-7ac4d38f7ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc795e616c0>]}
[0m03:28:03.728659 [info ] [MainThread]: 
[0m03:28:03.730314 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:28:03.732233 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m03:28:03.733239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:28:04.837144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now create_aec-students_dbt_marcel)
[0m03:28:04.838530 [debug] [ThreadPool]: Creating schema "database: "aec-students"
schema: "dbt_marcel"
"
[0m03:28:04.848803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:28:04.849399 [debug] [ThreadPool]: On create_aec-students_dbt_marcel: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "create_aec-students_dbt_marcel"} */
create schema if not exists `aec-students`.`dbt_marcel`
  
[0m03:28:05.984798 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:21854916-2b77-4dd3-a149-08ff02deea6e&page=queryresults
[0m03:28:05.988094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_aec-students_dbt_marcel, now list_aec-students_dbt_marcel)
[0m03:28:05.988946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:28:06.208712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25246403-16c3-43ab-8d61-7ac4d38f7ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc795e607c0>]}
[0m03:28:06.209882 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m03:28:06.210557 [info ] [MainThread]: 
[0m03:28:06.227739 [debug] [Thread-1 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m03:28:06.228461 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.my_first_dbt_model ..................... [RUN]
[0m03:28:06.229492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.my_first_dbt_model)
[0m03:28:06.229993 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m03:28:06.233758 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m03:28:06.234809 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 03:28:06.230524 => 03:28:06.234454
[0m03:28:06.235380 [debug] [Thread-1 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m03:28:06.269909 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m03:28:06.271086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:28:06.271701 [debug] [Thread-1 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`my_first_dbt_model`
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m03:28:09.054672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:999c119a-3836-4b3c-ac3b-db2bd1137f52&page=queryresults
[0m03:28:09.075858 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 03:28:06.235686 => 03:28:09.075377
[0m03:28:09.076951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25246403-16c3-43ab-8d61-7ac4d38f7ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc795e7f0d0>]}
[0m03:28:09.077797 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.85s]
[0m03:28:09.079058 [debug] [Thread-1 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m03:28:09.080308 [debug] [Thread-3 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m03:28:09.081024 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.my_second_dbt_model ..................... [RUN]
[0m03:28:09.082083 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m03:28:09.082545 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m03:28:09.087166 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m03:28:09.088044 [debug] [Thread-3 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 03:28:09.082841 => 03:28:09.087806
[0m03:28:09.088544 [debug] [Thread-3 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m03:28:09.111006 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m03:28:09.111843 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:28:09.112406 [debug] [Thread-3 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_marcel`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_marcel`.`my_first_dbt_model`
where id = 1;


[0m03:28:09.944603 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:03605465-0f49-41d3-9d9e-7cae3b46eddc&page=queryresults
[0m03:28:09.948768 [debug] [Thread-3 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 03:28:09.088913 => 03:28:09.948437
[0m03:28:09.950144 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25246403-16c3-43ab-8d61-7ac4d38f7ed2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc795f0e080>]}
[0m03:28:09.951268 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m03:28:09.952787 [debug] [Thread-3 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m03:28:09.956148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:28:09.956648 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m03:28:09.957127 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m03:28:09.957671 [info ] [MainThread]: 
[0m03:28:09.959012 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 6.23 seconds (6.23s).
[0m03:28:09.960757 [debug] [MainThread]: Command end result
[0m03:28:09.975444 [info ] [MainThread]: 
[0m03:28:09.976227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:28:09.977141 [info ] [MainThread]: 
[0m03:28:09.978413 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m03:28:09.980614 [debug] [MainThread]: Command `dbt run` succeeded at 03:28:09.980209 after 6.74 seconds
[0m03:28:09.982291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc799102b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc798fc6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc795e61090>]}
[0m03:28:09.984646 [debug] [MainThread]: Flushing usage events
[0m03:36:04.398781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d7e2ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d6993d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d6993c40>]}


============================== 03:36:04.401581 | d15800c6-245e-40d9-b3f3-6f41a610c9e7 ==============================
[0m03:36:04.401581 [info ] [MainThread]: Running with dbt=1.5.2
[0m03:36:04.402493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m03:36:04.762001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd15800c6-245e-40d9-b3f3-6f41a610c9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d4ea3820>]}
[0m03:36:04.779483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd15800c6-245e-40d9-b3f3-6f41a610c9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d4e777c0>]}
[0m03:36:04.780398 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m03:36:04.791618 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m03:36:04.817533 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 2 files added, 0 files changed.
[0m03:36:04.818232 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/models/customer.sql
[0m03:36:04.818800 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/models/schema.yml
[0m03:36:04.819318 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/example/my_first_dbt_model.sql
[0m03:36:04.819698 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/example/my_second_dbt_model.sql
[0m03:36:04.845676 [debug] [MainThread]: 1699: static parser successfully parsed models/customer.sql
[0m03:36:04.871321 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/models/schema.yml'
[0m03:36:04.873473 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/models/schema.yml'
[0m03:36:04.908893 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321' (models/models/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m03:36:04.909798 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710' (models/models/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m03:36:04.910615 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493' (models/models/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m03:36:04.911380 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778' (models/models/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m03:36:04.919066 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_marcel.example
[0m03:36:04.924873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd15800c6-245e-40d9-b3f3-6f41a610c9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d4ce1e70>]}
[0m03:36:04.934230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd15800c6-245e-40d9-b3f3-6f41a610c9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d4e295a0>]}
[0m03:36:04.935136 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m03:36:04.935972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd15800c6-245e-40d9-b3f3-6f41a610c9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d4e29690>]}
[0m03:36:04.938125 [info ] [MainThread]: 
[0m03:36:04.939540 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:36:04.941890 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m03:36:04.942629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:36:06.080375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m03:36:06.081401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:36:06.307746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd15800c6-245e-40d9-b3f3-6f41a610c9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d4e13430>]}
[0m03:36:06.308827 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m03:36:06.309467 [info ] [MainThread]: 
[0m03:36:06.315037 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m03:36:06.315769 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_marcel.customer ................................ [RUN]
[0m03:36:06.316796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m03:36:06.317403 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m03:36:06.320388 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m03:36:06.321291 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 03:36:06.318510 => 03:36:06.321006
[0m03:36:06.321797 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m03:36:06.357642 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m03:36:06.358606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:36:06.359641 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */


  create or replace view `aec-students`.`dbt_marcel`.`customer`
  OPTIONS()
  as select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at;


[0m03:36:07.366434 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ccd9d310-a0af-4e8d-920c-0e65cf3be6d0&page=queryresults
[0m03:36:07.382948 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 03:36:06.322162 => 03:36:07.382718
[0m03:36:07.383992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd15800c6-245e-40d9-b3f3-6f41a610c9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d4e77670>]}
[0m03:36:07.384807 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_marcel.customer ........................... [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m03:36:07.385972 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m03:36:07.388834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:36:07.389264 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m03:36:07.389752 [info ] [MainThread]: 
[0m03:36:07.390601 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m03:36:07.392549 [debug] [MainThread]: Command end result
[0m03:36:07.400713 [info ] [MainThread]: 
[0m03:36:07.401635 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:36:07.402453 [info ] [MainThread]: 
[0m03:36:07.403675 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:36:07.405082 [debug] [MainThread]: Command `dbt run` succeeded at 03:36:07.404950 after 3.01 seconds
[0m03:36:07.405601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d7e2ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d4dfd270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d4e3d780>]}
[0m03:36:07.406137 [debug] [MainThread]: Flushing usage events
[0m03:41:21.643661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8362082bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8360b93d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8360b93c40>]}


============================== 03:41:21.646412 | b83b01f1-d48d-48e8-b94b-87c160d2444c ==============================
[0m03:41:21.646412 [info ] [MainThread]: Running with dbt=1.5.2
[0m03:41:21.647322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m03:41:22.005176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b83b01f1-d48d-48e8-b94b-87c160d2444c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835f075c60>]}
[0m03:41:22.022532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b83b01f1-d48d-48e8-b94b-87c160d2444c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835f0b13f0>]}
[0m03:41:22.023452 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m03:41:22.034686 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m03:41:22.059116 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m03:41:22.064906 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_marcel.example
[0m03:41:22.071583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b83b01f1-d48d-48e8-b94b-87c160d2444c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835ee74550>]}
[0m03:41:22.078214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b83b01f1-d48d-48e8-b94b-87c160d2444c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835f020cd0>]}
[0m03:41:22.078791 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m03:41:22.079403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b83b01f1-d48d-48e8-b94b-87c160d2444c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835f020ca0>]}
[0m03:41:22.080939 [info ] [MainThread]: 
[0m03:41:22.082134 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:41:22.083693 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m03:41:22.084436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:23.296900 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m03:41:23.297803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:41:23.529017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b83b01f1-d48d-48e8-b94b-87c160d2444c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835f00b820>]}
[0m03:41:23.530138 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m03:41:23.530931 [info ] [MainThread]: 
[0m03:41:23.536295 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m03:41:23.537035 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_marcel.customer ................................ [RUN]
[0m03:41:23.538710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m03:41:23.539338 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m03:41:23.542207 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m03:41:23.543094 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 03:41:23.539859 => 03:41:23.542786
[0m03:41:23.543615 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m03:41:23.577326 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m03:41:23.578218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:41:23.578816 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */


  create or replace view `aec-students`.`dbt_marcel`.`customer`
  OPTIONS()
  as select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at;


[0m03:41:24.296597 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9435d9ce-fd09-4afa-a399-71a30a9c8e90&page=queryresults
[0m03:41:24.314060 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 03:41:23.543977 => 03:41:24.313837
[0m03:41:24.314996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b83b01f1-d48d-48e8-b94b-87c160d2444c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835ee75b70>]}
[0m03:41:24.315793 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_marcel.customer ........................... [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m03:41:24.316795 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m03:41:24.319170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:41:24.319535 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m03:41:24.319908 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m03:41:24.320340 [info ] [MainThread]: 
[0m03:41:24.320963 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m03:41:24.322101 [debug] [MainThread]: Command end result
[0m03:41:24.334442 [info ] [MainThread]: 
[0m03:41:24.335131 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:41:24.335775 [info ] [MainThread]: 
[0m03:41:24.336490 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:41:24.337605 [debug] [MainThread]: Command `dbt run` succeeded at 03:41:24.337468 after 2.70 seconds
[0m03:41:24.338055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8362082bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836208e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835eedd870>]}
[0m03:41:24.338544 [debug] [MainThread]: Flushing usage events
[0m03:55:08.971406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd30390ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3023bfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3023bfc40>]}


============================== 03:55:08.974313 | 7611bb2d-8b05-4b30-a48b-60161467ad32 ==============================
[0m03:55:08.974313 [info ] [MainThread]: Running with dbt=1.5.2
[0m03:55:08.975205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m03:55:09.419982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7611bb2d-8b05-4b30-a48b-60161467ad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3008d7910>]}
[0m03:55:09.438007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7611bb2d-8b05-4b30-a48b-60161467ad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3008a7520>]}
[0m03:55:09.438893 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m03:55:09.450262 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m03:55:09.474488 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m03:55:09.475216 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/example/customer.sql
[0m03:55:09.475700 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/models/customer.sql
[0m03:55:09.501406 [debug] [MainThread]: 1699: static parser successfully parsed example/customer.sql
[0m03:55:09.518861 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_marcel.example
[0m03:55:09.525291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7611bb2d-8b05-4b30-a48b-60161467ad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3006f00d0>]}
[0m03:55:09.532458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7611bb2d-8b05-4b30-a48b-60161467ad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3007a7f40>]}
[0m03:55:09.533070 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m03:55:09.533819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7611bb2d-8b05-4b30-a48b-60161467ad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3007a5870>]}
[0m03:55:09.535568 [info ] [MainThread]: 
[0m03:55:09.536605 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m03:55:09.538547 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m03:55:09.539149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:55:10.747772 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m03:55:10.748622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:55:10.967833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7611bb2d-8b05-4b30-a48b-60161467ad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3007a5270>]}
[0m03:55:10.969155 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m03:55:10.970159 [info ] [MainThread]: 
[0m03:55:10.977915 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m03:55:10.978550 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_marcel.customer ................................ [RUN]
[0m03:55:10.979534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m03:55:10.980000 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m03:55:10.982566 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m03:55:10.983363 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 03:55:10.980301 => 03:55:10.983120
[0m03:55:10.983829 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m03:55:11.015151 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m03:55:11.015955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:55:11.016482 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */


  create or replace view `aec-students`.`dbt_marcel`.`customer`
  OPTIONS()
  as select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at;


[0m03:55:12.000897 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c45d6605-83de-40b1-ac9d-3fd9ec76294f&page=queryresults
[0m03:55:12.016165 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 03:55:10.984170 => 03:55:12.015943
[0m03:55:12.017138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7611bb2d-8b05-4b30-a48b-60161467ad32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd300837010>]}
[0m03:55:12.017964 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_marcel.customer ........................... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m03:55:12.019020 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m03:55:12.021465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:55:12.021837 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m03:55:12.022192 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m03:55:12.022589 [info ] [MainThread]: 
[0m03:55:12.023306 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m03:55:12.024522 [debug] [MainThread]: Command end result
[0m03:55:12.031640 [info ] [MainThread]: 
[0m03:55:12.032373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:55:12.033054 [info ] [MainThread]: 
[0m03:55:12.033750 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:55:12.035229 [debug] [MainThread]: Command `dbt run` succeeded at 03:55:12.034927 after 3.07 seconds
[0m03:55:12.037979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd30390ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd30015cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd300654070>]}
[0m03:55:12.038762 [debug] [MainThread]: Flushing usage events
[0m14:23:54.948136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d15bcab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d146c3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d146c3c10>]}


============================== 14:23:54.957762 | 323942ac-1af9-4e97-9296-a7cc3221afb0 ==============================
[0m14:23:54.957762 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:23:54.958921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:23:55.330293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '323942ac-1af9-4e97-9296-a7cc3221afb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d12bbb580>]}
[0m14:23:55.348126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '323942ac-1af9-4e97-9296-a7cc3221afb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d12be7310>]}
[0m14:23:55.348968 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:23:55.359883 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:23:55.391506 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:23:55.392190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '323942ac-1af9-4e97-9296-a7cc3221afb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d15a8e1a0>]}
[0m14:23:56.285528 [debug] [MainThread]: 1699: static parser successfully parsed example/customer.sql
[0m14:23:56.334050 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_marcel.example
[0m14:23:56.339840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '323942ac-1af9-4e97-9296-a7cc3221afb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d12b1bf40>]}
[0m14:23:56.347135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '323942ac-1af9-4e97-9296-a7cc3221afb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d125c6950>]}
[0m14:23:56.347710 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:23:56.348478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '323942ac-1af9-4e97-9296-a7cc3221afb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d125c6e90>]}
[0m14:23:56.350165 [info ] [MainThread]: 
[0m14:23:56.351400 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:23:56.353209 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:23:56.353737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:01.038883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m14:24:01.039771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:01.303373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '323942ac-1af9-4e97-9296-a7cc3221afb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d12b17160>]}
[0m14:24:01.304425 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:24:01.305082 [info ] [MainThread]: 
[0m14:24:01.320304 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m14:24:01.320958 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_marcel.customer ................................ [RUN]
[0m14:24:01.321880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m14:24:01.322529 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m14:24:01.332381 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m14:24:01.333401 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 14:24:01.330466 => 14:24:01.333148
[0m14:24:01.333889 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m14:24:01.365031 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m14:24:01.365800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:01.366361 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */


  create or replace view `aec-students`.`dbt_marcel`.`customer`
  OPTIONS()
  as select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at;


[0m14:24:02.239448 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:bf38f128-5189-46b7-825f-53a7ed8cc65c&page=queryresults
[0m14:24:02.260169 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 14:24:01.334258 => 14:24:02.259960
[0m14:24:02.261026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323942ac-1af9-4e97-9296-a7cc3221afb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1256aaa0>]}
[0m14:24:02.261798 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_marcel.customer ........................... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m14:24:02.262967 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m14:24:02.265372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:02.265759 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m14:24:02.266178 [info ] [MainThread]: 
[0m14:24:02.267082 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m14:24:02.268443 [debug] [MainThread]: Command end result
[0m14:24:02.280814 [info ] [MainThread]: 
[0m14:24:02.281453 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:02.282071 [info ] [MainThread]: 
[0m14:24:02.282910 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:24:02.283963 [debug] [MainThread]: Command `dbt run` succeeded at 14:24:02.283833 after 7.36 seconds
[0m14:24:02.284398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d15bcab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d12b4ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d12aef4c0>]}
[0m14:24:02.284885 [debug] [MainThread]: Flushing usage events
[0m14:56:11.022706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4085ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d3f393dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d3f393ca0>]}


============================== 14:56:11.025531 | df0fece2-8eb3-4b83-8a7a-438882c19870 ==============================
[0m14:56:11.025531 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:56:11.026514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:56:11.374851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df0fece2-8eb3-4b83-8a7a-438882c19870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d3d8a7b50>]}
[0m14:56:11.392330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df0fece2-8eb3-4b83-8a7a-438882c19870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d3d875f90>]}
[0m14:56:11.393206 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:56:11.404946 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:56:11.428869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:56:11.429498 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/example/customer.sql
[0m14:56:11.455120 [debug] [MainThread]: 1699: static parser successfully parsed example/customer.sql
[0m14:56:11.472709 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_marcel.example
[0m14:56:11.478402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df0fece2-8eb3-4b83-8a7a-438882c19870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d3d6c83d0>]}
[0m14:56:11.488587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df0fece2-8eb3-4b83-8a7a-438882c19870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d3d818100>]}
[0m14:56:11.489411 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:56:11.490959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df0fece2-8eb3-4b83-8a7a-438882c19870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d3d8181f0>]}
[0m14:56:11.493070 [info ] [MainThread]: 
[0m14:56:11.494176 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:56:11.495619 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:56:11.496267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:12.621488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m14:56:12.622326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:12.884290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df0fece2-8eb3-4b83-8a7a-438882c19870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d3d88e6b0>]}
[0m14:56:12.885531 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:56:12.886329 [info ] [MainThread]: 
[0m14:56:12.895491 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m14:56:12.896107 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_marcel.customer ............................... [RUN]
[0m14:56:12.897048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m14:56:12.897499 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m14:56:12.901125 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m14:56:12.902089 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 14:56:12.897799 => 14:56:12.901834
[0m14:56:12.902547 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m14:56:12.917990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:13.355531 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m14:56:13.356682 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customer`
    
    

    OPTIONS()
    as (
      

select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m14:56:22.009810 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cd7489a9-1d05-452e-9a4a-641a28ecf176&page=queryresults
[0m14:56:22.027617 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 14:56:12.902881 => 14:56:22.027387
[0m14:56:22.028560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df0fece2-8eb3-4b83-8a7a-438882c19870', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d3d88cfa0>]}
[0m14:56:22.029346 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_marcel.customer .......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 9.13s]
[0m14:56:22.030367 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m14:56:22.032832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:22.033219 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m14:56:22.033673 [info ] [MainThread]: 
[0m14:56:22.034355 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.54 seconds (10.54s).
[0m14:56:22.035357 [debug] [MainThread]: Command end result
[0m14:56:22.042747 [info ] [MainThread]: 
[0m14:56:22.043520 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:56:22.044185 [info ] [MainThread]: 
[0m14:56:22.045289 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:56:22.046247 [debug] [MainThread]: Command `dbt run` succeeded at 14:56:22.046079 after 11.03 seconds
[0m14:56:22.046692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4085ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d3d875f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d3d818340>]}
[0m14:56:22.047464 [debug] [MainThread]: Flushing usage events
[0m14:57:24.424489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892a7c6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89292c3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89292c3c10>]}


============================== 14:57:24.427303 | 6553bba3-c644-4737-8853-568cd0d77934 ==============================
[0m14:57:24.427303 [info ] [MainThread]: Running with dbt=1.5.2
[0m14:57:24.428193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:57:24.780457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6553bba3-c644-4737-8853-568cd0d77934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89277aef20>]}
[0m14:57:24.797824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6553bba3-c644-4737-8853-568cd0d77934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89277e4070>]}
[0m14:57:24.798697 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m14:57:24.812716 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m14:57:24.823915 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:57:24.824591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6553bba3-c644-4737-8853-568cd0d77934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89277e7490>]}
[0m14:57:25.569135 [debug] [MainThread]: 1699: static parser successfully parsed example/customer.sql
[0m14:57:25.632619 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_marcel.example
[0m14:57:25.638492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6553bba3-c644-4737-8853-568cd0d77934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892715b790>]}
[0m14:57:25.645470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6553bba3-c644-4737-8853-568cd0d77934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89271c7ee0>]}
[0m14:57:25.646103 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:57:25.646728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6553bba3-c644-4737-8853-568cd0d77934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89271c7fa0>]}
[0m14:57:25.648415 [info ] [MainThread]: 
[0m14:57:25.649449 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:57:25.650851 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:57:25.651377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:26.732056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m14:57:26.732937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:26.923319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6553bba3-c644-4737-8853-568cd0d77934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89276fbdf0>]}
[0m14:57:26.924373 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:57:26.925003 [info ] [MainThread]: 
[0m14:57:26.930374 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m14:57:26.931037 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_marcel.customer ............................... [RUN]
[0m14:57:26.932377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m14:57:26.932881 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m14:57:26.936377 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m14:57:26.937340 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 14:57:26.933349 => 14:57:26.937076
[0m14:57:26.937811 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m14:57:26.952994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:27.217332 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m14:57:27.219060 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customer`
    
    

    OPTIONS()
    as (
      

select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m14:57:34.587837 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a16bdd74-7a4c-4725-8479-8eaa55161ffc&page=queryresults
[0m14:57:34.606855 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 14:57:26.938296 => 14:57:34.606624
[0m14:57:34.607817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6553bba3-c644-4737-8853-568cd0d77934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892724fc40>]}
[0m14:57:34.608622 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_marcel.customer .......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 7.68s]
[0m14:57:34.609803 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m14:57:34.612004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:34.612379 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m14:57:34.612762 [info ] [MainThread]: 
[0m14:57:34.614086 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.96 seconds (8.96s).
[0m14:57:34.615556 [debug] [MainThread]: Command end result
[0m14:57:34.628459 [info ] [MainThread]: 
[0m14:57:34.629275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:34.630027 [info ] [MainThread]: 
[0m14:57:34.630961 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:57:34.632220 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:34.632073 after 10.22 seconds
[0m14:57:34.632717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892a7c6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f892a5da380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89276e8eb0>]}
[0m14:57:34.633194 [debug] [MainThread]: Flushing usage events
[0m15:07:31.681409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff457df2b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4568b7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4568b7be0>]}


============================== 15:07:31.684225 | 72f1d1f1-d5d9-4a65-87ac-cc6d5073bbfb ==============================
[0m15:07:31.684225 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:07:31.685049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:07:32.031898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72f1d1f1-d5d9-4a65-87ac-cc6d5073bbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff454dcba00>]}
[0m15:07:32.048993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72f1d1f1-d5d9-4a65-87ac-cc6d5073bbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff454d9f610>]}
[0m15:07:32.049837 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:07:32.061425 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:07:32.069530 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:07:32.070157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '72f1d1f1-d5d9-4a65-87ac-cc6d5073bbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff454db7e50>]}
[0m15:07:32.816386 [debug] [MainThread]: 1699: static parser successfully parsed example/customer.sql
[0m15:07:32.880427 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_marcel
[0m15:07:32.886360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72f1d1f1-d5d9-4a65-87ac-cc6d5073bbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff454d4f9a0>]}
[0m15:07:32.893510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72f1d1f1-d5d9-4a65-87ac-cc6d5073bbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4547bbc70>]}
[0m15:07:32.894133 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:07:32.894760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72f1d1f1-d5d9-4a65-87ac-cc6d5073bbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4547bbd30>]}
[0m15:07:32.896321 [info ] [MainThread]: 
[0m15:07:32.897503 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:07:32.899421 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:07:32.899977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:33.980411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m15:07:33.981091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:34.217692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72f1d1f1-d5d9-4a65-87ac-cc6d5073bbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff454d430a0>]}
[0m15:07:34.218959 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:07:34.219734 [info ] [MainThread]: 
[0m15:07:34.226040 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m15:07:34.226709 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_marcel.customer ............................... [RUN]
[0m15:07:34.227587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m15:07:34.228027 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m15:07:34.231361 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m15:07:34.232828 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 15:07:34.228317 => 15:07:34.232552
[0m15:07:34.233318 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m15:07:34.252064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:34.526127 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m15:07:34.527150 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customer`
    
    

    OPTIONS()
    as (
      

select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m15:07:43.628832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3e5313d2-bf13-40f5-9774-c1112655c1e0&page=queryresults
[0m15:07:43.647169 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 15:07:34.233722 => 15:07:43.646945
[0m15:07:43.648075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f1d1f1-d5d9-4a65-87ac-cc6d5073bbfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45483feb0>]}
[0m15:07:43.648857 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_marcel.customer .......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 9.42s]
[0m15:07:43.650029 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m15:07:43.652203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:43.652577 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m15:07:43.652952 [info ] [MainThread]: 
[0m15:07:43.653426 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.76 seconds (10.76s).
[0m15:07:43.654263 [debug] [MainThread]: Command end result
[0m15:07:43.669125 [info ] [MainThread]: 
[0m15:07:43.669771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:43.670424 [info ] [MainThread]: 
[0m15:07:43.671416 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:07:43.672341 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:43.672207 after 12.00 seconds
[0m15:07:43.672775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff457df2b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff45921bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff454d9d240>]}
[0m15:07:43.673261 [debug] [MainThread]: Flushing usage events
[0m15:08:54.444127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0f18f2c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0f03b7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0f03b7ca0>]}


============================== 15:08:54.446908 | 9186c84e-c6d1-4fc8-ab74-5550a65d0c02 ==============================
[0m15:08:54.446908 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:08:54.447720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:08:54.804308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9186c84e-c6d1-4fc8-ab74-5550a65d0c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ee8cb9d0>]}
[0m15:08:54.823170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9186c84e-c6d1-4fc8-ab74-5550a65d0c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ee89f550>]}
[0m15:08:54.824166 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:08:54.835877 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:08:54.862923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:08:54.863644 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/example/customer.sql
[0m15:08:54.889330 [debug] [MainThread]: 1699: static parser successfully parsed example/customer.sql
[0m15:08:54.907053 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_marcel
[0m15:08:54.913141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9186c84e-c6d1-4fc8-ab74-5550a65d0c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ee6e8160>]}
[0m15:08:54.919894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9186c84e-c6d1-4fc8-ab74-5550a65d0c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ee7b18a0>]}
[0m15:08:54.920498 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:08:54.921218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9186c84e-c6d1-4fc8-ab74-5550a65d0c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ee8480d0>]}
[0m15:08:54.922775 [info ] [MainThread]: 
[0m15:08:54.923903 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:08:54.925620 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:08:54.926218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:56.001111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m15:08:56.001919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:56.241463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9186c84e-c6d1-4fc8-ab74-5550a65d0c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ee7b3610>]}
[0m15:08:56.242714 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:08:56.243700 [info ] [MainThread]: 
[0m15:08:56.252078 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m15:08:56.252716 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_marcel.customer ................................ [RUN]
[0m15:08:56.253567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m15:08:56.254039 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m15:08:56.257643 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m15:08:56.258494 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 15:08:56.254584 => 15:08:56.258176
[0m15:08:56.258942 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m15:08:56.281087 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 15:08:56.259235 => 15:08:56.280811
[0m15:08:56.283598 [debug] [Thread-1 (]: Compilation Error in model customer (models/example/customer.sql)
  Trying to create view `aec-students`.`dbt_marcel`.`customer`, but it currently exists as a table. Either drop `aec-students`.`dbt_marcel`.`customer` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
  > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model customer (models/example/customer.sql)
[0m15:08:56.284194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9186c84e-c6d1-4fc8-ab74-5550a65d0c02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ee82f610>]}
[0m15:08:56.284899 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_marcel.customer ....................... [[31mERROR[0m in 0.03s]
[0m15:08:56.285716 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m15:08:56.288193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:56.288577 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m15:08:56.288992 [info ] [MainThread]: 
[0m15:08:56.289571 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m15:08:56.290777 [debug] [MainThread]: Command end result
[0m15:08:56.297458 [info ] [MainThread]: 
[0m15:08:56.298093 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:08:56.298711 [info ] [MainThread]: 
[0m15:08:56.299658 [error] [MainThread]: [33mCompilation Error in model customer (models/example/customer.sql)[0m
[0m15:08:56.300263 [error] [MainThread]:   Trying to create view `aec-students`.`dbt_marcel`.`customer`, but it currently exists as a table. Either drop `aec-students`.`dbt_marcel`.`customer` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
[0m15:08:56.301156 [error] [MainThread]:   
[0m15:08:56.301776 [error] [MainThread]:   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
[0m15:08:56.302380 [error] [MainThread]:   > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
[0m15:08:56.303338 [error] [MainThread]:   > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m15:08:56.303919 [error] [MainThread]:   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
[0m15:08:56.304617 [error] [MainThread]:   > called by model customer (models/example/customer.sql)
[0m15:08:56.305512 [info ] [MainThread]: 
[0m15:08:56.306508 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:08:56.307867 [debug] [MainThread]: Command `dbt run` failed at 15:08:56.307726 after 1.87 seconds
[0m15:08:56.308374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0f18f2c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0f13ddab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ee6981c0>]}
[0m15:08:56.308853 [debug] [MainThread]: Flushing usage events
[0m15:09:24.690096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa496406bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa494e97d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa494e97c40>]}


============================== 15:09:24.692865 | 4ec23607-2c19-48c3-8068-c37ce5967f2f ==============================
[0m15:09:24.692865 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:09:24.693728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:09:25.049122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ec23607-2c19-48c3-8068-c37ce5967f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4933a7850>]}
[0m15:09:25.067605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ec23607-2c19-48c3-8068-c37ce5967f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa49337b850>]}
[0m15:09:25.068422 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:09:25.079396 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:09:25.102981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:25.103364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:25.103935 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_marcel
[0m15:09:25.110222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ec23607-2c19-48c3-8068-c37ce5967f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa49315c100>]}
[0m15:09:25.117657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ec23607-2c19-48c3-8068-c37ce5967f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa49327bdf0>]}
[0m15:09:25.118177 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:09:25.118774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ec23607-2c19-48c3-8068-c37ce5967f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa49327be80>]}
[0m15:09:25.120281 [info ] [MainThread]: 
[0m15:09:25.121430 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:09:25.122952 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:09:25.123594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:26.102325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m15:09:26.103203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:26.328754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ec23607-2c19-48c3-8068-c37ce5967f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa493279240>]}
[0m15:09:26.329925 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:09:26.330866 [info ] [MainThread]: 
[0m15:09:26.336173 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m15:09:26.336856 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_marcel.customer ................................ [RUN]
[0m15:09:26.337762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m15:09:26.338234 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m15:09:26.340508 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m15:09:26.341347 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 15:09:26.338573 => 15:09:26.341043
[0m15:09:26.341794 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m15:09:26.364300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:26.675729 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m15:09:26.676768 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */


  create or replace view `aec-students`.`dbt_marcel`.`customer`
  OPTIONS()
  as select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at;


[0m15:09:27.747921 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:05a507eb-145d-477e-9df3-7b94ca0451eb&page=queryresults
[0m15:09:27.764875 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 15:09:26.342086 => 15:09:27.764644
[0m15:09:27.765897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ec23607-2c19-48c3-8068-c37ce5967f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa493278a90>]}
[0m15:09:27.766713 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_marcel.customer ........................... [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m15:09:27.767900 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m15:09:27.770501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:27.770879 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m15:09:27.771262 [info ] [MainThread]: 
[0m15:09:27.772123 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m15:09:27.773420 [debug] [MainThread]: Command end result
[0m15:09:27.785956 [info ] [MainThread]: 
[0m15:09:27.786785 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:27.788345 [info ] [MainThread]: 
[0m15:09:27.788972 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:09:27.790227 [debug] [MainThread]: Command `dbt run` succeeded at 15:09:27.790065 after 3.11 seconds
[0m15:09:27.790694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa496406bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa49784fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa49337b850>]}
[0m15:09:27.791164 [debug] [MainThread]: Flushing usage events
[0m15:13:18.785527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f09cabf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ef6d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ef6d3c70>]}


============================== 15:13:18.788399 | 36f593f6-52d8-44e2-9a2a-89d90742a9b8 ==============================
[0m15:13:18.788399 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:13:18.789245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:13:19.167020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36f593f6-52d8-44e2-9a2a-89d90742a9b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f09751e0>]}
[0m15:13:19.184285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36f593f6-52d8-44e2-9a2a-89d90742a9b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86edbf7490>]}
[0m15:13:19.185253 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:13:19.196682 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:13:19.204659 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:13:19.205311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '36f593f6-52d8-44e2-9a2a-89d90742a9b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f0a8dc00>]}
[0m15:13:20.023288 [debug] [MainThread]: 1699: static parser successfully parsed example/customer.sql
[0m15:13:20.074176 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_marcel
[0m15:13:20.080344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36f593f6-52d8-44e2-9a2a-89d90742a9b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ed973580>]}
[0m15:13:20.087813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36f593f6-52d8-44e2-9a2a-89d90742a9b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ed9d9660>]}
[0m15:13:20.088468 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:13:20.089089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36f593f6-52d8-44e2-9a2a-89d90742a9b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ed9d8a60>]}
[0m15:13:20.090683 [info ] [MainThread]: 
[0m15:13:20.091914 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:13:20.093388 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:13:20.093967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:21.191892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m15:13:21.192692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:21.394058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36f593f6-52d8-44e2-9a2a-89d90742a9b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86edb2be20>]}
[0m15:13:21.395139 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:13:21.395797 [info ] [MainThread]: 
[0m15:13:21.401436 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m15:13:21.402105 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_marcel.customer ............................... [RUN]
[0m15:13:21.403207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m15:13:21.403655 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m15:13:21.407361 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m15:13:21.408337 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 15:13:21.403947 => 15:13:21.408029
[0m15:13:21.408790 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m15:13:21.424359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:21.832605 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m15:13:21.833669 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customer`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m15:13:29.667709 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e465cba7-c25e-4fc5-8ad5-52f5c788ba2a&page=queryresults
[0m15:13:29.685136 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 15:13:21.409150 => 15:13:29.684909
[0m15:13:29.686056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36f593f6-52d8-44e2-9a2a-89d90742a9b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ed9ac3d0>]}
[0m15:13:29.686851 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_marcel.customer .......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.28s]
[0m15:13:29.687848 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m15:13:29.690414 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:29.690793 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m15:13:29.691209 [info ] [MainThread]: 
[0m15:13:29.691784 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.60 seconds (9.60s).
[0m15:13:29.696125 [debug] [MainThread]: Command end result
[0m15:13:29.711752 [info ] [MainThread]: 
[0m15:13:29.712514 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:29.713226 [info ] [MainThread]: 
[0m15:13:29.714532 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:13:29.715522 [debug] [MainThread]: Command `dbt run` succeeded at 15:13:29.715390 after 10.94 seconds
[0m15:13:29.715965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f09cabf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86edf7a620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86edb22200>]}
[0m15:13:29.716804 [debug] [MainThread]: Flushing usage events
[0m15:16:22.419130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31a8a6b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc319393cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc319393bb0>]}


============================== 15:16:22.423908 | fb6c9077-b6a0-431c-8173-df03653f5606 ==============================
[0m15:16:22.423908 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:16:22.426863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:16:22.848783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb6c9077-b6a0-431c-8173-df03653f5606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3178875b0>]}
[0m15:16:22.872353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb6c9077-b6a0-431c-8173-df03653f5606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3178b31f0>]}
[0m15:16:22.873331 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:16:22.885360 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:16:22.893397 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:16:22.894230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb6c9077-b6a0-431c-8173-df03653f5606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31a351e10>]}
[0m15:16:23.709321 [debug] [MainThread]: 1699: static parser successfully parsed example/customer.sql
[0m15:16:23.757312 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop_marcel
[0m15:16:23.763077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb6c9077-b6a0-431c-8173-df03653f5606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3177e8550>]}
[0m15:16:23.770705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb6c9077-b6a0-431c-8173-df03653f5606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc317292830>]}
[0m15:16:23.771510 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:16:23.772294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb6c9077-b6a0-431c-8173-df03653f5606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3172928f0>]}
[0m15:16:23.774346 [info ] [MainThread]: 
[0m15:16:23.775973 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:16:23.777649 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:16:23.778404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:24.815354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m15:16:24.816044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:25.008102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb6c9077-b6a0-431c-8173-df03653f5606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc317803be0>]}
[0m15:16:25.009373 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:16:25.010325 [info ] [MainThread]: 
[0m15:16:25.016425 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m15:16:25.017036 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_marcel.customer ............................... [RUN]
[0m15:16:25.018115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m15:16:25.018600 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m15:16:25.022282 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m15:16:25.023237 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 15:16:25.019285 => 15:16:25.022929
[0m15:16:25.023682 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m15:16:25.038715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:25.280117 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m15:16:25.281041 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customer`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m15:16:32.330506 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:188e6a2f-8902-4bce-85ce-6b3675633c55&page=queryresults
[0m15:16:32.347704 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 15:16:25.024037 => 15:16:32.347472
[0m15:16:32.348672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6c9077-b6a0-431c-8173-df03653f5606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31731b6a0>]}
[0m15:16:32.349446 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_marcel.customer .......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 7.33s]
[0m15:16:32.350455 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m15:16:32.352911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:32.353320 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m15:16:32.353726 [info ] [MainThread]: 
[0m15:16:32.354321 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.58 seconds (8.58s).
[0m15:16:32.355302 [debug] [MainThread]: Command end result
[0m15:16:32.368443 [info ] [MainThread]: 
[0m15:16:32.369107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:32.369727 [info ] [MainThread]: 
[0m15:16:32.370640 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:16:32.371815 [debug] [MainThread]: Command `dbt run` succeeded at 15:16:32.371628 after 9.96 seconds
[0m15:16:32.372276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31a8a6b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3177ac250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3177ebfa0>]}
[0m15:16:32.372753 [debug] [MainThread]: Flushing usage events
[0m15:19:58.508993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae31bceb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae306b7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae306b7c10>]}


============================== 15:19:58.511988 | 457ad8bc-858f-47f8-b3f9-0ceffacfb9db ==============================
[0m15:19:58.511988 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:19:58.512959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:19:58.883689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '457ad8bc-858f-47f8-b3f9-0ceffacfb9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2eb9ef20>]}
[0m15:19:58.901208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '457ad8bc-858f-47f8-b3f9-0ceffacfb9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2ebd8070>]}
[0m15:19:58.901967 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:19:58.912726 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:19:58.920396 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:19:58.921003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '457ad8bc-858f-47f8-b3f9-0ceffacfb9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2ebdb490>]}
[0m15:19:59.682241 [debug] [MainThread]: 1699: static parser successfully parsed example/customer.sql
[0m15:19:59.734961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '457ad8bc-858f-47f8-b3f9-0ceffacfb9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2e553790>]}
[0m15:19:59.742099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '457ad8bc-858f-47f8-b3f9-0ceffacfb9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2e5bbee0>]}
[0m15:19:59.742722 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:19:59.743304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '457ad8bc-858f-47f8-b3f9-0ceffacfb9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2e5bbfa0>]}
[0m15:19:59.744799 [info ] [MainThread]: 
[0m15:19:59.746043 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:19:59.747549 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:19:59.748091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:00.826184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m15:20:00.826965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:01.022242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '457ad8bc-858f-47f8-b3f9-0ceffacfb9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2ea57df0>]}
[0m15:20:01.023510 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:20:01.024695 [info ] [MainThread]: 
[0m15:20:01.030466 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m15:20:01.031139 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_marcel.customer ............................... [RUN]
[0m15:20:01.032060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m15:20:01.032507 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m15:20:01.036141 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m15:20:01.037092 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 15:20:01.032797 => 15:20:01.036835
[0m15:20:01.037538 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m15:20:01.052494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:01.337290 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m15:20:01.338316 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customer`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m15:20:10.333870 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:af6df2e5-d03a-4347-a751-a57afdbad4fb&page=queryresults
[0m15:20:10.351009 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 15:20:01.037881 => 15:20:10.350779
[0m15:20:10.351993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '457ad8bc-858f-47f8-b3f9-0ceffacfb9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2e5cb1c0>]}
[0m15:20:10.353052 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_marcel.customer .......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 9.32s]
[0m15:20:10.354581 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m15:20:10.358552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:10.359090 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m15:20:10.359620 [info ] [MainThread]: 
[0m15:20:10.360635 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.61 seconds (10.61s).
[0m15:20:10.363497 [debug] [MainThread]: Command end result
[0m15:20:10.378477 [info ] [MainThread]: 
[0m15:20:10.379165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:10.379910 [info ] [MainThread]: 
[0m15:20:10.380716 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:20:10.381821 [debug] [MainThread]: Command `dbt run` succeeded at 15:20:10.381690 after 11.88 seconds
[0m15:20:10.382337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae31bceb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae31bd2380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae2eaeceb0>]}
[0m15:20:10.383086 [debug] [MainThread]: Flushing usage events
[0m15:32:13.267630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a03cfab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a02793d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a02793c10>]}


============================== 15:32:13.270472 | af838952-afec-4b77-979a-f69c3ce67b8d ==============================
[0m15:32:13.270472 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:32:13.271429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:32:13.619138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af838952-afec-4b77-979a-f69c3ce67b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a00c7a9e0>]}
[0m15:32:13.644015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af838952-afec-4b77-979a-f69c3ce67b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a00cb34f0>]}
[0m15:32:13.645499 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:32:13.662855 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:32:13.692145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:32:13.692835 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/example/monthly_customers.sql
[0m15:32:13.717698 [debug] [MainThread]: 1699: static parser successfully parsed example/monthly_customers.sql
[0m15:32:13.739550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af838952-afec-4b77-979a-f69c3ce67b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a00acc1c0>]}
[0m15:32:13.746430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af838952-afec-4b77-979a-f69c3ce67b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a00c0bdc0>]}
[0m15:32:13.747010 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:32:13.747685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af838952-afec-4b77-979a-f69c3ce67b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a00c0bee0>]}
[0m15:32:13.750562 [info ] [MainThread]: 
[0m15:32:13.751618 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:32:13.753572 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:32:13.754098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:14.851053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m15:32:14.851893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:15.091818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af838952-afec-4b77-979a-f69c3ce67b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a00a74190>]}
[0m15:32:15.093374 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:32:15.094202 [info ] [MainThread]: 
[0m15:32:15.099409 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m15:32:15.100059 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customer ............................... [RUN]
[0m15:32:15.101287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m15:32:15.101744 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m15:32:15.105228 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m15:32:15.106099 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 15:32:15.102306 => 15:32:15.105791
[0m15:32:15.106593 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m15:32:15.121642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:32:15.408112 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m15:32:15.409017 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customer`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m15:32:23.150426 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ee00847a-7648-4a8d-acee-9d0883eb96d4&page=queryresults
[0m15:32:23.168080 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 15:32:15.106882 => 15:32:23.167855
[0m15:32:23.169026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af838952-afec-4b77-979a-f69c3ce67b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a00b85a80>]}
[0m15:32:23.169816 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customer .......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.07s]
[0m15:32:23.170987 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m15:32:23.172206 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_customers
[0m15:32:23.173107 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_customers ....................... [RUN]
[0m15:32:23.174164 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_customers'
[0m15:32:23.174711 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_customers
[0m15:32:23.178172 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
[0m15:32:23.179003 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_customers (compile): 15:32:23.175006 => 15:32:23.178701
[0m15:32:23.179443 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_customers
[0m15:32:23.199586 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_customers"
[0m15:32:23.200372 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:32:23.200860 [debug] [Thread-3 (]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_customers`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customer`
group by 1;


[0m15:32:23.834575 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:dd6d5813-5728-4dc1-8e4a-b6e1d30ac86a&page=queryresults
[0m15:32:23.838456 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_customers (execute): 15:32:23.179733 => 15:32:23.838059
[0m15:32:23.839862 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af838952-afec-4b77-979a-f69c3ce67b8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a00b85a80>]}
[0m15:32:23.840963 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_customers .................. [[32mCREATE VIEW (0 processed)[0m in 0.67s]
[0m15:32:23.842461 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_customers
[0m15:32:23.846369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:23.846929 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m15:32:23.847420 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
[0m15:32:23.847969 [info ] [MainThread]: 
[0m15:32:23.849439 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.10 seconds (10.10s).
[0m15:32:23.852636 [debug] [MainThread]: Command end result
[0m15:32:23.867891 [info ] [MainThread]: 
[0m15:32:23.868632 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:32:23.869294 [info ] [MainThread]: 
[0m15:32:23.870028 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:32:23.871111 [debug] [MainThread]: Command `dbt run` succeeded at 15:32:23.870984 after 10.61 seconds
[0m15:32:23.871540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a03cfab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a00a74100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a00a74130>]}
[0m15:32:23.872193 [debug] [MainThread]: Flushing usage events
[0m21:23:43.849686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a23bab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a13d3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a13d3bb0>]}


============================== 21:23:43.854598 | 0c1c616e-a912-4584-ade6-521704ca5787 ==============================
[0m21:23:43.854598 [info ] [MainThread]: Running with dbt=1.5.2
[0m21:23:43.856339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:23:43.856977 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /workspaces/aec-self-study-marcel/coffee_shop_marcel/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m21:23:43.859938 [debug] [MainThread]: Command `dbt run` failed at 21:23:43.859719 after 0.03 seconds
[0m21:23:43.860661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a23bab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a13d3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12a13d3b50>]}
[0m21:23:43.861570 [debug] [MainThread]: Flushing usage events
[0m21:24:22.210567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f438bd4eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f438a9cfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f438a9cfc10>]}


============================== 21:24:22.213715 | e4af604c-e269-448a-8266-f557ad0104f4 ==============================
[0m21:24:22.213715 [info ] [MainThread]: Running with dbt=1.5.2
[0m21:24:22.214684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:24:23.871469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4af604c-e269-448a-8266-f557ad0104f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4388ec73a0>]}
[0m21:24:23.890646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4af604c-e269-448a-8266-f557ad0104f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4388ef31c0>]}
[0m21:24:23.891950 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:24:23.905138 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m21:24:23.981153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:24:23.981735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:24:23.992492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4af604c-e269-448a-8266-f557ad0104f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4388c940d0>]}
[0m21:24:24.003240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4af604c-e269-448a-8266-f557ad0104f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4388dc3dc0>]}
[0m21:24:24.003934 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:24:24.004969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4af604c-e269-448a-8266-f557ad0104f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4388dc3e50>]}
[0m21:24:24.006864 [info ] [MainThread]: 
[0m21:24:24.008161 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:24:24.009815 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m21:24:24.010335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:28.866835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m21:24:28.867604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:29.122877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4af604c-e269-448a-8266-f557ad0104f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4388dc1210>]}
[0m21:24:29.123999 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m21:24:29.125103 [info ] [MainThread]: 
[0m21:24:29.153241 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m21:24:29.154085 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customer ............................... [RUN]
[0m21:24:29.156054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m21:24:29.156545 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m21:24:29.161129 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m21:24:29.162402 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 21:24:29.156893 => 21:24:29.161786
[0m21:24:29.162869 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m21:24:29.178761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:29.446383 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m21:24:29.447615 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customer`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m21:24:38.430402 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:471b5dd4-2ecd-41ea-a510-6bb116033c4c&page=queryresults
[0m21:24:38.449187 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 21:24:29.163170 => 21:24:38.448953
[0m21:24:38.450226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4af604c-e269-448a-8266-f557ad0104f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4388e49bd0>]}
[0m21:24:38.451158 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customer .......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 9.29s]
[0m21:24:38.452207 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m21:24:38.453394 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_customers
[0m21:24:38.454371 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_customers ....................... [RUN]
[0m21:24:38.456241 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_customers'
[0m21:24:38.456807 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_customers
[0m21:24:38.460926 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
[0m21:24:38.462064 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_customers (compile): 21:24:38.457313 => 21:24:38.461744
[0m21:24:38.462565 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_customers
[0m21:24:38.490265 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_customers"
[0m21:24:38.491493 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:24:38.492131 [debug] [Thread-3 (]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_customers`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customer`
group by 1;


[0m21:24:39.443296 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:13769b3f-113f-4320-a027-41791b896a2c&page=queryresults
[0m21:24:39.446489 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_customers (execute): 21:24:38.462899 => 21:24:39.446261
[0m21:24:39.447452 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4af604c-e269-448a-8266-f557ad0104f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4388e49bd0>]}
[0m21:24:39.448205 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_customers .................. [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m21:24:39.449607 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_customers
[0m21:24:39.452338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:24:39.453065 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m21:24:39.453422 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
[0m21:24:39.453944 [info ] [MainThread]: 
[0m21:24:39.455627 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 15.45 seconds (15.45s).
[0m21:24:39.457558 [debug] [MainThread]: Command end result
[0m21:24:39.468598 [info ] [MainThread]: 
[0m21:24:39.469585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:24:39.470571 [info ] [MainThread]: 
[0m21:24:39.471610 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:24:39.473149 [debug] [MainThread]: Command `dbt run` succeeded at 21:24:39.472791 after 17.27 seconds
[0m21:24:39.473912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f438bd4eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4388ef2fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4388ef2560>]}
[0m21:24:39.474644 [debug] [MainThread]: Flushing usage events
[0m21:33:30.874617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4695636bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46940c3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46940c3c40>]}


============================== 21:33:30.877698 | cc8ba4ce-7340-4910-8779-f173a1456398 ==============================
[0m21:33:30.877698 [info ] [MainThread]: Running with dbt=1.5.2
[0m21:33:30.878581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:33:31.268701 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'customers', 'description': 'Cleaned up data for our customers', 'columns': [{'name': 'customer_id', 'description': 'Primary key of the model', 'tests': ['unique', 'not_null']}]}] is not of type 'object'

Error encountered in /workspaces/aec-self-study-marcel/coffee_shop_marcel/dbt_project.yml
[0m21:33:31.271904 [debug] [MainThread]: Command `dbt run` failed at 21:33:31.271681 after 0.41 seconds
[0m21:33:31.272729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4695636bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46925bbd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46925bacb0>]}
[0m21:33:31.273474 [debug] [MainThread]: Flushing usage events
[0m21:39:41.309942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804948abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80481cfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80481cfc40>]}


============================== 21:39:41.313034 | 19949741-9c1a-4ff2-8d38-74d27cf0dfea ==============================
[0m21:39:41.313034 [info ] [MainThread]: Running with dbt=1.5.2
[0m21:39:41.314112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:39:41.710869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19949741-9c1a-4ff2-8d38-74d27cf0dfea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80466e7af0>]}
[0m21:39:41.728702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19949741-9c1a-4ff2-8d38-74d27cf0dfea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80466b7070>]}
[0m21:39:41.729858 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:39:41.742016 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m21:39:41.750349 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:39:41.751136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '19949741-9c1a-4ff2-8d38-74d27cf0dfea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80466cfd60>]}
[0m21:39:42.574416 [debug] [MainThread]: 1699: static parser successfully parsed example/customer.sql
[0m21:39:42.588552 [debug] [MainThread]: 1699: static parser successfully parsed example/monthly_customers.sql
[0m21:39:42.638489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19949741-9c1a-4ff2-8d38-74d27cf0dfea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804646bee0>]}
[0m21:39:42.646780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19949741-9c1a-4ff2-8d38-74d27cf0dfea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80464d76d0>]}
[0m21:39:42.647793 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:39:42.648524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19949741-9c1a-4ff2-8d38-74d27cf0dfea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8046627fd0>]}
[0m21:39:42.650975 [info ] [MainThread]: 
[0m21:39:42.652521 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:39:42.653957 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m21:39:42.655306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:43.934810 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m21:39:43.936017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:44.178679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19949741-9c1a-4ff2-8d38-74d27cf0dfea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80466ce6e0>]}
[0m21:39:44.180158 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m21:39:44.181013 [info ] [MainThread]: 
[0m21:39:44.187202 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m21:39:44.188003 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customer ............................... [RUN]
[0m21:39:44.189099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m21:39:44.189634 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m21:39:44.193477 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m21:39:44.194520 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 21:39:44.190042 => 21:39:44.194173
[0m21:39:44.195050 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m21:39:44.211382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:44.501807 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m21:39:44.502942 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customer`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m21:39:54.023346 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:16a0eceb-5d2f-41a2-8160-2d4d0a8dfb91&page=queryresults
[0m21:39:54.041823 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 21:39:44.195472 => 21:39:54.041548
[0m21:39:54.042849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19949741-9c1a-4ff2-8d38-74d27cf0dfea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80464e34f0>]}
[0m21:39:54.043676 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customer .......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 9.85s]
[0m21:39:54.044891 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m21:39:54.046152 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_customers
[0m21:39:54.047009 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_customers ....................... [RUN]
[0m21:39:54.048150 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_customers'
[0m21:39:54.048623 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_customers
[0m21:39:54.052951 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
[0m21:39:54.053991 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_customers (compile): 21:39:54.048924 => 21:39:54.053620
[0m21:39:54.054524 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_customers
[0m21:39:54.079255 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_customers"
[0m21:39:54.080337 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:39:54.080963 [debug] [Thread-3 (]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_customers`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customer`
group by 1;


[0m21:39:54.999414 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f35e7235-c85c-4b96-b046-9f2ba1f70ab3&page=queryresults
[0m21:39:55.003584 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_customers (execute): 21:39:54.054953 => 21:39:55.003351
[0m21:39:55.004614 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19949741-9c1a-4ff2-8d38-74d27cf0dfea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80464e34f0>]}
[0m21:39:55.005457 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_customers .................. [[32mCREATE VIEW (0 processed)[0m in 0.96s]
[0m21:39:55.006563 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_customers
[0m21:39:55.009264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:55.009753 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m21:39:55.010159 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m21:39:55.010628 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
[0m21:39:55.011078 [info ] [MainThread]: 
[0m21:39:55.011687 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 12.36 seconds (12.36s).
[0m21:39:55.013029 [debug] [MainThread]: Command end result
[0m21:39:55.022685 [info ] [MainThread]: 
[0m21:39:55.023603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:39:55.024318 [info ] [MainThread]: 
[0m21:39:55.025064 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:39:55.026278 [debug] [MainThread]: Command `dbt run` succeeded at 21:39:55.026135 after 13.72 seconds
[0m21:39:55.026763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f804948abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80466b7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80464d7e50>]}
[0m21:39:55.027387 [debug] [MainThread]: Flushing usage events
[0m21:40:08.401179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f223abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f0cb7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f0cb7c70>]}


============================== 21:40:08.405906 | 150a4c43-2d30-4cb5-8f04-347de6356262 ==============================
[0m21:40:08.405906 [info ] [MainThread]: Running with dbt=1.5.2
[0m21:40:08.407015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:40:08.807599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '150a4c43-2d30-4cb5-8f04-347de6356262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f1fe1a50>]}
[0m21:40:08.825272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '150a4c43-2d30-4cb5-8f04-347de6356262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ef1d9540>]}
[0m21:40:08.826335 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:40:08.844464 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m21:40:08.870273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:40:08.870845 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:40:08.877574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '150a4c43-2d30-4cb5-8f04-347de6356262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18eef7c3d0>]}
[0m21:40:08.886046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '150a4c43-2d30-4cb5-8f04-347de6356262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ef1400d0>]}
[0m21:40:08.886826 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:40:08.887598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '150a4c43-2d30-4cb5-8f04-347de6356262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ef140070>]}
[0m21:40:08.889258 [info ] [MainThread]: 
[0m21:40:08.890168 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:40:08.891216 [debug] [MainThread]: Command end result
[0m21:40:08.901610 [debug] [MainThread]: Command `dbt test` succeeded at 21:40:08.901331 after 0.51 seconds
[0m21:40:08.902387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f223abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ef1400d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18ef1400a0>]}
[0m21:40:08.903120 [debug] [MainThread]: Flushing usage events
[0m21:40:37.371584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88ba4aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88a593c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88a593b50>]}


============================== 21:40:37.374869 | 9cdc1409-3c0f-4c53-aa9b-af84406112b2 ==============================
[0m21:40:37.374869 [info ] [MainThread]: Running with dbt=1.5.2
[0m21:40:37.375826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:40:37.760518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cdc1409-3c0f-4c53-aa9b-af84406112b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe888a7e8c0>]}
[0m21:40:37.778056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cdc1409-3c0f-4c53-aa9b-af84406112b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe888ab34c0>]}
[0m21:40:37.779138 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:40:37.791155 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m21:40:37.816004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:40:37.816613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:40:37.823110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cdc1409-3c0f-4c53-aa9b-af84406112b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe888854340>]}
[0m21:40:37.831232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cdc1409-3c0f-4c53-aa9b-af84406112b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe888a1c160>]}
[0m21:40:37.831981 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:40:37.832850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cdc1409-3c0f-4c53-aa9b-af84406112b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe888a1c040>]}
[0m21:40:37.834463 [info ] [MainThread]: 
[0m21:40:37.835201 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:40:37.836137 [debug] [MainThread]: Command end result
[0m21:40:37.843056 [debug] [MainThread]: Command `dbt test` succeeded at 21:40:37.842826 after 0.48 seconds
[0m21:40:37.843684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88ba4aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe888a1c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe888a1c0a0>]}
[0m21:40:37.844215 [debug] [MainThread]: Flushing usage events
[0m21:44:30.260425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3457226bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3455d93d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3455d93c40>]}


============================== 21:44:30.265409 | 8e4c7175-0613-44f3-8c89-cbbdf8f9cf02 ==============================
[0m21:44:30.265409 [info ] [MainThread]: Running with dbt=1.5.2
[0m21:44:30.267518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:44:30.668924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e4c7175-0613-44f3-8c89-cbbdf8f9cf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34542a3940>]}
[0m21:44:30.686574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e4c7175-0613-44f3-8c89-cbbdf8f9cf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3454277550>]}
[0m21:44:30.687624 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:44:30.699677 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m21:44:30.724525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:44:30.725149 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:44:30.731774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e4c7175-0613-44f3-8c89-cbbdf8f9cf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345405bdc0>]}
[0m21:44:30.742675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e4c7175-0613-44f3-8c89-cbbdf8f9cf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345421c3d0>]}
[0m21:44:30.743558 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:44:30.744355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e4c7175-0613-44f3-8c89-cbbdf8f9cf02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345421c370>]}
[0m21:44:30.746339 [info ] [MainThread]: 
[0m21:44:30.747071 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:44:30.748067 [debug] [MainThread]: Command end result
[0m21:44:30.761224 [debug] [MainThread]: Command `dbt test` succeeded at 21:44:30.760891 after 0.51 seconds
[0m21:44:30.762106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3457226bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345421c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345421c3a0>]}
[0m21:44:30.762891 [debug] [MainThread]: Flushing usage events
[0m21:45:20.100511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eb1092bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eafbb7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eafbb7c40>]}


============================== 21:45:20.103505 | 67129373-dd4d-43b8-be80-61995f027a11 ==============================
[0m21:45:20.103505 [info ] [MainThread]: Running with dbt=1.5.2
[0m21:45:20.104397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:45:20.480777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67129373-dd4d-43b8-be80-61995f027a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eae0cfa00>]}
[0m21:45:20.498531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67129373-dd4d-43b8-be80-61995f027a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eae09f610>]}
[0m21:45:20.499594 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:45:20.511654 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m21:45:20.536718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:45:20.537264 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:45:20.543855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67129373-dd4d-43b8-be80-61995f027a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eade83e80>]}
[0m21:45:20.552495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67129373-dd4d-43b8-be80-61995f027a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eadf9c430>]}
[0m21:45:20.553262 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:45:20.553943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67129373-dd4d-43b8-be80-61995f027a11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eadf9c520>]}
[0m21:45:20.555457 [info ] [MainThread]: 
[0m21:45:20.556131 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:45:20.557048 [debug] [MainThread]: Command end result
[0m21:45:20.564520 [debug] [MainThread]: Command `dbt test` succeeded at 21:45:20.564295 after 0.47 seconds
[0m21:45:20.565140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eb1092bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eae09f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eadf9c490>]}
[0m21:45:20.565654 [debug] [MainThread]: Flushing usage events
[0m21:53:53.069562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76365fabf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76350c3e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76350c3d90>]}


============================== 21:53:53.072655 | e7675bf1-6759-4b94-9ec1-72572d06116b ==============================
[0m21:53:53.072655 [info ] [MainThread]: Running with dbt=1.5.2
[0m21:53:53.073492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:53:53.481802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7675bf1-6759-4b94-9ec1-72572d06116b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76335ab0a0>]}
[0m21:53:53.534074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7675bf1-6759-4b94-9ec1-72572d06116b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76335e4040>]}
[0m21:53:53.535427 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:53:53.556555 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m21:53:53.596112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:53:53.596683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:53:53.603342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7675bf1-6759-4b94-9ec1-72572d06116b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7633388580>]}
[0m21:53:53.612627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7675bf1-6759-4b94-9ec1-72572d06116b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76334bc220>]}
[0m21:53:53.613369 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m21:53:53.614131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7675bf1-6759-4b94-9ec1-72572d06116b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76334bc310>]}
[0m21:53:53.615445 [info ] [MainThread]: 
[0m21:53:53.616414 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:53:53.617297 [debug] [MainThread]: Command end result
[0m21:53:53.624597 [debug] [MainThread]: Command `dbt test` succeeded at 21:53:53.624362 after 0.56 seconds
[0m21:53:53.625387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76365fabf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76364cdc00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76334bc280>]}
[0m21:53:53.626104 [debug] [MainThread]: Flushing usage events
[0m22:07:06.728124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4b8a2b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4a3bfd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4a3bfbe0>]}


============================== 22:07:06.731176 | 84db72a1-b5ab-4579-abf8-3f1797f5b6b6 ==============================
[0m22:07:06.731176 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:07:06.732015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:07:07.148804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84db72a1-b5ab-4579-abf8-3f1797f5b6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec488af6a0>]}
[0m22:07:07.167108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84db72a1-b5ab-4579-abf8-3f1797f5b6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec488e3370>]}
[0m22:07:07.168120 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:07:07.179727 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:07:07.204588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:07:07.205175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:07:07.211575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84db72a1-b5ab-4579-abf8-3f1797f5b6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec48684250>]}
[0m22:07:07.219777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84db72a1-b5ab-4579-abf8-3f1797f5b6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec487b7f40>]}
[0m22:07:07.220506 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:07:07.221126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84db72a1-b5ab-4579-abf8-3f1797f5b6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec48654040>]}
[0m22:07:07.222834 [info ] [MainThread]: 
[0m22:07:07.224108 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:07:07.225641 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m22:07:07.226239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:08.412429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m22:07:08.413130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:08.638308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84db72a1-b5ab-4579-abf8-3f1797f5b6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec487b5390>]}
[0m22:07:08.639596 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m22:07:08.640416 [info ] [MainThread]: 
[0m22:07:08.646335 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m22:07:08.647176 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customer ............................... [RUN]
[0m22:07:08.648255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m22:07:08.648769 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m22:07:08.652239 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m22:07:08.653176 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 22:07:08.649084 => 22:07:08.652824
[0m22:07:08.653757 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m22:07:08.670628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:07:08.946840 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m22:07:08.947837 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customer`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m22:07:17.948348 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7cb81bcc-f317-4c6a-b90d-f94d98bdc2fe&page=queryresults
[0m22:07:17.966796 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 22:07:08.654055 => 22:07:17.966562
[0m22:07:17.967829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84db72a1-b5ab-4579-abf8-3f1797f5b6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec48839cf0>]}
[0m22:07:17.968654 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customer .......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 9.32s]
[0m22:07:17.969829 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m22:07:17.971121 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_customers
[0m22:07:17.971881 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_customers ....................... [RUN]
[0m22:07:17.973187 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_customers'
[0m22:07:17.973731 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_customers
[0m22:07:17.977502 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
[0m22:07:17.978501 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_customers (compile): 22:07:17.974184 => 22:07:17.978157
[0m22:07:17.978983 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_customers
[0m22:07:18.005202 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_customers"
[0m22:07:18.006258 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:07:18.006842 [debug] [Thread-3 (]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_customers`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customer`
group by 1;


[0m22:07:18.952569 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:88f9509b-331f-4844-9c75-d56213ef6315&page=queryresults
[0m22:07:18.955825 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_customers (execute): 22:07:17.979312 => 22:07:18.955559
[0m22:07:18.956931 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84db72a1-b5ab-4579-abf8-3f1797f5b6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4883add0>]}
[0m22:07:18.957835 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_customers .................. [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m22:07:18.959090 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_customers
[0m22:07:18.962467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:18.962879 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m22:07:18.963264 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
[0m22:07:18.963712 [info ] [MainThread]: 
[0m22:07:18.964327 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 11.74 seconds (11.74s).
[0m22:07:18.965565 [debug] [MainThread]: Command end result
[0m22:07:18.976702 [info ] [MainThread]: 
[0m22:07:18.977786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:07:18.978558 [info ] [MainThread]: 
[0m22:07:18.979336 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:07:18.980568 [debug] [MainThread]: Command `dbt run` succeeded at 22:07:18.980359 after 12.26 seconds
[0m22:07:18.981229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4b8a2b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec48654100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4883bb50>]}
[0m22:07:18.981963 [debug] [MainThread]: Flushing usage events
[0m22:08:28.430319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c7f72b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c6a97d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c6a97c10>]}


============================== 22:08:28.433480 | 8c9a84f8-1f30-4718-938e-f47882803e1b ==============================
[0m22:08:28.433480 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:08:28.434424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:08:28.817399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c9a84f8-1f30-4718-938e-f47882803e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c4f8b220>]}
[0m22:08:28.834877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c9a84f8-1f30-4718-938e-f47882803e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c4fb70a0>]}
[0m22:08:28.835986 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:08:28.848649 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:08:28.874189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:08:28.874761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:08:28.881260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c9a84f8-1f30-4718-938e-f47882803e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c4d580d0>]}
[0m22:08:28.889358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c9a84f8-1f30-4718-938e-f47882803e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c4e8bd00>]}
[0m22:08:28.890171 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:08:28.890802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c9a84f8-1f30-4718-938e-f47882803e1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c4e8bd90>]}
[0m22:08:28.892679 [info ] [MainThread]: 
[0m22:08:28.893528 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:08:28.894509 [debug] [MainThread]: Command end result
[0m22:08:28.901566 [debug] [MainThread]: Command `dbt test` succeeded at 22:08:28.901359 after 0.48 seconds
[0m22:08:28.902241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c7f72b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c4e89480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c4e8b910>]}
[0m22:08:28.902750 [debug] [MainThread]: Flushing usage events
[0m22:11:34.117185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd4782bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd32b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd32b7c70>]}


============================== 22:11:34.120397 | 76fab2ff-bfaa-4494-9bba-38cf2154b102 ==============================
[0m22:11:34.120397 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:11:34.121286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:11:34.517172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76fab2ff-bfaa-4494-9bba-38cf2154b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd17cfd00>]}
[0m22:11:34.535178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76fab2ff-bfaa-4494-9bba-38cf2154b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd179da80>]}
[0m22:11:34.536411 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:11:34.548499 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:11:34.575667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:11:34.576291 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:11:34.583006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76fab2ff-bfaa-4494-9bba-38cf2154b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd157c9a0>]}
[0m22:11:34.591489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76fab2ff-bfaa-4494-9bba-38cf2154b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd17446a0>]}
[0m22:11:34.592178 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:11:34.592821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76fab2ff-bfaa-4494-9bba-38cf2154b102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd1744640>]}
[0m22:11:34.594471 [info ] [MainThread]: 
[0m22:11:34.595358 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:11:34.596277 [debug] [MainThread]: Command end result
[0m22:11:34.603629 [debug] [MainThread]: Command `dbt test` succeeded at 22:11:34.603397 after 0.49 seconds
[0m22:11:34.604251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd4782bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd179da80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd1744880>]}
[0m22:11:34.604775 [debug] [MainThread]: Flushing usage events
[0m22:12:06.346442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf49a2ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf489d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf489d3c70>]}


============================== 22:12:06.349447 | 6844db22-7df6-4768-9cf8-677075b8a06b ==============================
[0m22:12:06.349447 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:12:06.350315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:12:06.738942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6844db22-7df6-4768-9cf8-677075b8a06b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf46be7c10>]}
[0m22:12:06.771314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6844db22-7df6-4768-9cf8-677075b8a06b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf46bb9a80>]}
[0m22:12:06.772832 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:12:06.793805 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:12:06.876111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:12:06.878526 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:12:06.893165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6844db22-7df6-4768-9cf8-677075b8a06b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf469989a0>]}
[0m22:12:06.909794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6844db22-7df6-4768-9cf8-677075b8a06b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf46abc6a0>]}
[0m22:12:06.910853 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:12:06.913549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6844db22-7df6-4768-9cf8-677075b8a06b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf46abc640>]}
[0m22:12:06.915913 [info ] [MainThread]: 
[0m22:12:06.917421 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:12:06.922884 [debug] [MainThread]: Command end result
[0m22:12:06.935632 [debug] [MainThread]: Command `dbt test` succeeded at 22:12:06.935374 after 0.60 seconds
[0m22:12:06.936450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf49a2ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf46bb9a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf46abc880>]}
[0m22:12:06.937227 [debug] [MainThread]: Flushing usage events
[0m22:12:29.423908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de554ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de41cfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de41cfc10>]}


============================== 22:12:29.427104 | b5fb51c3-9b7a-431c-a214-eb7a8b0d1634 ==============================
[0m22:12:29.427104 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:12:29.427981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:12:29.854092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5fb51c3-9b7a-431c-a214-eb7a8b0d1634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de26c7160>]}
[0m22:12:29.874709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5fb51c3-9b7a-431c-a214-eb7a8b0d1634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de26f20e0>]}
[0m22:12:29.875788 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:12:29.887969 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:12:29.912826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:12:29.913439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:12:29.919863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5fb51c3-9b7a-431c-a214-eb7a8b0d1634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de24940d0>]}
[0m22:12:29.928454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5fb51c3-9b7a-431c-a214-eb7a8b0d1634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de25c3ca0>]}
[0m22:12:29.929149 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:12:29.929829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5fb51c3-9b7a-431c-a214-eb7a8b0d1634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de25c3d30>]}
[0m22:12:29.931429 [info ] [MainThread]: 
[0m22:12:29.932137 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:12:29.933111 [debug] [MainThread]: Command end result
[0m22:12:29.940380 [debug] [MainThread]: Command `dbt test` succeeded at 22:12:29.940109 after 0.52 seconds
[0m22:12:29.941040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de554ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de25c1420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de25c38b0>]}
[0m22:12:29.941611 [debug] [MainThread]: Flushing usage events
[0m22:12:36.147577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5912922bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59113b7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59113b7c40>]}


============================== 22:12:36.150600 | 2eab8aac-fd66-4d63-9900-c9815ae3638b ==============================
[0m22:12:36.150600 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:12:36.151457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:12:36.531925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eab8aac-fd66-4d63-9900-c9815ae3638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590f8cb760>]}
[0m22:12:36.549651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eab8aac-fd66-4d63-9900-c9815ae3638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590f89f850>]}
[0m22:12:36.550703 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:12:36.562939 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:12:36.587754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:12:36.588298 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:12:36.594820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eab8aac-fd66-4d63-9900-c9815ae3638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590f67c5e0>]}
[0m22:12:36.602794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eab8aac-fd66-4d63-9900-c9815ae3638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590f8402e0>]}
[0m22:12:36.603632 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:12:36.604280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eab8aac-fd66-4d63-9900-c9815ae3638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590f840280>]}
[0m22:12:36.607084 [info ] [MainThread]: 
[0m22:12:36.608495 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:12:36.610032 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m22:12:36.610760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:12:37.727626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m22:12:37.729096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:12:37.945349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eab8aac-fd66-4d63-9900-c9815ae3638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590f8b72b0>]}
[0m22:12:37.946537 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m22:12:37.947498 [info ] [MainThread]: 
[0m22:12:37.953036 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m22:12:37.953851 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customer ............................... [RUN]
[0m22:12:37.955006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m22:12:37.955459 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m22:12:37.959488 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m22:12:37.960825 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 22:12:37.955805 => 22:12:37.960556
[0m22:12:37.961362 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m22:12:37.977565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:38.277487 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m22:12:38.278543 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customer`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m22:12:46.054509 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ef6fc701-0301-4512-94df-c291fd6972d7&page=queryresults
[0m22:12:46.073704 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 22:12:37.961779 => 22:12:46.073448
[0m22:12:46.074759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eab8aac-fd66-4d63-9900-c9815ae3638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590f67dc90>]}
[0m22:12:46.075585 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customer .......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.12s]
[0m22:12:46.076752 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m22:12:46.077874 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_customers
[0m22:12:46.078848 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_customers ....................... [RUN]
[0m22:12:46.080087 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_customers'
[0m22:12:46.080585 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_customers
[0m22:12:46.085242 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
[0m22:12:46.090067 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_customers (compile): 22:12:46.081220 => 22:12:46.089659
[0m22:12:46.090821 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_customers
[0m22:12:46.121242 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_customers"
[0m22:12:46.122310 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:12:46.122918 [debug] [Thread-3 (]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_customers`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customer`
group by 1;


[0m22:12:47.476108 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:511fe56b-17f0-42e6-88e2-bda6a9416194&page=queryresults
[0m22:12:47.480370 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_customers (execute): 22:12:46.091313 => 22:12:47.480077
[0m22:12:47.481675 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eab8aac-fd66-4d63-9900-c9815ae3638b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590f748af0>]}
[0m22:12:47.482631 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_customers .................. [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m22:12:47.483694 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_customers
[0m22:12:47.486335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:12:47.486726 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m22:12:47.487090 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
[0m22:12:47.487515 [info ] [MainThread]: 
[0m22:12:47.488096 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.88 seconds (10.88s).
[0m22:12:47.489352 [debug] [MainThread]: Command end result
[0m22:12:47.498959 [info ] [MainThread]: 
[0m22:12:47.500020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:12:47.500780 [info ] [MainThread]: 
[0m22:12:47.501463 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:12:47.502700 [debug] [MainThread]: Command `dbt run` succeeded at 22:12:47.502507 after 11.36 seconds
[0m22:12:47.503204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5912922bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590f89f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590f8b6b60>]}
[0m22:12:47.503705 [debug] [MainThread]: Flushing usage events
[0m22:12:57.993727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba6d9ec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba5897dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba5897ca0>]}


============================== 22:12:57.996793 | 862d8829-a4f8-406c-82b0-c6009a68a1e6 ==============================
[0m22:12:57.996793 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:12:57.997684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:12:58.406718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '862d8829-a4f8-406c-82b0-c6009a68a1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba3da7ca0>]}
[0m22:12:58.426789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '862d8829-a4f8-406c-82b0-c6009a68a1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba3d92c80>]}
[0m22:12:58.427842 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:12:58.439868 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:12:58.466493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:12:58.467104 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:12:58.473665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '862d8829-a4f8-406c-82b0-c6009a68a1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba3b58a90>]}
[0m22:12:58.481812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '862d8829-a4f8-406c-82b0-c6009a68a1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba3d20790>]}
[0m22:12:58.482538 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:12:58.483337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '862d8829-a4f8-406c-82b0-c6009a68a1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba3d20730>]}
[0m22:12:58.484824 [info ] [MainThread]: 
[0m22:12:58.485550 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:12:58.486450 [debug] [MainThread]: Command end result
[0m22:12:58.493303 [debug] [MainThread]: Command `dbt test` succeeded at 22:12:58.493109 after 0.51 seconds
[0m22:12:58.493924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba6d9ec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba3d20190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba3d201c0>]}
[0m22:12:58.494384 [debug] [MainThread]: Flushing usage events
[0m22:26:42.537146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acdf4abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acca97d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acca97c70>]}


============================== 22:26:42.540037 | ac7523fe-d073-4d2b-a0e7-939d119ccef0 ==============================
[0m22:26:42.540037 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:26:42.540851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:26:42.910129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac7523fe-d073-4d2b-a0e7-939d119ccef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acafa7ca0>]}
[0m22:26:42.928470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac7523fe-d073-4d2b-a0e7-939d119ccef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acaf7b400>]}
[0m22:26:42.929507 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:26:42.941540 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:26:42.966514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:26:42.967122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:26:42.973688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac7523fe-d073-4d2b-a0e7-939d119ccef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acad5feb0>]}
[0m22:26:42.982480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac7523fe-d073-4d2b-a0e7-939d119ccef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acaf20640>]}
[0m22:26:42.983246 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:26:42.984548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac7523fe-d073-4d2b-a0e7-939d119ccef0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acaf205e0>]}
[0m22:26:42.986614 [info ] [MainThread]: 
[0m22:26:42.987472 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:26:42.988321 [debug] [MainThread]: Command end result
[0m22:26:42.995639 [debug] [MainThread]: Command `dbt test` succeeded at 22:26:42.995393 after 0.47 seconds
[0m22:26:42.996246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acdf4abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acaf7b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1acaf20820>]}
[0m22:26:42.996736 [debug] [MainThread]: Flushing usage events
[0m22:27:30.260185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8dadebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8c593d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8c593c70>]}


============================== 22:27:30.263204 | 0560e2c1-2243-4072-9a99-6183bcac4140 ==============================
[0m22:27:30.263204 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:27:30.264074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:27:30.665439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0560e2c1-2243-4072-9a99-6183bcac4140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8d5751e0>]}
[0m22:27:30.683532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0560e2c1-2243-4072-9a99-6183bcac4140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8aab3250>]}
[0m22:27:30.684549 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:27:30.696553 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:27:30.721476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:27:30.722070 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:27:30.728645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0560e2c1-2243-4072-9a99-6183bcac4140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8a8541c0>]}
[0m22:27:30.736831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0560e2c1-2243-4072-9a99-6183bcac4140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8a98beb0>]}
[0m22:27:30.737664 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:27:30.738488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0560e2c1-2243-4072-9a99-6183bcac4140', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8a98bf40>]}
[0m22:27:30.740180 [info ] [MainThread]: 
[0m22:27:30.740925 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:27:30.741880 [debug] [MainThread]: Command end result
[0m22:27:30.748865 [debug] [MainThread]: Command `dbt test` succeeded at 22:27:30.748611 after 0.50 seconds
[0m22:27:30.749615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8dadebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8aa20070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8a98bac0>]}
[0m22:27:30.750211 [debug] [MainThread]: Flushing usage events
[0m22:27:56.659950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7d2f0abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7d1993d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7d1993c70>]}


============================== 22:27:56.662940 | fc971772-c9f0-46f4-b504-e6fee9d1ccfa ==============================
[0m22:27:56.662940 [info ] [MainThread]: Running with dbt=1.5.2
[0m22:27:56.663780 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:27:57.058342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc971772-c9f0-46f4-b504-e6fee9d1ccfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cfea3b20>]}
[0m22:27:57.076047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc971772-c9f0-46f4-b504-e6fee9d1ccfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cfe77790>]}
[0m22:27:57.077161 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:27:57.089398 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m22:27:57.114173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:27:57.114728 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:27:57.121212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc971772-c9f0-46f4-b504-e6fee9d1ccfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cfc5beb0>]}
[0m22:27:57.129329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc971772-c9f0-46f4-b504-e6fee9d1ccfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cfe1c4c0>]}
[0m22:27:57.130129 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m22:27:57.130745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc971772-c9f0-46f4-b504-e6fee9d1ccfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cfe1c460>]}
[0m22:27:57.132223 [info ] [MainThread]: 
[0m22:27:57.132880 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:27:57.133885 [debug] [MainThread]: Command end result
[0m22:27:57.141720 [debug] [MainThread]: Command `dbt test` succeeded at 22:27:57.141464 after 0.49 seconds
[0m22:27:57.142336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7d2f0abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cfe77790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7cfe1c6a0>]}
[0m22:27:57.142819 [debug] [MainThread]: Flushing usage events
[0m00:51:25.218862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b0a96bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84af593d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84af593c70>]}


============================== 00:51:25.227008 | a5a44c0a-1868-498e-be67-24434714a9ae ==============================
[0m00:51:25.227008 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:51:25.227854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:51:25.594019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5a44c0a-1868-498e-be67-24434714a9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b05751e0>]}
[0m00:51:25.611865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5a44c0a-1868-498e-be67-24434714a9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84adab3310>]}
[0m00:51:25.612712 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:51:25.625768 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:51:25.693338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:51:25.694193 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:51:25.703355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5a44c0a-1868-498e-be67-24434714a9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ad854220>]}
[0m00:51:25.718533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5a44c0a-1868-498e-be67-24434714a9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ad98bf10>]}
[0m00:51:25.719110 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:51:25.720085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5a44c0a-1868-498e-be67-24434714a9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ada24040>]}
[0m00:51:25.721762 [info ] [MainThread]: 
[0m00:51:25.722992 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:51:25.724388 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m00:51:25.725074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:29.612671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m00:51:29.613362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:51:29.824789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5a44c0a-1868-498e-be67-24434714a9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ad989360>]}
[0m00:51:29.825796 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m00:51:29.826416 [info ] [MainThread]: 
[0m00:51:29.838845 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m00:51:29.839551 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customer ............................... [RUN]
[0m00:51:29.840626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m00:51:29.841377 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m00:51:29.845306 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m00:51:29.846241 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 00:51:29.842157 => 00:51:29.845891
[0m00:51:29.846798 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m00:51:29.863467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:30.141740 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m00:51:30.142838 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customer`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m00:51:37.543387 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a4818805-372f-4c4d-b840-28236a0189ea&page=queryresults
[0m00:51:37.560849 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 00:51:29.847117 => 00:51:37.560628
[0m00:51:37.561782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5a44c0a-1868-498e-be67-24434714a9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ad8de950>]}
[0m00:51:37.562553 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customer .......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 7.72s]
[0m00:51:37.563707 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m00:51:37.564854 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_customers
[0m00:51:37.565729 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_customers ....................... [RUN]
[0m00:51:37.566913 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_customers'
[0m00:51:37.567430 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_customers
[0m00:51:37.571076 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
[0m00:51:37.572063 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_customers (compile): 00:51:37.567802 => 00:51:37.571677
[0m00:51:37.572527 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_customers
[0m00:51:37.598133 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_customers"
[0m00:51:37.599096 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:51:37.599661 [debug] [Thread-3 (]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_customers`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customer`
group by 1;


[0m00:51:38.224700 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fa75202c-43e1-4019-b42a-fee78725b80f&page=queryresults
[0m00:51:38.228100 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_customers (execute): 00:51:37.572864 => 00:51:38.227832
[0m00:51:38.229254 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5a44c0a-1868-498e-be67-24434714a9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84adab10f0>]}
[0m00:51:38.230035 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_customers .................. [[32mCREATE VIEW (0 processed)[0m in 0.66s]
[0m00:51:38.231063 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_customers
[0m00:51:38.233354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:51:38.233742 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m00:51:38.234082 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
[0m00:51:38.234477 [info ] [MainThread]: 
[0m00:51:38.235034 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 12.51 seconds (12.51s).
[0m00:51:38.237263 [debug] [MainThread]: Command end result
[0m00:51:38.245987 [info ] [MainThread]: 
[0m00:51:38.246759 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:51:38.247486 [info ] [MainThread]: 
[0m00:51:38.248891 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:51:38.250208 [debug] [MainThread]: Command `dbt run` succeeded at 00:51:38.250013 after 13.05 seconds
[0m00:51:38.250705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b0a96bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ada240a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84adab3310>]}
[0m00:51:38.251176 [debug] [MainThread]: Flushing usage events
[0m00:51:56.331347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f009c2d2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f009adbfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f009adbfc70>]}


============================== 00:51:56.334089 | 5afbbdb8-86bb-41eb-ae99-32e1fb47e893 ==============================
[0m00:51:56.334089 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:51:56.334900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:51:56.735784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5afbbdb8-86bb-41eb-ae99-32e1fb47e893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00992d7a30>]}
[0m00:51:56.753184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5afbbdb8-86bb-41eb-ae99-32e1fb47e893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00992a7790>]}
[0m00:51:56.754022 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:51:56.765149 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:51:56.789980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:51:56.790446 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:51:56.796527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5afbbdb8-86bb-41eb-ae99-32e1fb47e893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f009908beb0>]}
[0m00:51:56.804625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5afbbdb8-86bb-41eb-ae99-32e1fb47e893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00992484c0>]}
[0m00:51:56.805374 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:51:56.805961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5afbbdb8-86bb-41eb-ae99-32e1fb47e893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0099248460>]}
[0m00:51:56.807809 [info ] [MainThread]: 
[0m00:51:56.808450 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:51:56.809838 [debug] [MainThread]: Command end result
[0m00:51:56.817556 [debug] [MainThread]: Command `dbt test` succeeded at 00:51:56.817415 after 0.49 seconds
[0m00:51:56.818028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f009c2d2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00992a7790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00992486a0>]}
[0m00:51:56.818489 [debug] [MainThread]: Flushing usage events
[0m00:53:22.278779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa0fc8ab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa0e9cfd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa0e9cfbe0>]}


============================== 00:53:22.281573 | f7e76dfb-8980-4994-9493-f45b3310449f ==============================
[0m00:53:22.281573 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:53:22.282366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:53:22.680951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7e76dfb-8980-4994-9493-f45b3310449f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa0cebdba0>]}
[0m00:53:22.698430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7e76dfb-8980-4994-9493-f45b3310449f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa0cef14e0>]}
[0m00:53:22.699338 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:53:22.710866 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:53:22.736732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:53:22.737121 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:53:22.742981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7e76dfb-8980-4994-9493-f45b3310449f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa0cc94430>]}
[0m00:53:22.751032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7e76dfb-8980-4994-9493-f45b3310449f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa0cdb4130>]}
[0m00:53:22.751563 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:53:22.752125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e76dfb-8980-4994-9493-f45b3310449f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa0cdb40d0>]}
[0m00:53:22.753493 [info ] [MainThread]: 
[0m00:53:22.754126 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:53:22.754998 [debug] [MainThread]: Command end result
[0m00:53:22.761655 [debug] [MainThread]: Command `dbt test` succeeded at 00:53:22.761459 after 0.49 seconds
[0m00:53:22.762214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa0fc8ab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa0cdb4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa0cdb4100>]}
[0m00:53:22.762822 [debug] [MainThread]: Flushing usage events
[0m00:57:37.846258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60401ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa602fd3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa602fd3cd0>]}


============================== 00:57:37.849099 | 07b09677-625c-421c-b436-c259edf1ecb3 ==============================
[0m00:57:37.849099 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:57:37.849921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:57:38.228286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07b09677-625c-421c-b436-c259edf1ecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6011e7a90>]}
[0m00:57:38.246317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07b09677-625c-421c-b436-c259edf1ecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6011bba90>]}
[0m00:57:38.247262 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:57:38.258783 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:57:38.282798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:57:38.283276 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:57:38.289894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07b09677-625c-421c-b436-c259edf1ecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa600f9ff40>]}
[0m00:57:38.297900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07b09677-625c-421c-b436-c259edf1ecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6010b8610>]}
[0m00:57:38.298581 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:57:38.299275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07b09677-625c-421c-b436-c259edf1ecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6010b85b0>]}
[0m00:57:38.300973 [info ] [MainThread]: 
[0m00:57:38.302191 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:57:38.303736 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m00:57:38.304212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:57:39.372873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m00:57:39.373656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:57:39.581914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07b09677-625c-421c-b436-c259edf1ecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6010b8160>]}
[0m00:57:39.583055 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m00:57:39.583755 [info ] [MainThread]: 
[0m00:57:39.589923 [debug] [Thread-1 (]: Began running node model.coffee_shop.customer
[0m00:57:39.590545 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customer ............................... [RUN]
[0m00:57:39.591776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customer)
[0m00:57:39.592248 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customer
[0m00:57:39.596069 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customer"
[0m00:57:39.597004 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (compile): 00:57:39.592958 => 00:57:39.596669
[0m00:57:39.597528 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customer
[0m00:57:39.612795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:57:39.875837 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customer"
[0m00:57:39.877025 [debug] [Thread-1 (]: On model.coffee_shop.customer: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customer"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customer`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m00:57:48.225480 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3480fa72-ccdf-4cdc-a296-defecf59a4e9&page=queryresults
[0m00:57:48.244648 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customer (execute): 00:57:39.597846 => 00:57:48.244424
[0m00:57:48.245599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07b09677-625c-421c-b436-c259edf1ecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6010230a0>]}
[0m00:57:48.246394 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customer .......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.65s]
[0m00:57:48.247570 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customer
[0m00:57:48.248740 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_customers
[0m00:57:48.249563 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_customers ....................... [RUN]
[0m00:57:48.250686 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_customers'
[0m00:57:48.251149 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_customers
[0m00:57:48.254779 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_customers"
[0m00:57:48.255770 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_customers (compile): 00:57:48.251497 => 00:57:48.255368
[0m00:57:48.256221 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_customers
[0m00:57:48.280946 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_customers"
[0m00:57:48.281913 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:57:48.282419 [debug] [Thread-3 (]: On model.coffee_shop.monthly_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_customers`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customer`
group by 1;


[0m00:57:48.946935 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:bedcbc94-12c6-418c-b6f7-ae6638bae73e&page=queryresults
[0m00:57:48.950349 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_customers (execute): 00:57:48.256539 => 00:57:48.950074
[0m00:57:48.951401 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07b09677-625c-421c-b436-c259edf1ecb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6011d0dc0>]}
[0m00:57:48.952168 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_customers .................. [[32mCREATE VIEW (0 processed)[0m in 0.70s]
[0m00:57:48.953376 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_customers
[0m00:57:48.955959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:57:48.956345 [debug] [MainThread]: Connection 'model.coffee_shop.customer' was properly closed.
[0m00:57:48.956698 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_customers' was properly closed.
[0m00:57:48.957099 [info ] [MainThread]: 
[0m00:57:48.958132 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.66 seconds (10.66s).
[0m00:57:48.960989 [debug] [MainThread]: Command end result
[0m00:57:48.974534 [info ] [MainThread]: 
[0m00:57:48.975299 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:57:48.976058 [info ] [MainThread]: 
[0m00:57:48.977131 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:57:48.978390 [debug] [MainThread]: Command `dbt run` succeeded at 00:57:48.978229 after 11.14 seconds
[0m00:57:48.978863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60401ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6011bba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa600669360>]}
[0m00:57:48.979350 [debug] [MainThread]: Flushing usage events
[0m00:58:21.097864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fdb922b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fda497d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fda497c10>]}


============================== 00:58:21.100719 | 5de9f4f6-c7c9-4fc1-bd2d-97826a0d81ff ==============================
[0m00:58:21.100719 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:58:21.101525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:58:21.455550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5de9f4f6-c7c9-4fc1-bd2d-97826a0d81ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fd8979c90>]}
[0m00:58:21.473062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5de9f4f6-c7c9-4fc1-bd2d-97826a0d81ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fd89b4040>]}
[0m00:58:21.473923 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:58:21.484942 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:58:21.508854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:58:21.509280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:58:21.515038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5de9f4f6-c7c9-4fc1-bd2d-97826a0d81ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fd8758550>]}
[0m00:58:21.522366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5de9f4f6-c7c9-4fc1-bd2d-97826a0d81ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fd89201f0>]}
[0m00:58:21.523006 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m00:58:21.523652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5de9f4f6-c7c9-4fc1-bd2d-97826a0d81ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fd89202e0>]}
[0m00:58:21.525037 [info ] [MainThread]: 
[0m00:58:21.525707 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:58:21.526661 [debug] [MainThread]: Command end result
[0m00:58:21.532736 [debug] [MainThread]: Command `dbt test` succeeded at 00:58:21.532554 after 0.44 seconds
[0m00:58:21.533308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fdb922b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fdb926380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fd8920250>]}
[0m00:58:21.533757 [debug] [MainThread]: Flushing usage events
[0m01:04:52.743370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9db56bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9c7cfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9c7cfc70>]}


============================== 01:04:52.746119 | 7a27ba66-60ad-464c-812c-238bab96935c ==============================
[0m01:04:52.746119 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:04:52.747096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:04:53.101115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a27ba66-60ad-464c-812c-238bab96935c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9d7b11e0>]}
[0m01:04:53.118386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a27ba66-60ad-464c-812c-238bab96935c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9acf3340>]}
[0m01:04:53.119266 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:04:53.130519 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:04:53.154089 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m01:04:53.154575 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/example/monthly_customers.sql
[0m01:04:53.154976 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/example/customer.sql
[0m01:04:53.161135 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop
[0m01:04:53.170368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a27ba66-60ad-464c-812c-238bab96935c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9aa9c0d0>]}
[0m01:04:53.180677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a27ba66-60ad-464c-812c-238bab96935c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9abc3e20>]}
[0m01:04:53.181459 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:04:53.182253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a27ba66-60ad-464c-812c-238bab96935c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9abc1750>]}
[0m01:04:53.183940 [info ] [MainThread]: 
[0m01:04:53.184675 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:04:53.185658 [debug] [MainThread]: Command end result
[0m01:04:53.196136 [debug] [MainThread]: Command `dbt test` succeeded at 01:04:53.195947 after 0.46 seconds
[0m01:04:53.196871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9db56bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9abc3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9abc1510>]}
[0m01:04:53.197576 [debug] [MainThread]: Flushing usage events
[0m01:05:01.279618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f3cd6b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f2793d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f2793be0>]}


============================== 01:05:01.283807 | 34e8d23b-48be-4272-ae77-106bb060307c ==============================
[0m01:05:01.283807 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:05:01.284869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:05:01.693119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34e8d23b-48be-4272-ae77-106bb060307c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f0ca77f0>]}
[0m01:05:01.710334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34e8d23b-48be-4272-ae77-106bb060307c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f0c778b0>]}
[0m01:05:01.711153 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:05:01.721961 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:05:01.744855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:05:01.745321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:05:01.745805 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop
[0m01:05:01.752837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34e8d23b-48be-4272-ae77-106bb060307c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f0c400d0>]}
[0m01:05:01.761426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34e8d23b-48be-4272-ae77-106bb060307c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f0b7b4f0>]}
[0m01:05:01.762094 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:05:01.762682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34e8d23b-48be-4272-ae77-106bb060307c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f0b7b580>]}
[0m01:05:01.764092 [info ] [MainThread]: 
[0m01:05:01.764889 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:05:01.765940 [debug] [MainThread]: Command end result
[0m01:05:01.772791 [debug] [MainThread]: Command `dbt run` succeeded at 01:05:01.772645 after 0.50 seconds
[0m01:05:01.773277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f3cd6b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f0b7b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73f0b78d00>]}
[0m01:05:01.773750 [debug] [MainThread]: Flushing usage events
[0m01:08:04.655321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9bd2ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9a9cfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9a9cfc70>]}


============================== 01:08:04.658142 | a7690c6c-200c-4367-8f43-89a7bbab8885 ==============================
[0m01:08:04.658142 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:08:04.658933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:08:05.008602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7690c6c-200c-4367-8f43-89a7bbab8885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b98ee3ac0>]}
[0m01:08:05.027908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7690c6c-200c-4367-8f43-89a7bbab8885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b98eb7700>]}
[0m01:08:05.028980 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:08:05.040695 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:08:05.064562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:08:05.065182 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/customers.sql
[0m01:08:05.090706 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m01:08:05.113031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7690c6c-200c-4367-8f43-89a7bbab8885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b98d080d0>]}
[0m01:08:05.120383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7690c6c-200c-4367-8f43-89a7bbab8885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b98e43e20>]}
[0m01:08:05.120958 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:08:05.121789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7690c6c-200c-4367-8f43-89a7bbab8885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b98e43f10>]}
[0m01:08:05.123290 [info ] [MainThread]: 
[0m01:08:05.124688 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:08:05.126628 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m01:08:05.127147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:06.236522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m01:08:06.237189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:08:06.503113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7690c6c-200c-4367-8f43-89a7bbab8885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b98e43280>]}
[0m01:08:06.504384 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:08:06.505147 [info ] [MainThread]: 
[0m01:08:06.514159 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m01:08:06.514826 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_marcel.customers .............................. [RUN]
[0m01:08:06.515937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m01:08:06.516396 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m01:08:06.519982 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m01:08:06.520847 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 01:08:06.516749 => 01:08:06.520566
[0m01:08:06.521317 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m01:08:06.565230 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m01:08:06.566140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:06.566684 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m01:08:13.788848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0278cadf-3e81-4bb6-83fb-7236b27836d0&page=queryresults
[0m01:08:13.803906 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 01:08:06.521680 => 01:08:13.803680
[0m01:08:13.804861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7690c6c-200c-4367-8f43-89a7bbab8885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b98e4dc30>]}
[0m01:08:13.805661 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 7.29s]
[0m01:08:13.806805 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m01:08:13.809310 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:08:13.809708 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m01:08:13.810140 [info ] [MainThread]: 
[0m01:08:13.810890 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.69 seconds (8.69s).
[0m01:08:13.812208 [debug] [MainThread]: Command end result
[0m01:08:13.819074 [info ] [MainThread]: 
[0m01:08:13.819838 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:08:13.820547 [info ] [MainThread]: 
[0m01:08:13.821364 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:08:13.822338 [debug] [MainThread]: Command `dbt run` succeeded at 01:08:13.822204 after 9.17 seconds
[0m01:08:13.822790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b9bd2ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b987683d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b98eb5c90>]}
[0m01:08:13.823358 [debug] [MainThread]: Flushing usage events
[0m01:08:46.372927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31b27eebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31b1297d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31b1297c70>]}


============================== 01:08:46.375757 | f4b18a57-6d03-4c7c-9777-d3e03cf4af9d ==============================
[0m01:08:46.375757 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:08:46.376553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:08:46.748261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4b18a57-6d03-4c7c-9777-d3e03cf4af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31af7abc70>]}
[0m01:08:46.765713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4b18a57-6d03-4c7c-9777-d3e03cf4af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31af77b400>]}
[0m01:08:46.766584 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:08:46.778097 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:08:46.802626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:08:46.803068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:08:46.808898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4b18a57-6d03-4c7c-9777-d3e03cf4af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31af558430>]}
[0m01:08:46.818303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4b18a57-6d03-4c7c-9777-d3e03cf4af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31af678130>]}
[0m01:08:46.819104 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:08:46.820180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4b18a57-6d03-4c7c-9777-d3e03cf4af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31af6780d0>]}
[0m01:08:46.822765 [info ] [MainThread]: 
[0m01:08:46.824373 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:08:46.826864 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m01:08:46.828039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:47.920664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m01:08:47.921452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:08:48.184524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4b18a57-6d03-4c7c-9777-d3e03cf4af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31af793010>]}
[0m01:08:48.185540 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:08:48.186416 [info ] [MainThread]: 
[0m01:08:48.191635 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m01:08:48.192343 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_marcel.customers .............................. [RUN]
[0m01:08:48.193311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m01:08:48.193770 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m01:08:48.197437 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m01:08:48.198378 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 01:08:48.194069 => 01:08:48.197962
[0m01:08:48.198811 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m01:08:48.213896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:48.460824 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m01:08:48.461763 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m01:08:56.602462 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:51d1a48d-628a-41a4-80a4-c1cca0613bd2&page=queryresults
[0m01:08:56.620819 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 01:08:48.199094 => 01:08:56.620579
[0m01:08:56.621770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4b18a57-6d03-4c7c-9777-d3e03cf4af9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31af559ab0>]}
[0m01:08:56.622563 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.43s]
[0m01:08:56.623766 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m01:08:56.626219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:08:56.626602 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m01:08:56.627006 [info ] [MainThread]: 
[0m01:08:56.627790 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.80 seconds (9.80s).
[0m01:08:56.628803 [debug] [MainThread]: Command end result
[0m01:08:56.642169 [info ] [MainThread]: 
[0m01:08:56.642887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:08:56.643599 [info ] [MainThread]: 
[0m01:08:56.644349 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:08:56.645378 [debug] [MainThread]: Command `dbt run` succeeded at 01:08:56.645252 after 10.28 seconds
[0m01:08:56.645837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31b27eebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31af77b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31af7334f0>]}
[0m01:08:56.646315 [debug] [MainThread]: Flushing usage events
[0m01:09:04.661676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8d0426bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8cef93d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8cef93c40>]}


============================== 01:09:04.664406 | 5e75dda9-23da-46da-8875-b3710e397876 ==============================
[0m01:09:04.664406 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:09:04.665213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:09:05.015132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e75dda9-23da-46da-8875-b3710e397876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8cd487460>]}
[0m01:09:05.032215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e75dda9-23da-46da-8875-b3710e397876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8cd4b3220>]}
[0m01:09:05.033309 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:09:05.044669 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:09:05.068663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:09:05.069096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:09:05.076810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e75dda9-23da-46da-8875-b3710e397876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8cd44c0d0>]}
[0m01:09:05.084440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e75dda9-23da-46da-8875-b3710e397876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8cd387940>]}
[0m01:09:05.085090 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:09:05.085771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e75dda9-23da-46da-8875-b3710e397876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8cd3879d0>]}
[0m01:09:05.087117 [info ] [MainThread]: 
[0m01:09:05.087812 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:09:05.088765 [debug] [MainThread]: Command end result
[0m01:09:05.095115 [debug] [MainThread]: Command `dbt test` succeeded at 01:09:05.094930 after 0.44 seconds
[0m01:09:05.095678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8d0426bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8cd3850c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8cd387550>]}
[0m01:09:05.096137 [debug] [MainThread]: Flushing usage events
[0m01:10:30.528501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca479abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca37d3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca37d3c40>]}


============================== 01:10:30.531303 | dcf78bc5-0397-4f5a-85b5-ea4cb9d8afbb ==============================
[0m01:10:30.531303 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:10:30.532116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:10:31.032071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcf78bc5-0397-4f5a-85b5-ea4cb9d8afbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca19c2950>]}
[0m01:10:31.050119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcf78bc5-0397-4f5a-85b5-ea4cb9d8afbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca19f74c0>]}
[0m01:10:31.051094 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:10:31.062689 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:10:31.070543 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:10:31.071358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dcf78bc5-0397-4f5a-85b5-ea4cb9d8afbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca479e3b0>]}
[0m01:10:31.829099 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop
[0m01:10:31.835654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcf78bc5-0397-4f5a-85b5-ea4cb9d8afbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca37d3850>]}
[0m01:10:31.843109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcf78bc5-0397-4f5a-85b5-ea4cb9d8afbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca37d3fa0>]}
[0m01:10:31.843910 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:10:31.844508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcf78bc5-0397-4f5a-85b5-ea4cb9d8afbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca1b2d1e0>]}
[0m01:10:31.848050 [info ] [MainThread]: 
[0m01:10:31.850095 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:10:31.851028 [debug] [MainThread]: Command end result
[0m01:10:31.858528 [debug] [MainThread]: Command `dbt run` succeeded at 01:10:31.858394 after 1.34 seconds
[0m01:10:31.858971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca479abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca1ae1300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca1f2d360>]}
[0m01:10:31.859410 [debug] [MainThread]: Flushing usage events
[0m01:11:04.592942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd244abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd13d3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd13d3c40>]}


============================== 01:11:04.595687 | c46bbb14-bdce-4f2b-ab08-b8cfb4fe2fd4 ==============================
[0m01:11:04.595687 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:11:04.596645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:11:04.959907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c46bbb14-bdce-4f2b-ab08-b8cfb4fe2fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ccf5e7b80>]}
[0m01:11:04.977609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c46bbb14-bdce-4f2b-ab08-b8cfb4fe2fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ccf5b98a0>]}
[0m01:11:04.978444 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:11:04.990187 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:11:04.997471 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:11:04.998077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c46bbb14-bdce-4f2b-ab08-b8cfb4fe2fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ccf5d2f80>]}
[0m01:11:05.749188 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m01:11:05.803021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c46bbb14-bdce-4f2b-ab08-b8cfb4fe2fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ccf5e6c50>]}
[0m01:11:05.809887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c46bbb14-bdce-4f2b-ab08-b8cfb4fe2fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ccefd1570>]}
[0m01:11:05.810626 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:11:05.811212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c46bbb14-bdce-4f2b-ab08-b8cfb4fe2fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ccefd33a0>]}
[0m01:11:05.812683 [info ] [MainThread]: 
[0m01:11:05.813965 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:11:05.815471 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m01:11:05.816078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:06.883381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m01:11:06.884194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:11:07.099566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c46bbb14-bdce-4f2b-ab08-b8cfb4fe2fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ccefd3be0>]}
[0m01:11:07.100965 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:11:07.101763 [info ] [MainThread]: 
[0m01:11:07.108452 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m01:11:07.109087 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_marcel.customers .............................. [RUN]
[0m01:11:07.110196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m01:11:07.110796 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m01:11:07.114884 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m01:11:07.115982 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 01:11:07.111237 => 01:11:07.115424
[0m01:11:07.116622 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m01:11:07.134791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:07.372052 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m01:11:07.373042 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m01:11:16.971267 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4a255ae2-238b-44d3-9fee-88ce9c704cba&page=queryresults
[0m01:11:16.989714 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 01:11:07.117043 => 01:11:16.989484
[0m01:11:16.990671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c46bbb14-bdce-4f2b-ab08-b8cfb4fe2fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ccf047940>]}
[0m01:11:16.991466 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 9.88s]
[0m01:11:16.992720 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m01:11:16.995193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:16.995626 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m01:11:16.996027 [info ] [MainThread]: 
[0m01:11:16.996589 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.18 seconds (11.18s).
[0m01:11:16.997622 [debug] [MainThread]: Command end result
[0m01:11:17.010753 [info ] [MainThread]: 
[0m01:11:17.011562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:11:17.012261 [info ] [MainThread]: 
[0m01:11:17.012918 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:11:17.014002 [debug] [MainThread]: Command `dbt run` succeeded at 01:11:17.013839 after 12.43 seconds
[0m01:11:17.014470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cd244abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ccf466bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ccf979420>]}
[0m01:11:17.015080 [debug] [MainThread]: Flushing usage events
[0m01:12:19.250614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236f656b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236e2d3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236e2d3c10>]}


============================== 01:12:19.253416 | 2243ac77-4471-4299-b246-0f3ab3b20e18 ==============================
[0m01:12:19.253416 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:12:19.254218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:12:19.663269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2243ac77-4471-4299-b246-0f3ab3b20e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236c7cb130>]}
[0m01:12:19.680566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2243ac77-4471-4299-b246-0f3ab3b20e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236c7f6080>]}
[0m01:12:19.681393 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:12:19.692348 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:12:19.700113 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:12:19.700723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2243ac77-4471-4299-b246-0f3ab3b20e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236f7121a0>]}
[0m01:12:20.502156 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m01:12:20.555825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2243ac77-4471-4299-b246-0f3ab3b20e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236c573160>]}
[0m01:12:20.562735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2243ac77-4471-4299-b246-0f3ab3b20e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236c5daaa0>]}
[0m01:12:20.563485 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:12:20.564066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2243ac77-4471-4299-b246-0f3ab3b20e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236c5dbee0>]}
[0m01:12:20.565394 [info ] [MainThread]: 
[0m01:12:20.566021 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:12:20.566922 [debug] [MainThread]: Command end result
[0m01:12:20.573067 [debug] [MainThread]: Command `dbt test` succeeded at 01:12:20.572886 after 1.33 seconds
[0m01:12:20.573630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236f656b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236c7f7ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236c7f4df0>]}
[0m01:12:20.574070 [debug] [MainThread]: Flushing usage events
[0m01:12:41.325973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d75aab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d60c3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d60c3c10>]}


============================== 01:12:41.328792 | 60a5311d-6923-4fc6-a7a3-c6297931da2a ==============================
[0m01:12:41.328792 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:12:41.329800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:12:41.718210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60a5311d-6923-4fc6-a7a3-c6297931da2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d45bab60>]}
[0m01:12:41.736635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60a5311d-6923-4fc6-a7a3-c6297931da2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d45e5ed0>]}
[0m01:12:41.737851 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:12:41.757213 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:12:41.785020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:12:41.785549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:12:41.791598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60a5311d-6923-4fc6-a7a3-c6297931da2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d43840d0>]}
[0m01:12:41.798999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60a5311d-6923-4fc6-a7a3-c6297931da2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d44b75b0>]}
[0m01:12:41.799752 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:12:41.800368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60a5311d-6923-4fc6-a7a3-c6297931da2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d44b7640>]}
[0m01:12:41.802172 [info ] [MainThread]: 
[0m01:12:41.803264 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:12:41.804655 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m01:12:41.805198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:12:42.882227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m01:12:42.882911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:12:43.119894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60a5311d-6923-4fc6-a7a3-c6297931da2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d44b4a00>]}
[0m01:12:43.121107 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:12:43.122114 [info ] [MainThread]: 
[0m01:12:43.128363 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m01:12:43.128987 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_marcel.customers .............................. [RUN]
[0m01:12:43.129914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m01:12:43.130373 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m01:12:43.133802 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m01:12:43.134784 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 01:12:43.130666 => 01:12:43.134346
[0m01:12:43.135373 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m01:12:43.150776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:43.422361 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m01:12:43.423363 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m01:12:50.894306 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2d86f610-ea63-45df-b67b-e817a7d45ed9&page=queryresults
[0m01:12:50.912962 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 01:12:43.135845 => 01:12:50.912739
[0m01:12:50.913879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60a5311d-6923-4fc6-a7a3-c6297931da2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d453e440>]}
[0m01:12:50.914650 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 7.78s]
[0m01:12:50.915785 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m01:12:50.917903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:12:50.918268 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m01:12:50.918667 [info ] [MainThread]: 
[0m01:12:50.919226 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.12 seconds (9.12s).
[0m01:12:50.920586 [debug] [MainThread]: Command end result
[0m01:12:50.933228 [info ] [MainThread]: 
[0m01:12:50.933957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:12:50.934635 [info ] [MainThread]: 
[0m01:12:50.935277 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:12:50.936462 [debug] [MainThread]: Command `dbt run` succeeded at 01:12:50.936284 after 9.62 seconds
[0m01:12:50.936927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d75aab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d89cbb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81d43645e0>]}
[0m01:12:50.937386 [debug] [MainThread]: Flushing usage events
[0m01:12:59.713115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f30eebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f1bbfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f1bbfc70>]}


============================== 01:12:59.715830 | 7807651f-9b03-4fc4-9a35-42dcea354005 ==============================
[0m01:12:59.715830 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:12:59.716635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:13:00.120725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7807651f-9b03-4fc4-9a35-42dcea354005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f00b7610>]}
[0m01:13:00.138568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7807651f-9b03-4fc4-9a35-42dcea354005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f00e3190>]}
[0m01:13:00.139534 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:13:00.151113 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:13:00.175026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:13:00.175536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:13:00.181450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7807651f-9b03-4fc4-9a35-42dcea354005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05efe800d0>]}
[0m01:13:00.189516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7807651f-9b03-4fc4-9a35-42dcea354005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05effb3910>]}
[0m01:13:00.190125 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:13:00.191274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7807651f-9b03-4fc4-9a35-42dcea354005', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05effb39a0>]}
[0m01:13:00.194037 [info ] [MainThread]: 
[0m01:13:00.195101 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:13:00.196089 [debug] [MainThread]: Command end result
[0m01:13:00.202191 [debug] [MainThread]: Command `dbt test` succeeded at 01:13:00.202015 after 0.50 seconds
[0m01:13:00.202715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f30eebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05effb1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05effb3520>]}
[0m01:13:00.203164 [debug] [MainThread]: Flushing usage events
[0m01:19:19.273093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eef736bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eee1b7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eee1b4e50>]}


============================== 01:19:19.275828 | e1ccda46-2577-40c2-8249-fd584d6cfca5 ==============================
[0m01:19:19.275828 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:19:19.276624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:19:19.277177 [info ] [MainThread]: dbt version: 1.5.2
[0m01:19:19.277724 [info ] [MainThread]: python version: 3.10.6
[0m01:19:19.278364 [info ] [MainThread]: python path: /usr/local/python/current/bin/python
[0m01:19:19.279000 [info ] [MainThread]: os info: Linux-5.15.0-1041-azure-x86_64-with-glibc2.35
[0m01:19:19.279694 [info ] [MainThread]: Using profiles.yml file at /home/vscode/.dbt/profiles.yml
[0m01:19:19.280339 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/aec-self-study-marcel/coffee_shop_marcel/dbt_project.yml
[0m01:19:19.280999 [info ] [MainThread]: Configuration:
[0m01:19:19.620858 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:19:19.664386 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:19:19.665250 [info ] [MainThread]: Required dependencies:
[0m01:19:19.665904 [debug] [MainThread]: Executing "git --help"
[0m01:19:19.690281 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:19:19.691280 [debug] [MainThread]: STDERR: "b''"
[0m01:19:19.692029 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:19:19.692803 [info ] [MainThread]: Connection:
[0m01:19:19.693491 [info ] [MainThread]:   method: oauth
[0m01:19:19.694391 [info ] [MainThread]:   database: aec-students
[0m01:19:19.695697 [info ] [MainThread]:   schema: dbt_marcel
[0m01:19:19.697053 [info ] [MainThread]:   location: US
[0m01:19:19.697998 [info ] [MainThread]:   priority: interactive
[0m01:19:19.699271 [info ] [MainThread]:   timeout_seconds: 300
[0m01:19:19.700182 [info ] [MainThread]:   maximum_bytes_billed: None
[0m01:19:19.701229 [info ] [MainThread]:   execution_project: aec-students
[0m01:19:19.701950 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m01:19:19.702775 [info ] [MainThread]:   job_retries: 1
[0m01:19:19.703465 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m01:19:19.704416 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m01:19:19.705113 [info ] [MainThread]:   gcs_bucket: None
[0m01:19:19.706366 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:19:19.707371 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m01:19:19.707840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:20.462071 [debug] [MainThread]: On debug: select 1 as id
[0m01:19:21.444151 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e5d790d6-fb3c-4eff-b25d-ac99d667a212&page=queryresults
[0m01:19:21.444770 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:19:21.445562 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:19:21.446763 [debug] [MainThread]: Command `dbt debug` succeeded at 01:19:21.446588 after 2.18 seconds
[0m01:19:21.447426 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:19:21.448119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eef736bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eec6b5240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eec6b6e00>]}
[0m01:19:21.449499 [debug] [MainThread]: Flushing usage events
[0m01:22:25.192394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f519245ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5190f93b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5190f90eb0>]}


============================== 01:22:25.195140 | 4aa35f20-f18e-4fde-ac34-b9e01e7b0545 ==============================
[0m01:22:25.195140 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:22:25.195994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:22:25.196596 [info ] [MainThread]: dbt version: 1.5.2
[0m01:22:25.197128 [info ] [MainThread]: python version: 3.10.6
[0m01:22:25.197746 [info ] [MainThread]: python path: /usr/local/python/current/bin/python
[0m01:22:25.198375 [info ] [MainThread]: os info: Linux-5.15.0-1041-azure-x86_64-with-glibc2.35
[0m01:22:25.198988 [info ] [MainThread]: Using profiles.yml file at /home/vscode/.dbt/profiles.yml
[0m01:22:25.199562 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/aec-self-study-marcel/coffee_shop_marcel/dbt_project.yml
[0m01:22:25.200221 [info ] [MainThread]: Configuration:
[0m01:22:25.535411 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:22:25.561523 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:22:25.562220 [info ] [MainThread]: Required dependencies:
[0m01:22:25.562892 [debug] [MainThread]: Executing "git --help"
[0m01:22:25.565301 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:22:25.565805 [debug] [MainThread]: STDERR: "b''"
[0m01:22:25.566213 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:22:25.566840 [info ] [MainThread]: Connection:
[0m01:22:25.567421 [info ] [MainThread]:   method: oauth
[0m01:22:25.568111 [info ] [MainThread]:   database: aec-students
[0m01:22:25.568795 [info ] [MainThread]:   schema: dbt_marcel
[0m01:22:25.569403 [info ] [MainThread]:   location: US
[0m01:22:25.570067 [info ] [MainThread]:   priority: interactive
[0m01:22:25.570713 [info ] [MainThread]:   timeout_seconds: 300
[0m01:22:25.571392 [info ] [MainThread]:   maximum_bytes_billed: None
[0m01:22:25.572049 [info ] [MainThread]:   execution_project: aec-students
[0m01:22:25.572600 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m01:22:25.573262 [info ] [MainThread]:   job_retries: 1
[0m01:22:25.573924 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m01:22:25.574492 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m01:22:25.575161 [info ] [MainThread]:   gcs_bucket: None
[0m01:22:25.576218 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:22:25.577246 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m01:22:25.577789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:22:26.198482 [debug] [MainThread]: On debug: select 1 as id
[0m01:22:27.157802 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ddf22a5c-4d5a-42cd-87c1-5463e4951e02&page=queryresults
[0m01:22:27.158607 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:22:27.159563 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:22:27.160772 [debug] [MainThread]: Command `dbt debug` succeeded at 01:22:27.160608 after 1.98 seconds
[0m01:22:27.161262 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:22:27.162027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f519245ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518f45aef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518f45ace0>]}
[0m01:22:27.162736 [debug] [MainThread]: Flushing usage events
[0m01:27:47.565761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef08922c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef073bfdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef073bfca0>]}


============================== 01:27:47.568545 | 80283d12-9fa3-4ccc-b61c-8961e64511c5 ==============================
[0m01:27:47.568545 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:27:47.569534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:27:47.999789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80283d12-9fa3-4ccc-b61c-8961e64511c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef058d77c0>]}
[0m01:27:48.020110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80283d12-9fa3-4ccc-b61c-8961e64511c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef058a77c0>]}
[0m01:27:48.021472 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:27:48.035314 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:27:48.043555 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m01:27:48.044305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '80283d12-9fa3-4ccc-b61c-8961e64511c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef058a6d40>]}
[0m01:27:48.806053 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m01:27:48.896586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80283d12-9fa3-4ccc-b61c-8961e64511c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef05314c10>]}
[0m01:27:48.903902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80283d12-9fa3-4ccc-b61c-8961e64511c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef052acb50>]}
[0m01:27:48.904611 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:27:48.905211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80283d12-9fa3-4ccc-b61c-8961e64511c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef058a7730>]}
[0m01:27:48.906798 [info ] [MainThread]: 
[0m01:27:48.908044 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:27:48.909549 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m01:27:48.910103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:50.017721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m01:27:50.018413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:27:50.250285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80283d12-9fa3-4ccc-b61c-8961e64511c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef053159c0>]}
[0m01:27:50.251871 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:27:50.252970 [info ] [MainThread]: 
[0m01:27:50.260552 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m01:27:50.261222 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_marcel.customers .............................. [RUN]
[0m01:27:50.262185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m01:27:50.262635 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m01:27:50.270186 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m01:27:50.271106 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 01:27:50.262982 => 01:27:50.270774
[0m01:27:50.271597 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m01:27:50.286548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:27:50.550860 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m01:27:50.552697 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m01:27:58.772600 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2fb1af3d-462b-403a-b1cb-c93f5f84f9e3&page=queryresults
[0m01:27:58.791464 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 01:27:50.271922 => 01:27:58.791201
[0m01:27:58.792469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80283d12-9fa3-4ccc-b61c-8961e64511c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef05193f70>]}
[0m01:27:58.793275 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.53s]
[0m01:27:58.794443 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m01:27:58.797069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:27:58.797473 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m01:27:58.797894 [info ] [MainThread]: 
[0m01:27:58.798476 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.89 seconds (9.89s).
[0m01:27:58.799548 [debug] [MainThread]: Command end result
[0m01:27:58.807257 [info ] [MainThread]: 
[0m01:27:58.808049 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:27:58.808750 [info ] [MainThread]: 
[0m01:27:58.809489 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:27:58.810709 [debug] [MainThread]: Command `dbt run` succeeded at 01:27:58.810511 after 11.25 seconds
[0m01:27:58.811288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef08922c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef087f07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef05289e70>]}
[0m01:27:58.811803 [debug] [MainThread]: Flushing usage events
[0m01:28:07.819797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440ddaeb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440c8b7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440c8b7be0>]}


============================== 01:28:07.822769 | 917daa58-99f8-409e-9c45-9877bc476f74 ==============================
[0m01:28:07.822769 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:28:07.823621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:28:08.258454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '917daa58-99f8-409e-9c45-9877bc476f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440adaf1f0>]}
[0m01:28:08.275810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '917daa58-99f8-409e-9c45-9877bc476f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440adda0e0>]}
[0m01:28:08.276696 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:28:08.288318 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:28:08.313045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:28:08.313563 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:28:08.319676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '917daa58-99f8-409e-9c45-9877bc476f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440ab8beb0>]}
[0m01:28:08.327585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '917daa58-99f8-409e-9c45-9877bc476f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440ad48640>]}
[0m01:28:08.328233 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:28:08.329032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '917daa58-99f8-409e-9c45-9877bc476f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440ad485e0>]}
[0m01:28:08.330848 [info ] [MainThread]: 
[0m01:28:08.331954 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:28:08.333440 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m01:28:08.333948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:09.432544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m01:28:09.433233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:09.645814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '917daa58-99f8-409e-9c45-9877bc476f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440ad48190>]}
[0m01:28:09.646885 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:28:09.647799 [info ] [MainThread]: 
[0m01:28:09.652991 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m01:28:09.653654 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_marcel.customers .............................. [RUN]
[0m01:28:09.654615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m01:28:09.655096 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m01:28:09.658802 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m01:28:09.659805 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 01:28:09.655566 => 01:28:09.659378
[0m01:28:09.660267 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m01:28:09.675452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:09.938280 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m01:28:09.939382 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m01:28:17.743558 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:bdc083c8-7eb3-4dc7-a187-10660fd150f1&page=queryresults
[0m01:28:17.761291 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 01:28:09.660587 => 01:28:17.761053
[0m01:28:17.762335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '917daa58-99f8-409e-9c45-9877bc476f74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440ab88400>]}
[0m01:28:17.763149 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.11s]
[0m01:28:17.764353 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m01:28:17.766415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:17.766784 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m01:28:17.767195 [info ] [MainThread]: 
[0m01:28:17.767793 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.44 seconds (9.44s).
[0m01:28:17.768685 [debug] [MainThread]: Command end result
[0m01:28:17.782074 [info ] [MainThread]: 
[0m01:28:17.782963 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:28:17.783686 [info ] [MainThread]: 
[0m01:28:17.784407 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:28:17.785574 [debug] [MainThread]: Command `dbt run` succeeded at 01:28:17.785428 after 9.97 seconds
[0m01:28:17.786019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440ddaeb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440f1d7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f440ab6b5e0>]}
[0m01:28:17.786510 [debug] [MainThread]: Flushing usage events
[0m01:28:40.404260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c8bfec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c76c3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c76c3ca0>]}


============================== 01:28:40.407045 | ac1c8dc7-2cf4-4c5d-99b8-1176624b5186 ==============================
[0m01:28:40.407045 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:28:40.408132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:28:40.813643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac1c8dc7-2cf4-4c5d-99b8-1176624b5186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c5ba9bd0>]}
[0m01:28:40.831725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac1c8dc7-2cf4-4c5d-99b8-1176624b5186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c5be5450>]}
[0m01:28:40.832809 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:28:40.845238 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:28:40.870308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:28:40.870925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:28:40.877413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac1c8dc7-2cf4-4c5d-99b8-1176624b5186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c5990e80>]}
[0m01:28:40.885734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac1c8dc7-2cf4-4c5d-99b8-1176624b5186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c5abcb80>]}
[0m01:28:40.886480 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:28:40.887209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac1c8dc7-2cf4-4c5d-99b8-1176624b5186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c5abcb20>]}
[0m01:28:40.889074 [info ] [MainThread]: 
[0m01:28:40.890227 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:28:40.891743 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m01:28:40.892232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:41.934457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac1c8dc7-2cf4-4c5d-99b8-1176624b5186', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c5b43550>]}
[0m01:28:41.935788 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:28:41.936717 [info ] [MainThread]: 
[0m01:28:41.942512 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m01:28:41.943076 [info ] [Thread-1 (]: 1 of 2 START test not_null_customers_customer_id ............................... [RUN]
[0m01:28:41.944108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m01:28:41.944543 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m01:28:41.952767 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m01:28:41.960947 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m01:28:41.961513 [info ] [Thread-2 (]: 2 of 2 START test unique_customers_customer_id ................................. [RUN]
[0m01:28:41.963161 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m01:28:41.963778 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m01:28:41.971023 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m01:28:41.972178 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 01:28:41.964154 => 01:28:41.971826
[0m01:28:41.972816 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m01:28:41.973446 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 01:28:41.944848 => 01:28:41.973212
[0m01:28:41.992723 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m01:28:41.993235 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m01:28:41.996367 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m01:28:41.997397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:41.997993 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:28:41.998511 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m01:28:41.999032 [debug] [Thread-2 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m01:28:43.294067 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a4067929-abd7-4d08-9153-8ff6fc661ffe&page=queryresults
[0m01:28:43.296413 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 01:28:41.993822 => 01:28:43.296132
[0m01:28:43.297419 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.35s]
[0m01:28:43.298552 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m01:28:43.804197 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:689ba86b-207d-4810-baa1-b00fb9d2eeb3&page=queryresults
[0m01:28:43.805550 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 01:28:41.973698 => 01:28:43.805212
[0m01:28:43.806823 [info ] [Thread-2 (]: 2 of 2 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.84s]
[0m01:28:43.808089 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m01:28:43.810950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:43.811402 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m01:28:43.811820 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m01:28:43.812247 [info ] [MainThread]: 
[0m01:28:43.813009 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m01:28:43.814507 [debug] [MainThread]: Command end result
[0m01:28:43.821582 [info ] [MainThread]: 
[0m01:28:43.822402 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:28:43.823062 [info ] [MainThread]: 
[0m01:28:43.823749 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:28:43.824885 [debug] [MainThread]: Command `dbt test` succeeded at 01:28:43.824736 after 3.43 seconds
[0m01:28:43.825378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c8bfec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c405b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5c5ccc640>]}
[0m01:28:43.826065 [debug] [MainThread]: Flushing usage events
[0m01:31:09.340653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292365ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2922193d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2922193c70>]}


============================== 01:31:09.343472 | 14d9bf25-5fb5-4199-b6ba-125d782d3e1f ==============================
[0m01:31:09.343472 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:31:09.344298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:31:09.703824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14d9bf25-5fb5-4199-b6ba-125d782d3e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29206a7940>]}
[0m01:31:09.721005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14d9bf25-5fb5-4199-b6ba-125d782d3e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2920677670>]}
[0m01:31:09.721904 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:31:09.733037 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:31:09.757469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:31:09.758139 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/monthly_orders.sql
[0m01:31:09.785405 [debug] [MainThread]: 1699: static parser successfully parsed monthly_orders.sql
[0m01:31:09.798280 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop.monthly_orders' (models/monthly_orders.sql) depends on a node named 'customer' which was not found
[0m01:31:09.799414 [debug] [MainThread]: Command `dbt run` failed at 01:31:09.799259 after 0.47 seconds
[0m01:31:09.799949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f292365ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29206213c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2920621360>]}
[0m01:31:09.800553 [debug] [MainThread]: Flushing usage events
[0m01:31:58.104698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2ecc6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2d9cfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2d9cfc70>]}


============================== 01:31:58.107519 | fcfa3a44-981d-4b22-aa14-1a84fa3a18c5 ==============================
[0m01:31:58.107519 [info ] [MainThread]: Running with dbt=1.5.2
[0m01:31:58.108338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m01:31:58.468992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcfa3a44-981d-4b22-aa14-1a84fa3a18c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2bec7490>]}
[0m01:31:58.486561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcfa3a44-981d-4b22-aa14-1a84fa3a18c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2bef3070>]}
[0m01:31:58.487454 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:31:58.498468 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m01:31:58.522993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:31:58.523643 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/monthly_orders.sql
[0m01:31:58.549041 [debug] [MainThread]: 1699: static parser successfully parsed monthly_orders.sql
[0m01:31:58.573297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcfa3a44-981d-4b22-aa14-1a84fa3a18c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2bd03eb0>]}
[0m01:31:58.581236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcfa3a44-981d-4b22-aa14-1a84fa3a18c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2be4f400>]}
[0m01:31:58.581795 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m01:31:58.582382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcfa3a44-981d-4b22-aa14-1a84fa3a18c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2be4f4f0>]}
[0m01:31:58.584008 [info ] [MainThread]: 
[0m01:31:58.585188 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:31:58.586677 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m01:31:58.587209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:59.721912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m01:31:59.722655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:59.977803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcfa3a44-981d-4b22-aa14-1a84fa3a18c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2bcb0880>]}
[0m01:31:59.978857 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m01:31:59.979517 [info ] [MainThread]: 
[0m01:31:59.984967 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m01:31:59.985639 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customers .............................. [RUN]
[0m01:31:59.986560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m01:31:59.987014 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m01:31:59.991633 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m01:31:59.992992 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 01:31:59.987374 => 01:31:59.992639
[0m01:31:59.993673 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m01:32:00.017593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:00.299362 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m01:32:00.300446 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m01:32:08.929231 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f9ed493d-c33c-456f-bc00-afd30136250a&page=queryresults
[0m01:32:08.947954 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 01:31:59.994150 => 01:32:08.947724
[0m01:32:08.948902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcfa3a44-981d-4b22-aa14-1a84fa3a18c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2bd00760>]}
[0m01:32:08.949683 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.96s]
[0m01:32:08.950880 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m01:32:08.952148 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m01:32:08.952853 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_orders .......................... [RUN]
[0m01:32:08.953962 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m01:32:08.954413 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m01:32:08.958026 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m01:32:08.958846 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 01:32:08.954762 => 01:32:08.958560
[0m01:32:08.959283 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m01:32:08.979872 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_orders"
[0m01:32:08.980710 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:32:08.981230 [debug] [Thread-3 (]: On model.coffee_shop.monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customers`
group by 1;


[0m01:32:09.895062 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e74755ff-9b5f-4f2e-a9a0-549f73ca036e&page=queryresults
[0m01:32:09.898006 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 01:32:08.959602 => 01:32:09.897739
[0m01:32:09.899114 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcfa3a44-981d-4b22-aa14-1a84fa3a18c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2bd00760>]}
[0m01:32:09.900056 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m01:32:09.901190 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m01:32:09.903730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:32:09.904100 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m01:32:09.904484 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m01:32:09.904892 [info ] [MainThread]: 
[0m01:32:09.905617 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 11.32 seconds (11.32s).
[0m01:32:09.906824 [debug] [MainThread]: Command end result
[0m01:32:09.923965 [info ] [MainThread]: 
[0m01:32:09.924855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:32:09.925572 [info ] [MainThread]: 
[0m01:32:09.926597 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:32:09.927859 [debug] [MainThread]: Command `dbt run` succeeded at 01:32:09.927704 after 11.83 seconds
[0m01:32:09.928304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2ecc6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2b79bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2b79ba90>]}
[0m01:32:09.928794 [debug] [MainThread]: Flushing usage events
[0m12:39:55.605549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef011eab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeffc97be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeffc97b80>]}


============================== 12:39:55.620132 | 36773836-750d-4f4c-a315-9832aa7a75a9 ==============================
[0m12:39:55.620132 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:39:55.621076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:39:55.621786 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /workspaces/aec-self-study-marcel/coffee_shop_marcel/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m12:39:55.622778 [debug] [MainThread]: Command `dbt run` failed at 12:39:55.622572 after 0.04 seconds
[0m12:39:55.623586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef011eab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeffc97a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feeffc97b20>]}
[0m12:39:55.624104 [debug] [MainThread]: Flushing usage events
[0m12:41:05.367634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2004002b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2002fd3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2002fd3be0>]}


============================== 12:41:05.370573 | 0e786fea-cf5a-46ec-88e1-e749079ea591 ==============================
[0m12:41:05.370573 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:41:05.371527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:41:05.731828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e786fea-cf5a-46ec-88e1-e749079ea591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20011eb8e0>]}
[0m12:41:05.749486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e786fea-cf5a-46ec-88e1-e749079ea591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20011bb5e0>]}
[0m12:41:05.750441 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:41:05.761935 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:41:05.858946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:41:05.859581 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:41:05.866566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e786fea-cf5a-46ec-88e1-e749079ea591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2000fa5630>]}
[0m12:41:05.875252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e786fea-cf5a-46ec-88e1-e749079ea591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20010d12d0>]}
[0m12:41:05.875901 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:41:05.876591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e786fea-cf5a-46ec-88e1-e749079ea591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20010d13c0>]}
[0m12:41:05.878443 [info ] [MainThread]: 
[0m12:41:05.880314 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:41:05.881745 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:41:05.882718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:10.489007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m12:41:10.489885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:41:10.705784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e786fea-cf5a-46ec-88e1-e749079ea591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2000f579a0>]}
[0m12:41:10.706924 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:41:10.707589 [info ] [MainThread]: 
[0m12:41:10.723525 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m12:41:10.724195 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customers .............................. [RUN]
[0m12:41:10.725058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m12:41:10.725530 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m12:41:10.730195 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m12:41:10.731241 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 12:41:10.725827 => 12:41:10.730921
[0m12:41:10.731700 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m12:41:10.746931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:10.996480 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m12:41:10.997442 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m12:41:18.720752 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5109e3a5-fab9-439d-9ecd-826c86279975&page=queryresults
[0m12:41:18.738874 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 12:41:10.732039 => 12:41:18.738635
[0m12:41:18.739894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e786fea-cf5a-46ec-88e1-e749079ea591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200102ff70>]}
[0m12:41:18.740762 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.02s]
[0m12:41:18.741867 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m12:41:18.743051 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m12:41:18.743916 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_orders .......................... [RUN]
[0m12:41:18.745053 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m12:41:18.745496 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m12:41:18.749120 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m12:41:18.750154 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 12:41:18.745811 => 12:41:18.749874
[0m12:41:18.750644 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m12:41:18.775830 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_orders"
[0m12:41:18.776945 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:41:18.777700 [debug] [Thread-3 (]: On model.coffee_shop.monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customers`
group by 1;


[0m12:41:19.381941 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:36125914-930f-482d-9345-d6e1893e3c31&page=queryresults
[0m12:41:19.384954 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 12:41:18.750995 => 12:41:19.384744
[0m12:41:19.385898 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e786fea-cf5a-46ec-88e1-e749079ea591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2000fa4670>]}
[0m12:41:19.386624 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 0.64s]
[0m12:41:19.387739 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m12:41:19.390395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:19.390766 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m12:41:19.391125 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m12:41:19.391579 [info ] [MainThread]: 
[0m12:41:19.392515 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 13.51 seconds (13.51s).
[0m12:41:19.394925 [debug] [MainThread]: Command end result
[0m12:41:19.403406 [info ] [MainThread]: 
[0m12:41:19.404045 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:41:19.404674 [info ] [MainThread]: 
[0m12:41:19.405457 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:41:19.406762 [debug] [MainThread]: Command `dbt run` succeeded at 12:41:19.406618 after 14.05 seconds
[0m12:41:19.407233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2004002b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2001043340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20011baf20>]}
[0m12:41:19.407714 [debug] [MainThread]: Flushing usage events
[0m12:46:06.308586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c9ff6b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c8ab7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c8ab7be0>]}


============================== 12:46:06.311506 | 8beb58f8-94da-4cfb-a54c-dd2a171a5527 ==============================
[0m12:46:06.311506 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:46:06.312371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:46:06.685094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8beb58f8-94da-4cfb-a54c-dd2a171a5527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c6fcfa30>]}
[0m12:46:06.702510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8beb58f8-94da-4cfb-a54c-dd2a171a5527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c6f9f070>]}
[0m12:46:06.703437 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:46:06.714724 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:46:06.740145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:46:06.740744 [debug] [MainThread]: Partial parsing: added file: coffee_shop://tests/customers_test.sql
[0m12:46:06.741394 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m12:46:06.766505 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m12:46:06.855009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8beb58f8-94da-4cfb-a54c-dd2a171a5527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c6e2be80>]}
[0m12:46:06.862485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8beb58f8-94da-4cfb-a54c-dd2a171a5527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c6f49570>]}
[0m12:46:06.863087 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:46:06.863733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8beb58f8-94da-4cfb-a54c-dd2a171a5527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c6f49510>]}
[0m12:46:06.865405 [info ] [MainThread]: 
[0m12:46:06.866595 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:46:06.868173 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:46:06.868723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:08.117814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m12:46:08.118631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:08.361986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8beb58f8-94da-4cfb-a54c-dd2a171a5527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c6f485e0>]}
[0m12:46:08.363176 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:46:08.364029 [info ] [MainThread]: 
[0m12:46:08.369936 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m12:46:08.370622 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customers .............................. [RUN]
[0m12:46:08.371717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m12:46:08.372167 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m12:46:08.381466 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m12:46:08.382395 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 12:46:08.372543 => 12:46:08.382127
[0m12:46:08.382835 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m12:46:08.399437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:46:08.671983 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m12:46:08.672921 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m12:46:16.516208 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d6c8dd08-3912-408f-88b2-eb6cad8aba76&page=queryresults
[0m12:46:16.535079 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 12:46:08.383124 => 12:46:16.534843
[0m12:46:16.536098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8beb58f8-94da-4cfb-a54c-dd2a171a5527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c6e2a140>]}
[0m12:46:16.536901 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.16s]
[0m12:46:16.538193 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m12:46:16.539812 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m12:46:16.540497 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_orders .......................... [RUN]
[0m12:46:16.541671 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m12:46:16.542226 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m12:46:16.545914 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m12:46:16.546818 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 12:46:16.542899 => 12:46:16.546543
[0m12:46:16.547295 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m12:46:16.568495 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_orders"
[0m12:46:16.569382 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:46:16.569902 [debug] [Thread-3 (]: On model.coffee_shop.monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customers`
group by 1;


[0m12:46:17.177880 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:126aaacc-ae38-4576-8d96-303f80f09ed1&page=queryresults
[0m12:46:17.181243 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 12:46:16.547600 => 12:46:17.180968
[0m12:46:17.182598 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8beb58f8-94da-4cfb-a54c-dd2a171a5527', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c6e2a140>]}
[0m12:46:17.183508 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 0.64s]
[0m12:46:17.184547 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m12:46:17.187116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:17.187554 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m12:46:17.187914 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m12:46:17.188328 [info ] [MainThread]: 
[0m12:46:17.188908 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.32 seconds (10.32s).
[0m12:46:17.190083 [debug] [MainThread]: Command end result
[0m12:46:17.259136 [info ] [MainThread]: 
[0m12:46:17.259939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:46:17.260630 [info ] [MainThread]: 
[0m12:46:17.261427 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:46:17.262480 [debug] [MainThread]: Command `dbt run` succeeded at 12:46:17.262343 after 10.96 seconds
[0m12:46:17.262919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c9ff6b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c7b4fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65c71116c0>]}
[0m12:46:17.263479 [debug] [MainThread]: Flushing usage events
[0m12:46:24.545613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd920fbab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91fa97d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91fa97c10>]}


============================== 12:46:24.548481 | 0d6d5676-c60b-478f-b865-b4cbab8cbe37 ==============================
[0m12:46:24.548481 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:46:24.549308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:46:24.918476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d6d5676-c60b-478f-b865-b4cbab8cbe37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91df81b70>]}
[0m12:46:24.935795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d6d5676-c60b-478f-b865-b4cbab8cbe37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91dfb5510>]}
[0m12:46:24.936742 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:46:24.948278 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:46:24.973345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:46:24.973806 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:46:24.980506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d6d5676-c60b-478f-b865-b4cbab8cbe37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91dd71990>]}
[0m12:46:24.988438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d6d5676-c60b-478f-b865-b4cbab8cbe37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91df2d690>]}
[0m12:46:24.988983 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:46:24.989565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d6d5676-c60b-478f-b865-b4cbab8cbe37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91df2d630>]}
[0m12:46:24.991384 [info ] [MainThread]: 
[0m12:46:24.992583 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:46:24.994202 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m12:46:24.994721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:25.972782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d6d5676-c60b-478f-b865-b4cbab8cbe37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91df2d5d0>]}
[0m12:46:25.974071 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:46:25.974858 [info ] [MainThread]: 
[0m12:46:25.982417 [debug] [Thread-1 (]: Began running node test.coffee_shop.customers_test
[0m12:46:25.982962 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:46:25.985171 [info ] [Thread-2 (]: 2 of 4 START test not_null_customers_customer_id ............................... [RUN]
[0m12:46:25.986261 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m12:46:25.984366 [info ] [Thread-1 (]: 1 of 4 START test customers_test ............................................... [RUN]
[0m12:46:25.983854 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:46:25.988773 [info ] [Thread-4 (]: 4 of 4 START test unique_customers_customer_id ................................. [RUN]
[0m12:46:25.989721 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m12:46:25.987656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.customers_test)
[0m12:46:25.983448 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m12:46:25.991267 [info ] [Thread-3 (]: 3 of 4 START test unique_customer_ids_customers_customer_id .................... [RUN]
[0m12:46:25.992229 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f'
[0m12:46:25.990691 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.customers_test
[0m12:46:25.990144 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:46:25.992659 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m12:46:25.986712 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:46:25.997901 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.customers_test"
[0m12:46:26.009201 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:46:26.022732 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:46:26.023809 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f (compile): 12:46:26.009612 => 12:46:26.023555
[0m12:46:26.024678 [debug] [Thread-1 (]: Timing info for test.coffee_shop.customers_test (compile): 12:46:25.993019 => 12:46:26.024401
[0m12:46:26.026721 [debug] [Thread-1 (]: Began executing node test.coffee_shop.customers_test
[0m12:46:26.026174 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 12:46:26.013635 => 12:46:26.025935
[0m12:46:26.027427 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 12:46:25.998260 => 12:46:26.027177
[0m12:46:26.035499 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:46:26.051436 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:46:26.058242 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:46:26.055384 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:46:26.060844 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:46:26.062009 [debug] [Thread-4 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:46:26.061504 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:46:26.060132 [debug] [Thread-3 (]: Compilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)
  'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:46:26.065794 [error] [Thread-3 (]: 3 of 4 ERROR unique_customer_ids_customers_customer_id ......................... [[31mERROR[0m in 0.07s]
[0m12:46:26.052264 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.customers_test"
[0m12:46:26.067004 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m12:46:26.064243 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m12:46:26.071283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:46:26.072524 [debug] [Thread-1 (]: On test.coffee_shop.customers_test: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.customers_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      version: 2

models:
  - name: customers

tests:
  - unique_customer_ids:
      # Define the test logic using a custom SQL query
      query: >
        SELECT
            customer_id
        FROM
            `aec-students`.`dbt_marcel`.`customers`
        GROUP BY
            customer_id
        HAVING COUNT(*) < 2;
      
    ) dbt_internal_test
[0m12:46:26.399567 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got ":" at [7:14]')
[0m12:46:26.977356 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:edf0cb2a-7008-464e-8d0a-83b132b94daa&page=queryresults
[0m12:46:26.979482 [debug] [Thread-1 (]: Timing info for test.coffee_shop.customers_test (execute): 12:46:26.027934 => 12:46:26.978834
[0m12:46:26.998452 [debug] [Thread-1 (]: Database Error in test customers_test (tests/customers_test.sql)
  Syntax error: Expected keyword JOIN but got ":" at [7:14]
  compiled Code at target/run/coffee_shop/tests/customers_test.sql
[0m12:46:26.999244 [error] [Thread-1 (]: 1 of 4 ERROR customers_test .................................................... [[31mERROR[0m in 1.01s]
[0m12:46:27.000049 [debug] [Thread-1 (]: Finished running node test.coffee_shop.customers_test
[0m12:46:27.311187 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:586efb31-dc5d-41a9-803f-b04097d9f877&page=queryresults
[0m12:46:27.313032 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 12:46:26.052817 => 12:46:27.312756
[0m12:46:27.314046 [info ] [Thread-2 (]: 2 of 4 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.33s]
[0m12:46:27.315043 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:46:27.729675 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:25aa1409-063a-49e8-9e6f-f06e0df65f2e&page=queryresults
[0m12:46:27.730848 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 12:46:26.055992 => 12:46:27.730567
[0m12:46:27.731890 [info ] [Thread-4 (]: 4 of 4 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.74s]
[0m12:46:27.733018 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:46:27.735659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:27.736035 [debug] [MainThread]: Connection 'test.coffee_shop.customers_test' was properly closed.
[0m12:46:27.736402 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m12:46:27.736763 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m12:46:27.737174 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f' was properly closed.
[0m12:46:27.737596 [info ] [MainThread]: 
[0m12:46:27.738405 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m12:46:27.739961 [debug] [MainThread]: Command end result
[0m12:46:27.747506 [info ] [MainThread]: 
[0m12:46:27.748268 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:46:27.749009 [info ] [MainThread]: 
[0m12:46:27.749895 [error] [MainThread]: [33mCompilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)[0m
[0m12:46:27.750632 [error] [MainThread]:   'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:46:27.751404 [info ] [MainThread]: 
[0m12:46:27.752289 [error] [MainThread]: [33mDatabase Error in test customers_test (tests/customers_test.sql)[0m
[0m12:46:27.753139 [error] [MainThread]:   Syntax error: Expected keyword JOIN but got ":" at [7:14]
[0m12:46:27.756818 [error] [MainThread]:   compiled Code at target/run/coffee_shop/tests/customers_test.sql
[0m12:46:27.757754 [info ] [MainThread]: 
[0m12:46:27.758720 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m12:46:27.760505 [debug] [MainThread]: Command `dbt test` failed at 12:46:27.760187 after 3.22 seconds
[0m12:46:27.761200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd920fbab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91dfb5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd91df17670>]}
[0m12:46:27.761919 [debug] [MainThread]: Flushing usage events
[0m12:50:22.653084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe164feb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe14fb7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe14fb7c10>]}


============================== 12:50:22.656065 | 0849503c-1f4e-4ea4-8e0b-36db022d5037 ==============================
[0m12:50:22.656065 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:50:22.656918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:50:23.023777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0849503c-1f4e-4ea4-8e0b-36db022d5037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe134aeb30>]}
[0m12:50:23.041155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0849503c-1f4e-4ea4-8e0b-36db022d5037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe134d9f00>]}
[0m12:50:23.042082 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:50:23.053378 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:50:23.078562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:50:23.079373 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m12:50:23.104757 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m12:50:23.162251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0849503c-1f4e-4ea4-8e0b-36db022d5037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe132cc0d0>]}
[0m12:50:23.169372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0849503c-1f4e-4ea4-8e0b-36db022d5037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe1344d0f0>]}
[0m12:50:23.169940 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:50:23.170511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0849503c-1f4e-4ea4-8e0b-36db022d5037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe1344d0c0>]}
[0m12:50:23.172637 [info ] [MainThread]: 
[0m12:50:23.173829 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:50:23.175488 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m12:50:23.175995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:24.152186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0849503c-1f4e-4ea4-8e0b-36db022d5037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe1343bbb0>]}
[0m12:50:24.153307 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:50:24.154250 [info ] [MainThread]: 
[0m12:50:24.159911 [debug] [Thread-1 (]: Began running node test.coffee_shop.customers_test
[0m12:50:24.160503 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:50:24.161171 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:50:24.162898 [info ] [Thread-1 (]: 1 of 3 START test customers_test ............................................... [RUN]
[0m12:50:24.165866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.customers_test)
[0m12:50:24.163908 [info ] [Thread-2 (]: 2 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m12:50:24.167003 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.customers_test
[0m12:50:24.168194 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m12:50:24.173089 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:50:24.172560 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.customers_test"
[0m12:50:24.164840 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m12:50:24.187495 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:50:24.188823 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m12:50:24.189581 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:50:24.190834 [debug] [Thread-1 (]: Timing info for test.coffee_shop.customers_test (compile): 12:50:24.168924 => 12:50:24.190024
[0m12:50:24.194264 [debug] [Thread-1 (]: Began executing node test.coffee_shop.customers_test
[0m12:50:24.202753 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:50:24.203603 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 12:50:24.173404 => 12:50:24.203307
[0m12:50:24.226289 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:50:24.225834 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 12:50:24.191107 => 12:50:24.225481
[0m12:50:24.230721 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:50:24.230082 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:50:24.224664 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.customers_test"
[0m12:50:24.233861 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:50:24.234961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:50:24.235957 [debug] [Thread-1 (]: On test.coffee_shop.customers_test: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.customers_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      version: 2

models:
  - name: customers

tests:
  - unique_customer_ids:
      # Define the test logic using a custom SQL query
      query: >
        SELECT
            customer_id
        FROM
            `aec-students`.`dbt_marcel`.`customers`
        GROUP BY
            customer_id
        HAVING COUNT(*) < 2;
      
    ) dbt_internal_test
[0m12:50:24.236550 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:50:24.240066 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:50:24.236963 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:50:24.242840 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m12:50:24.641335 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got ":" at [7:14]')
[0m12:50:24.966800 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8ef9c4ef-bcef-4aab-97b3-81b73ed1e2aa&page=queryresults
[0m12:50:24.968429 [debug] [Thread-1 (]: Timing info for test.coffee_shop.customers_test (execute): 12:50:24.204047 => 12:50:24.968075
[0m12:50:24.972106 [debug] [Thread-1 (]: Database Error in test customers_test (tests/customers_test.sql)
  Syntax error: Expected keyword JOIN but got ":" at [7:14]
  compiled Code at target/run/coffee_shop/tests/customers_test.sql
[0m12:50:24.972797 [error] [Thread-1 (]: 1 of 3 ERROR customers_test .................................................... [[31mERROR[0m in 0.81s]
[0m12:50:24.974163 [debug] [Thread-1 (]: Finished running node test.coffee_shop.customers_test
[0m12:50:25.444274 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:dbec65b2-f424-4920-b1ee-5193beb0706d&page=queryresults
[0m12:50:25.446197 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 12:50:24.231420 => 12:50:25.445897
[0m12:50:25.447400 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.26s]
[0m12:50:25.448500 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:50:25.540786 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2c8089d1-38bc-4dc0-9a97-863ff852c172&page=queryresults
[0m12:50:25.542234 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 12:50:24.226720 => 12:50:25.541879
[0m12:50:25.543432 [info ] [Thread-2 (]: 2 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.38s]
[0m12:50:25.544677 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:50:25.547741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:25.548150 [debug] [MainThread]: Connection 'test.coffee_shop.customers_test' was properly closed.
[0m12:50:25.548543 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m12:50:25.548918 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m12:50:25.549361 [info ] [MainThread]: 
[0m12:50:25.550007 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m12:50:25.551634 [debug] [MainThread]: Command end result
[0m12:50:25.559539 [info ] [MainThread]: 
[0m12:50:25.560238 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:50:25.560908 [info ] [MainThread]: 
[0m12:50:25.561639 [error] [MainThread]: [33mDatabase Error in test customers_test (tests/customers_test.sql)[0m
[0m12:50:25.562509 [error] [MainThread]:   Syntax error: Expected keyword JOIN but got ":" at [7:14]
[0m12:50:25.563241 [error] [MainThread]:   compiled Code at target/run/coffee_shop/tests/customers_test.sql
[0m12:50:25.564052 [info ] [MainThread]: 
[0m12:50:25.565043 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m12:50:25.566204 [debug] [MainThread]: Command `dbt test` failed at 12:50:25.565988 after 2.92 seconds
[0m12:50:25.567031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe164feb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe134d9f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe12ddff10>]}
[0m12:50:25.567648 [debug] [MainThread]: Flushing usage events
[0m12:51:37.840612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aed2ceb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aebd93d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aebd93c10>]}


============================== 12:51:37.843468 | 90edfb21-7d78-4aa9-8b2c-463be7598bec ==============================
[0m12:51:37.843468 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:51:37.844335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:51:38.204266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90edfb21-7d78-4aa9-8b2c-463be7598bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aea279b40>]}
[0m12:51:38.221573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90edfb21-7d78-4aa9-8b2c-463be7598bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aea2b1540>]}
[0m12:51:38.222496 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:51:38.234116 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:51:38.258959 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m12:51:38.259581 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://tests/customers_test.sql
[0m12:51:38.271005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90edfb21-7d78-4aa9-8b2c-463be7598bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aea079420>]}
[0m12:51:38.278233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90edfb21-7d78-4aa9-8b2c-463be7598bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aea229360>]}
[0m12:51:38.278800 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:51:38.279581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90edfb21-7d78-4aa9-8b2c-463be7598bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aea229330>]}
[0m12:51:38.281378 [info ] [MainThread]: 
[0m12:51:38.282540 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:51:38.284096 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m12:51:38.284651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:51:39.304038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90edfb21-7d78-4aa9-8b2c-463be7598bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aea2291e0>]}
[0m12:51:39.305685 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:51:39.306687 [info ] [MainThread]: 
[0m12:51:39.312283 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:51:39.312828 [info ] [Thread-1 (]: 1 of 2 START test not_null_customers_customer_id ............................... [RUN]
[0m12:51:39.313781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m12:51:39.314228 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:51:39.320247 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:51:39.328783 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:51:39.329254 [info ] [Thread-2 (]: 2 of 2 START test unique_customers_customer_id ................................. [RUN]
[0m12:51:39.330726 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m12:51:39.331292 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:51:39.338560 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:51:39.339549 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 12:51:39.331859 => 12:51:39.339270
[0m12:51:39.340142 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 12:51:39.314526 => 12:51:39.339856
[0m12:51:39.340531 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:51:39.341006 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:51:39.362944 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:51:39.365763 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:51:39.366678 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:51:39.367675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:51:39.368139 [debug] [Thread-2 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:51:39.368644 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m12:51:40.480735 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8e5ecd28-4782-431a-972e-f08dc083a80f&page=queryresults
[0m12:51:40.483626 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 12:51:39.363361 => 12:51:40.482738
[0m12:51:40.485306 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.17s]
[0m12:51:40.487254 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:51:40.504315 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7424ddd6-50b5-4ff0-81b2-b88b9cdb2d96&page=queryresults
[0m12:51:40.505261 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 12:51:39.341388 => 12:51:40.505010
[0m12:51:40.506228 [info ] [Thread-2 (]: 2 of 2 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.18s]
[0m12:51:40.507239 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:51:40.509916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:51:40.510309 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m12:51:40.510692 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m12:51:40.511129 [info ] [MainThread]: 
[0m12:51:40.511879 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m12:51:40.513064 [debug] [MainThread]: Command end result
[0m12:51:40.520363 [info ] [MainThread]: 
[0m12:51:40.521194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:51:40.521947 [info ] [MainThread]: 
[0m12:51:40.522698 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:51:40.523746 [debug] [MainThread]: Command `dbt test` succeeded at 12:51:40.523610 after 2.69 seconds
[0m12:51:40.524189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aed2ceb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aea39c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aed18e1a0>]}
[0m12:51:40.524752 [debug] [MainThread]: Flushing usage events
[0m12:52:44.833750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2aad6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e29593d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e29593c10>]}


============================== 12:52:44.836649 | 4877a99f-fd56-4a59-bddd-1b017f4eae9f ==============================
[0m12:52:44.836649 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:52:44.837483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:52:45.196329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4877a99f-fd56-4a59-bddd-1b017f4eae9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e27a872e0>]}
[0m12:52:45.213570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4877a99f-fd56-4a59-bddd-1b017f4eae9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e27ab3160>]}
[0m12:52:45.214528 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:52:45.226065 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:52:45.251257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:52:45.251896 [debug] [MainThread]: Partial parsing: added file: coffee_shop://tests/other_test.sql
[0m12:52:45.294399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4877a99f-fd56-4a59-bddd-1b017f4eae9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e278c8f40>]}
[0m12:52:45.301615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4877a99f-fd56-4a59-bddd-1b017f4eae9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e27a0f970>]}
[0m12:52:45.302213 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:52:45.302803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4877a99f-fd56-4a59-bddd-1b017f4eae9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e27a0fa60>]}
[0m12:52:45.304469 [info ] [MainThread]: 
[0m12:52:45.305683 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:52:45.307279 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m12:52:45.307831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:46.374519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4877a99f-fd56-4a59-bddd-1b017f4eae9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e27a0faf0>]}
[0m12:52:46.375671 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:52:46.376852 [info ] [MainThread]: 
[0m12:52:46.384175 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:52:46.384845 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:52:46.387583 [info ] [Thread-2 (]: 2 of 2 START test unique_customers_customer_id ................................. [RUN]
[0m12:52:46.389112 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m12:52:46.389837 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:52:46.385859 [info ] [Thread-1 (]: 1 of 2 START test not_null_customers_customer_id ............................... [RUN]
[0m12:52:46.404269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m12:52:46.405282 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:52:46.417546 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:52:46.424264 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:52:46.425496 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 12:52:46.390306 => 12:52:46.425137
[0m12:52:46.426221 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:52:46.427010 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 12:52:46.405974 => 12:52:46.426701
[0m12:52:46.449489 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:52:46.450229 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:52:46.454203 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:52:46.455250 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:52:46.455948 [debug] [Thread-2 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:52:46.456625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:46.459443 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m12:52:47.542870 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2f26ab2e-d0ee-40f6-9cc9-fdff8995dfda&page=queryresults
[0m12:52:47.545219 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 12:52:46.427310 => 12:52:47.544910
[0m12:52:47.546323 [info ] [Thread-2 (]: 2 of 2 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.16s]
[0m12:52:47.547441 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:52:47.559222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6e5126e1-2ce2-44b9-9b43-3207978ba18f&page=queryresults
[0m12:52:47.560219 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 12:52:46.451304 => 12:52:47.559959
[0m12:52:47.561180 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.16s]
[0m12:52:47.562253 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:52:47.564977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:47.565355 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m12:52:47.565699 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m12:52:47.566087 [info ] [MainThread]: 
[0m12:52:47.566640 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m12:52:47.567722 [debug] [MainThread]: Command end result
[0m12:52:47.579544 [info ] [MainThread]: 
[0m12:52:47.580259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:52:47.580917 [info ] [MainThread]: 
[0m12:52:47.581994 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:52:47.582944 [debug] [MainThread]: Command `dbt test` succeeded at 12:52:47.582813 after 2.76 seconds
[0m12:52:47.583442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2aad6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2bf1fb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e277a0370>]}
[0m12:52:47.584182 [debug] [MainThread]: Flushing usage events
[0m12:54:16.407424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052e5fec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052d5d3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052d5d3ca0>]}


============================== 12:54:16.412522 | 38047645-3af7-4267-be0b-629d37f4f49d ==============================
[0m12:54:16.412522 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:54:16.413574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:54:16.795254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38047645-3af7-4267-be0b-629d37f4f49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052b7c1a80>]}
[0m12:54:16.812802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38047645-3af7-4267-be0b-629d37f4f49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052b7f7250>]}
[0m12:54:16.813770 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:54:16.825446 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:54:16.850584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:54:16.851318 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://tests/other_test.sql
[0m12:54:16.885055 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.coffee_shop.other_test' (tests/other_test.sql) depends on a node named 'example.customers' in package '' which was not found
[0m12:54:16.896126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38047645-3af7-4267-be0b-629d37f4f49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052b619510>]}
[0m12:54:16.903880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38047645-3af7-4267-be0b-629d37f4f49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052b5c21d0>]}
[0m12:54:16.904491 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:54:16.905095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38047645-3af7-4267-be0b-629d37f4f49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052b5c15a0>]}
[0m12:54:16.906758 [info ] [MainThread]: 
[0m12:54:16.907991 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:54:16.909563 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m12:54:16.910073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:17.910303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38047645-3af7-4267-be0b-629d37f4f49d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052b5bef50>]}
[0m12:54:17.911601 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:54:17.912370 [info ] [MainThread]: 
[0m12:54:17.918547 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:54:17.919575 [info ] [Thread-1 (]: 1 of 2 START test not_null_customers_customer_id ............................... [RUN]
[0m12:54:17.920543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m12:54:17.920997 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:54:17.919044 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:54:17.928849 [info ] [Thread-2 (]: 2 of 2 START test unique_customers_customer_id ................................. [RUN]
[0m12:54:17.930296 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m12:54:17.930928 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:54:17.946844 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:54:17.948483 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:54:17.949748 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 12:54:17.931558 => 12:54:17.949430
[0m12:54:17.950350 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:54:17.950964 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 12:54:17.921289 => 12:54:17.950680
[0m12:54:17.969713 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:54:17.969127 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:54:17.972400 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:54:17.973339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:17.973861 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m12:54:17.977122 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:54:17.977723 [debug] [Thread-2 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:54:19.134460 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9bbe8b16-3517-4480-8a48-195c91edcb98&page=queryresults
[0m12:54:19.141034 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 12:54:17.970093 => 12:54:19.139937
[0m12:54:19.142253 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.22s]
[0m12:54:19.143386 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:54:19.149558 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e4aeba9a-cfa1-4b14-894c-37225f518c38&page=queryresults
[0m12:54:19.150398 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 12:54:17.951227 => 12:54:19.150165
[0m12:54:19.151329 [info ] [Thread-2 (]: 2 of 2 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.22s]
[0m12:54:19.152278 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:54:19.154739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:19.155111 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m12:54:19.155501 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m12:54:19.155914 [info ] [MainThread]: 
[0m12:54:19.156492 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m12:54:19.157934 [debug] [MainThread]: Command end result
[0m12:54:19.164750 [info ] [MainThread]: 
[0m12:54:19.165390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:19.166062 [info ] [MainThread]: 
[0m12:54:19.166771 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:54:19.168268 [debug] [MainThread]: Command `dbt test` succeeded at 12:54:19.167948 after 2.77 seconds
[0m12:54:19.168810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052e5fec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052b4a4400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052b4a42b0>]}
[0m12:54:19.169296 [debug] [MainThread]: Flushing usage events
[0m12:55:06.850898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c180bebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c16bb7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c16bb7c70>]}


============================== 12:55:06.853797 | 336d4089-a4ed-4a29-bf87-5435c4827cd4 ==============================
[0m12:55:06.853797 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:55:06.854849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:55:07.246825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '336d4089-a4ed-4a29-bf87-5435c4827cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c150cb8e0>]}
[0m12:55:07.264442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '336d4089-a4ed-4a29-bf87-5435c4827cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c1509f820>]}
[0m12:55:07.265403 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:55:07.276955 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:55:07.302585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:55:07.303431 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://tests/other_test.sql
[0m12:55:07.353858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '336d4089-a4ed-4a29-bf87-5435c4827cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c14efd810>]}
[0m12:55:07.361758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '336d4089-a4ed-4a29-bf87-5435c4827cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c14ec0640>]}
[0m12:55:07.362354 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:55:07.362952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '336d4089-a4ed-4a29-bf87-5435c4827cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c14ec0610>]}
[0m12:55:07.364672 [info ] [MainThread]: 
[0m12:55:07.366085 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:55:07.367681 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m12:55:07.368218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:08.329447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '336d4089-a4ed-4a29-bf87-5435c4827cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c14ea39d0>]}
[0m12:55:08.330768 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:55:08.331850 [info ] [MainThread]: 
[0m12:55:08.338013 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:55:08.339473 [info ] [Thread-1 (]: 1 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m12:55:08.340380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m12:55:08.340811 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:55:08.338940 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:55:08.338504 [debug] [Thread-2 (]: Began running node test.coffee_shop.other_test
[0m12:55:08.356062 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:55:08.356643 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m12:55:08.358704 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m12:55:08.359316 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:55:08.367881 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:55:08.357151 [info ] [Thread-2 (]: 2 of 3 START test other_test ................................................... [RUN]
[0m12:55:08.369240 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.other_test'
[0m12:55:08.369798 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 12:55:08.341099 => 12:55:08.369522
[0m12:55:08.370239 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.other_test
[0m12:55:08.374334 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.other_test"
[0m12:55:08.371547 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 12:55:08.360134 => 12:55:08.371247
[0m12:55:08.370899 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:55:08.375134 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (compile): 12:55:08.371793 => 12:55:08.374864
[0m12:55:08.375593 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:55:08.401982 [debug] [Thread-2 (]: Began executing node test.coffee_shop.other_test
[0m12:55:08.402652 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:55:08.409863 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:55:08.413771 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.other_test"
[0m12:55:08.416015 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:55:08.417960 [debug] [Thread-2 (]: On test.coffee_shop.other_test: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.other_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      # tests/customer_test.yml

version: 2

models:
  - name: customers

tests:
  - unique_customer_ids:
      # Define the test logic using a custom SQL query
      query: >
        SELECT
            customer_id
        FROM
            `aec-students`.`dbt_marcel`.`customers`
        GROUP BY
            customer_id
        HAVING COUNT(*) > 1;
      
    ) dbt_internal_test
[0m12:55:08.417529 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:55:08.416801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:08.421216 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:55:08.422091 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m12:55:08.799606 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got ":" at [9:8]')
[0m12:55:09.673571 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f4966ab6-5635-4d90-8ec0-103bca07535b&page=queryresults
[0m12:55:09.675109 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (execute): 12:55:08.410449 => 12:55:09.674656
[0m12:55:09.679656 [debug] [Thread-2 (]: Database Error in test other_test (tests/other_test.sql)
  Syntax error: Expected keyword JOIN but got ":" at [9:8]
  compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m12:55:09.680449 [error] [Thread-2 (]: 2 of 3 ERROR other_test ........................................................ [[31mERROR[0m in 1.31s]
[0m12:55:09.681367 [debug] [Thread-2 (]: Finished running node test.coffee_shop.other_test
[0m12:55:09.733939 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1cfc6395-4d9b-42e8-98b5-7396d943ce2f&page=queryresults
[0m12:55:09.738241 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 12:55:08.403141 => 12:55:09.737873
[0m12:55:09.735737 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:87021d0a-7790-464e-b565-4c3a85cd4a59&page=queryresults
[0m12:55:09.741086 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 12:55:08.376568 => 12:55:09.740728
[0m12:55:09.739851 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.38s]
[0m12:55:09.742484 [info ] [Thread-1 (]: 1 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.40s]
[0m12:55:09.746279 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:55:09.747356 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:55:09.749930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:09.750292 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m12:55:09.750613 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m12:55:09.750921 [debug] [MainThread]: Connection 'test.coffee_shop.other_test' was properly closed.
[0m12:55:09.751543 [info ] [MainThread]: 
[0m12:55:09.752359 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m12:55:09.754140 [debug] [MainThread]: Command end result
[0m12:55:09.764353 [info ] [MainThread]: 
[0m12:55:09.765203 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:55:09.765870 [info ] [MainThread]: 
[0m12:55:09.766629 [error] [MainThread]: [33mDatabase Error in test other_test (tests/other_test.sql)[0m
[0m12:55:09.767452 [error] [MainThread]:   Syntax error: Expected keyword JOIN but got ":" at [9:8]
[0m12:55:09.768164 [error] [MainThread]:   compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m12:55:09.769034 [info ] [MainThread]: 
[0m12:55:09.769746 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m12:55:09.770944 [debug] [MainThread]: Command `dbt test` failed at 12:55:09.770806 after 2.93 seconds
[0m12:55:09.771495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c180bebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c14dbe800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c14dacc40>]}
[0m12:55:09.771983 [debug] [MainThread]: Flushing usage events
[0m12:56:13.426935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effccda6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effcb8b7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effcb8b7c10>]}


============================== 12:56:13.429817 | 758ea857-09f9-4db6-b162-f6ae5ccc3a0f ==============================
[0m12:56:13.429817 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:56:13.430876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:56:13.819611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '758ea857-09f9-4db6-b162-f6ae5ccc3a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc9daf100>]}
[0m12:56:13.837046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '758ea857-09f9-4db6-b162-f6ae5ccc3a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc9dda0b0>]}
[0m12:56:13.838000 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:56:13.849493 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:56:13.880001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:56:13.880812 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://tests/other_test.sql
[0m12:56:13.927051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '758ea857-09f9-4db6-b162-f6ae5ccc3a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc9bfd150>]}
[0m12:56:13.935268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '758ea857-09f9-4db6-b162-f6ae5ccc3a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc9ba1c90>]}
[0m12:56:13.935935 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:56:13.936563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '758ea857-09f9-4db6-b162-f6ae5ccc3a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc9ba32e0>]}
[0m12:56:13.938387 [info ] [MainThread]: 
[0m12:56:13.939640 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:56:13.941343 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m12:56:13.941939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:15.021033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '758ea857-09f9-4db6-b162-f6ae5ccc3a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc9ba0b50>]}
[0m12:56:15.022345 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:56:15.023132 [info ] [MainThread]: 
[0m12:56:15.029175 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:56:15.029747 [debug] [Thread-2 (]: Began running node test.coffee_shop.other_test
[0m12:56:15.031799 [info ] [Thread-2 (]: 2 of 3 START test other_test ................................................... [RUN]
[0m12:56:15.030203 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:56:15.033760 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m12:56:15.034897 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m12:56:15.030734 [info ] [Thread-1 (]: 1 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m12:56:15.033250 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.other_test'
[0m12:56:15.037238 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.other_test
[0m12:56:15.036681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m12:56:15.035390 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:56:15.041086 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:56:15.040586 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.other_test"
[0m12:56:15.051893 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:56:15.061452 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:56:15.062571 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (compile): 12:56:15.037549 => 12:56:15.062235
[0m12:56:15.063325 [debug] [Thread-2 (]: Began executing node test.coffee_shop.other_test
[0m12:56:15.080026 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 12:56:15.041461 => 12:56:15.079705
[0m12:56:15.080686 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 12:56:15.052372 => 12:56:15.080417
[0m12:56:15.083807 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.other_test"
[0m12:56:15.084267 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:56:15.084796 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:56:15.090099 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:56:15.090639 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:56:15.098040 [debug] [Thread-2 (]: On test.coffee_shop.other_test: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.other_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      version: 2

models:
  - name: customers

tests:
  - unique_customer_ids:
      # Define the test logic using a custom SQL query
      query: >
        SELECT
            customer_id
        FROM
            `aec-students`.`dbt_marcel`.`customers`
        GROUP BY
            customer_id
        HAVING COUNT(*) > 1;
      
    ) dbt_internal_test
[0m12:56:15.095794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:15.094881 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:56:15.104963 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:56:15.105707 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:56:15.102880 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m12:56:15.553803 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got ":" at [7:14]')
[0m12:56:16.341100 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3eb0e38a-2574-468a-9997-5200f0a8fdb9&page=queryresults
[0m12:56:16.343395 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 12:56:15.085498 => 12:56:16.342979
[0m12:56:16.344562 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.31s]
[0m12:56:16.345642 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:56:16.363965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:bbac1e42-b55b-4a8d-b59e-4891741a39fe&page=queryresults
[0m12:56:16.365055 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 12:56:15.087696 => 12:56:16.364779
[0m12:56:16.366027 [info ] [Thread-1 (]: 1 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.33s]
[0m12:56:16.367009 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:56:16.389966 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fc2d9dcd-5b96-4a34-be37-7877d5b07377&page=queryresults
[0m12:56:16.391230 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (execute): 12:56:15.063700 => 12:56:16.390879
[0m12:56:16.394960 [debug] [Thread-2 (]: Database Error in test other_test (tests/other_test.sql)
  Syntax error: Expected keyword JOIN but got ":" at [7:14]
  compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m12:56:16.395913 [error] [Thread-2 (]: 2 of 3 ERROR other_test ........................................................ [[31mERROR[0m in 1.36s]
[0m12:56:16.396874 [debug] [Thread-2 (]: Finished running node test.coffee_shop.other_test
[0m12:56:16.399712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:16.400088 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m12:56:16.400431 [debug] [MainThread]: Connection 'test.coffee_shop.other_test' was properly closed.
[0m12:56:16.400751 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m12:56:16.401130 [info ] [MainThread]: 
[0m12:56:16.401718 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m12:56:16.402830 [debug] [MainThread]: Command end result
[0m12:56:16.411045 [info ] [MainThread]: 
[0m12:56:16.411855 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:56:16.412502 [info ] [MainThread]: 
[0m12:56:16.413128 [error] [MainThread]: [33mDatabase Error in test other_test (tests/other_test.sql)[0m
[0m12:56:16.414326 [error] [MainThread]:   Syntax error: Expected keyword JOIN but got ":" at [7:14]
[0m12:56:16.414891 [error] [MainThread]:   compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m12:56:16.415905 [info ] [MainThread]: 
[0m12:56:16.416514 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m12:56:16.417551 [debug] [MainThread]: Command `dbt test` failed at 12:56:16.417365 after 3.00 seconds
[0m12:56:16.418191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effccda6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc9ba7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effc9abafe0>]}
[0m12:56:16.419176 [debug] [MainThread]: Flushing usage events
[0m12:56:42.734818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f59b2c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f44b7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f44b7ca0>]}


============================== 12:56:42.737805 | 0674ffbf-cd3e-4756-8fdd-b894af15cffd ==============================
[0m12:56:42.737805 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:56:42.738649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:56:43.163517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0674ffbf-cd3e-4756-8fdd-b894af15cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f29cbb50>]}
[0m12:56:43.185033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0674ffbf-cd3e-4756-8fdd-b894af15cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f299f6d0>]}
[0m12:56:43.186043 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:56:43.198411 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:56:43.224007 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m12:56:43.224598 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://tests/other_test.sql
[0m12:56:43.237593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0674ffbf-cd3e-4756-8fdd-b894af15cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f279d8a0>]}
[0m12:56:43.244847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0674ffbf-cd3e-4756-8fdd-b894af15cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f294d7e0>]}
[0m12:56:43.245421 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:56:43.246010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0674ffbf-cd3e-4756-8fdd-b894af15cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f294d7b0>]}
[0m12:56:43.247744 [info ] [MainThread]: 
[0m12:56:43.249036 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:56:43.250640 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m12:56:43.251172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:44.232369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0674ffbf-cd3e-4756-8fdd-b894af15cffd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f294d660>]}
[0m12:56:44.233721 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:56:44.235124 [info ] [MainThread]: 
[0m12:56:44.242343 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:56:44.243783 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:56:44.243085 [info ] [Thread-1 (]: 1 of 2 START test not_null_customers_customer_id ............................... [RUN]
[0m12:56:44.246303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m12:56:44.247268 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:56:44.244449 [info ] [Thread-2 (]: 2 of 2 START test unique_customers_customer_id ................................. [RUN]
[0m12:56:44.253815 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m12:56:44.254536 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:56:44.281146 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:56:44.282919 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 12:56:44.255007 => 12:56:44.282517
[0m12:56:44.283765 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:56:44.275966 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:56:44.307025 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:56:44.308057 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 12:56:44.247804 => 12:56:44.307626
[0m12:56:44.309263 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:56:44.309736 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:56:44.310842 [debug] [Thread-2 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:56:44.313800 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:56:44.316566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:44.317237 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m12:56:45.434914 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cf3185cc-a2d3-4c8b-a947-b5506333193c&page=queryresults
[0m12:56:45.438040 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 12:56:44.284301 => 12:56:45.437606
[0m12:56:45.440616 [info ] [Thread-2 (]: 2 of 2 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.19s]
[0m12:56:45.443623 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:56:45.657541 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:80c9f1f9-f928-4e47-bc5f-75d8f8a49d91&page=queryresults
[0m12:56:45.658761 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 12:56:44.311245 => 12:56:45.658459
[0m12:56:45.659803 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.41s]
[0m12:56:45.661030 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:56:45.663412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:45.664147 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m12:56:45.664524 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m12:56:45.664964 [info ] [MainThread]: 
[0m12:56:45.665548 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m12:56:45.667316 [debug] [MainThread]: Command end result
[0m12:56:45.674887 [info ] [MainThread]: 
[0m12:56:45.675655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:45.676317 [info ] [MainThread]: 
[0m12:56:45.678039 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:56:45.678997 [debug] [MainThread]: Command `dbt test` succeeded at 12:56:45.678869 after 2.95 seconds
[0m12:56:45.679516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f59b2c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f299f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f2937b20>]}
[0m12:56:45.680357 [debug] [MainThread]: Flushing usage events
[0m12:57:19.123484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff1e12b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff0897d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff0897c10>]}


============================== 12:57:19.126498 | c96ce8e2-1ba3-45a9-8256-18a9e49c7940 ==============================
[0m12:57:19.126498 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:57:19.127687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:57:19.492068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c96ce8e2-1ba3-45a9-8256-18a9e49c7940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feed82890>]}
[0m12:57:19.510239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c96ce8e2-1ba3-45a9-8256-18a9e49c7940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feedb5480>]}
[0m12:57:19.511713 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:57:19.525942 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:57:19.551206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:57:19.551909 [debug] [MainThread]: Partial parsing: added file: coffee_shop://tests/other_test.sql
[0m12:57:19.596392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c96ce8e2-1ba3-45a9-8256-18a9e49c7940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feebd55a0>]}
[0m12:57:19.603889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c96ce8e2-1ba3-45a9-8256-18a9e49c7940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feed13d90>]}
[0m12:57:19.604516 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m12:57:19.605288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c96ce8e2-1ba3-45a9-8256-18a9e49c7940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feed13e80>]}
[0m12:57:19.607280 [info ] [MainThread]: 
[0m12:57:19.608457 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:57:19.610111 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m12:57:19.610656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:20.569428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c96ce8e2-1ba3-45a9-8256-18a9e49c7940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feeb99630>]}
[0m12:57:20.571468 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:57:20.572513 [info ] [MainThread]: 
[0m12:57:20.578377 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:57:20.580774 [info ] [Thread-1 (]: 1 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m12:57:20.581733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m12:57:20.582206 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:57:20.580210 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:57:20.579002 [debug] [Thread-2 (]: Began running node test.coffee_shop.other_test
[0m12:57:20.599776 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m12:57:20.601987 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m12:57:20.602448 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:57:20.599251 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:57:20.600599 [info ] [Thread-2 (]: 2 of 3 START test other_test ................................................... [RUN]
[0m12:57:20.612525 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.other_test'
[0m12:57:20.613874 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.other_test
[0m12:57:20.613364 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 12:57:20.582514 => 12:57:20.613057
[0m12:57:20.617862 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:57:20.617292 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.other_test"
[0m12:57:20.611364 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:57:20.636947 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m12:57:20.638250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:57:20.638940 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m12:57:20.641247 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 12:57:20.603366 => 12:57:20.640983
[0m12:57:20.643647 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:57:20.643064 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (compile): 12:57:20.614275 => 12:57:20.642116
[0m12:57:20.649181 [debug] [Thread-2 (]: Began executing node test.coffee_shop.other_test
[0m12:57:20.647931 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m12:57:20.653962 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.other_test"
[0m12:57:20.656248 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:57:20.657794 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:57:20.657142 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:57:20.663209 [debug] [Thread-2 (]: On test.coffee_shop.other_test: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.other_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      version: 2

models:
  - name: customers

tests:
  - unique_customer_ids:
      # Define the test logic using a custom SQL query
      query: >
        SELECT
            customer_id
        FROM
            `aec-students`.`dbt_marcel`.`customers`
        GROUP BY
            customer_id
        HAVING COUNT(*) > 1;
      
    ) dbt_internal_test
[0m12:57:21.016742 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got ":" at [7:14]')
[0m12:57:21.435866 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2d7530a8-7d5f-4d35-a5c3-63099d33810a&page=queryresults
[0m12:57:21.437112 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (execute): 12:57:20.649661 => 12:57:21.436710
[0m12:57:21.440928 [debug] [Thread-2 (]: Database Error in test other_test (tests/other_test.sql)
  Syntax error: Expected keyword JOIN but got ":" at [7:14]
  compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m12:57:21.441602 [error] [Thread-2 (]: 2 of 3 ERROR other_test ........................................................ [[31mERROR[0m in 0.83s]
[0m12:57:21.442421 [debug] [Thread-2 (]: Finished running node test.coffee_shop.other_test
[0m12:57:21.780396 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8b36d61b-afe5-4402-bd05-bd34549d99d0&page=queryresults
[0m12:57:21.781644 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d51801c7-a1fa-415b-86ed-adf91ba8f214&page=queryresults
[0m12:57:21.783705 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 12:57:20.644287 => 12:57:21.783370
[0m12:57:21.784864 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 12:57:20.618216 => 12:57:21.784552
[0m12:57:21.786168 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.18s]
[0m12:57:21.789027 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m12:57:21.787674 [info ] [Thread-1 (]: 1 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.21s]
[0m12:57:21.790423 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m12:57:21.792609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:21.792987 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m12:57:21.793329 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m12:57:21.793663 [debug] [MainThread]: Connection 'test.coffee_shop.other_test' was properly closed.
[0m12:57:21.794112 [info ] [MainThread]: 
[0m12:57:21.794667 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m12:57:21.796628 [debug] [MainThread]: Command end result
[0m12:57:21.804806 [info ] [MainThread]: 
[0m12:57:21.805566 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:57:21.806240 [info ] [MainThread]: 
[0m12:57:21.807118 [error] [MainThread]: [33mDatabase Error in test other_test (tests/other_test.sql)[0m
[0m12:57:21.807857 [error] [MainThread]:   Syntax error: Expected keyword JOIN but got ":" at [7:14]
[0m12:57:21.808726 [error] [MainThread]:   compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m12:57:21.809390 [info ] [MainThread]: 
[0m12:57:21.810085 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m12:57:21.811380 [debug] [MainThread]: Command `dbt test` failed at 12:57:21.811213 after 2.70 seconds
[0m12:57:21.811909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ff1e12b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feea81630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0feed13910>]}
[0m12:57:21.812656 [debug] [MainThread]: Flushing usage events
[0m13:00:39.336864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5597f2c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5587d3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5587d3ca0>]}


============================== 13:00:39.339712 | 3500624f-9603-4083-b45d-5677d164706d ==============================
[0m13:00:39.339712 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:00:39.340523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:00:39.700339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3500624f-9603-4083-b45d-5677d164706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5569e7a60>]}
[0m13:00:39.717728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3500624f-9603-4083-b45d-5677d164706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5569bb5e0>]}
[0m13:00:39.718660 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:00:39.730027 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:00:39.755389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:00:39.755815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:00:39.761858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3500624f-9603-4083-b45d-5677d164706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5567ada50>]}
[0m13:00:39.769908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3500624f-9603-4083-b45d-5677d164706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5567717e0>]}
[0m13:00:39.770428 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:00:39.771000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3500624f-9603-4083-b45d-5677d164706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5567717b0>]}
[0m13:00:39.772717 [info ] [MainThread]: 
[0m13:00:39.773933 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:00:39.775507 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:00:39.776035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:40.868178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3500624f-9603-4083-b45d-5677d164706d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb556757eb0>]}
[0m13:00:40.869470 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:00:40.870508 [info ] [MainThread]: 
[0m13:00:40.876707 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:00:40.878173 [info ] [Thread-1 (]: 1 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m13:00:40.877185 [debug] [Thread-2 (]: Began running node test.coffee_shop.other_test
[0m13:00:40.879087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:00:40.877645 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:00:40.881261 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m13:00:40.880671 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:00:40.882408 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:00:40.897279 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:00:40.896731 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:00:40.905858 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:00:40.882922 => 13:00:40.905459
[0m13:00:40.906571 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:00:40.904428 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:00:40.879709 [info ] [Thread-2 (]: 2 of 3 START test other_test ................................................... [RUN]
[0m13:00:40.913161 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.other_test'
[0m13:00:40.928203 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.other_test
[0m13:00:40.927779 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:00:40.924187 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:00:40.897599 => 13:00:40.923873
[0m13:00:40.934469 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.other_test"
[0m13:00:40.935021 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:00:40.938477 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:00:40.939386 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (compile): 13:00:40.928507 => 13:00:40.939043
[0m13:00:40.941300 [debug] [Thread-2 (]: Began executing node test.coffee_shop.other_test
[0m13:00:40.935784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:40.947268 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:00:40.946557 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.other_test"
[0m13:00:40.947795 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:00:40.950441 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:00:40.951193 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:00:40.953649 [debug] [Thread-2 (]: On test.coffee_shop.other_test: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.other_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      version: 2

models:
  - name: customers

tests:
  - unique_customer_ids:
      # Define the test logic using a custom SQL query
      query: >
        SELECT
            customer_id
        FROM
            `aec-students`.`dbt_marcel`.`customers`
        GROUP BY
            customer_id
        HAVING COUNT(*) > 1;
      
    ) dbt_internal_test
[0m13:00:41.314344 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got ":" at [7:14]')
[0m13:00:42.196817 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9507eff8-2d65-4a19-84b7-45b90d89c8dd&page=queryresults
[0m13:00:42.198742 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:00:40.936236 => 13:00:42.198442
[0m13:00:42.199814 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.32s]
[0m13:00:42.200922 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:00:42.266566 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a9fc1290-4bee-4f63-9810-dce441da0f2a&page=queryresults
[0m13:00:42.267782 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:00:40.907044 => 13:00:42.267477
[0m13:00:42.268803 [info ] [Thread-1 (]: 1 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.39s]
[0m13:00:42.270369 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:00:42.394799 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:debf0373-87a1-418c-a802-eed397ef7bdc&page=queryresults
[0m13:00:42.400964 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (execute): 13:00:40.941793 => 13:00:42.399656
[0m13:00:42.406078 [debug] [Thread-2 (]: Database Error in test other_test (tests/other_test.sql)
  Syntax error: Expected keyword JOIN but got ":" at [7:14]
  compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:00:42.406790 [error] [Thread-2 (]: 2 of 3 ERROR other_test ........................................................ [[31mERROR[0m in 1.49s]
[0m13:00:42.408007 [debug] [Thread-2 (]: Finished running node test.coffee_shop.other_test
[0m13:00:42.410399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:42.410782 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:00:42.411174 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:00:42.411533 [debug] [MainThread]: Connection 'test.coffee_shop.other_test' was properly closed.
[0m13:00:42.411952 [info ] [MainThread]: 
[0m13:00:42.413064 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.64 seconds (2.64s).
[0m13:00:42.414347 [debug] [MainThread]: Command end result
[0m13:00:42.422274 [info ] [MainThread]: 
[0m13:00:42.422909 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:00:42.423538 [info ] [MainThread]: 
[0m13:00:42.424142 [error] [MainThread]: [33mDatabase Error in test other_test (tests/other_test.sql)[0m
[0m13:00:42.425095 [error] [MainThread]:   Syntax error: Expected keyword JOIN but got ":" at [7:14]
[0m13:00:42.425676 [error] [MainThread]:   compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:00:42.426707 [info ] [MainThread]: 
[0m13:00:42.427391 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:00:42.428624 [debug] [MainThread]: Command `dbt test` failed at 13:00:42.428246 after 3.10 seconds
[0m13:00:42.429178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5597f2c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5569bb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb556770ee0>]}
[0m13:00:42.429721 [debug] [MainThread]: Flushing usage events
[0m13:04:43.451290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f310f27ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f310dd93d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f310dd93c70>]}


============================== 13:04:43.454086 | 559c3d98-a0b6-4427-9325-1defcf702816 ==============================
[0m13:04:43.454086 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:04:43.454914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:04:43.865912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '559c3d98-a0b6-4427-9325-1defcf702816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f310ed751e0>]}
[0m13:04:43.883408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '559c3d98-a0b6-4427-9325-1defcf702816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f310c2b3370>]}
[0m13:04:43.884371 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:04:43.896251 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:04:43.921793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:04:43.922698 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m13:04:43.948333 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m13:04:44.016241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '559c3d98-a0b6-4427-9325-1defcf702816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f310c0c7c70>]}
[0m13:04:44.023745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '559c3d98-a0b6-4427-9325-1defcf702816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f310c229240>]}
[0m13:04:44.024381 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:04:44.024985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '559c3d98-a0b6-4427-9325-1defcf702816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f310c2291e0>]}
[0m13:04:44.026823 [info ] [MainThread]: 
[0m13:04:44.028012 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:04:44.029523 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:04:44.030012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:45.018057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '559c3d98-a0b6-4427-9325-1defcf702816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f310c229180>]}
[0m13:04:45.019360 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:04:45.020313 [info ] [MainThread]: 
[0m13:04:45.025742 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:04:45.026285 [debug] [Thread-2 (]: Began running node test.coffee_shop.other_test
[0m13:04:45.026733 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:04:45.027304 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:04:45.027737 [info ] [Thread-1 (]: 1 of 4 START test not_null_customers_customer_id ............................... [RUN]
[0m13:04:45.031023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:04:45.029201 [info ] [Thread-3 (]: 3 of 4 START test unique_customer_ids_customers_customer_id .................... [RUN]
[0m13:04:45.033599 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f'
[0m13:04:45.028320 [info ] [Thread-2 (]: 2 of 4 START test other_test ................................................... [RUN]
[0m13:04:45.035176 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.other_test'
[0m13:04:45.034222 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:04:45.029913 [info ] [Thread-4 (]: 4 of 4 START test unique_customers_customer_id ................................. [RUN]
[0m13:04:45.035673 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.other_test
[0m13:04:45.032491 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:04:45.040966 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:04:45.046914 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.other_test"
[0m13:04:45.047815 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f (compile): 13:04:45.036060 => 13:04:45.047577
[0m13:04:45.056841 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:04:45.057349 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:04:45.058870 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (compile): 13:04:45.041412 => 13:04:45.058599
[0m13:04:45.068742 [debug] [Thread-2 (]: Began executing node test.coffee_shop.other_test
[0m13:04:45.061213 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:04:45.048073 => 13:04:45.060876
[0m13:04:45.068230 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:04:45.060393 [debug] [Thread-3 (]: Compilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)
  'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:45.080755 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:04:45.089667 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.other_test"
[0m13:04:45.093577 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:04:45.090574 [error] [Thread-3 (]: 3 of 4 ERROR unique_customer_ids_customers_customer_id ......................... [[31mERROR[0m in 0.06s]
[0m13:04:45.094871 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:04:45.095703 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:04:45.096814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:45.097657 [debug] [Thread-2 (]: On test.coffee_shop.other_test: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.other_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      version: 2

models:
  - name: customers

tests:
  - unique_customer_ids:
      # Define the test logic using a custom SQL query
      query: >
        SELECT
            customer_id
        FROM
            `aec-students`.`dbt_marcel`.`customers`
        GROUP BY
            customer_id
        HAVING COUNT(*) > 1;
      
    ) dbt_internal_test
[0m13:04:45.098218 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:04:45.061553 => 13:04:45.097986
[0m13:04:45.098967 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:04:45.101542 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:04:45.106631 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:04:45.107538 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:04:45.108036 [debug] [Thread-4 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:04:45.501813 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got ":" at [7:14]')
[0m13:04:45.664653 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f4785df6-c8c9-4cba-b66d-05c908332f40&page=queryresults
[0m13:04:45.666088 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (execute): 13:04:45.069048 => 13:04:45.665777
[0m13:04:45.669357 [debug] [Thread-2 (]: Database Error in test other_test (tests/other_test.sql)
  Syntax error: Expected keyword JOIN but got ":" at [7:14]
  compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:04:45.670053 [error] [Thread-2 (]: 2 of 4 ERROR other_test ........................................................ [[31mERROR[0m in 0.64s]
[0m13:04:45.670966 [debug] [Thread-2 (]: Finished running node test.coffee_shop.other_test
[0m13:04:46.315310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:121f45bb-8f99-41c8-85c4-eef3f7f3ff05&page=queryresults
[0m13:04:46.317570 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:04:45.090996 => 13:04:46.317228
[0m13:04:46.318794 [info ] [Thread-1 (]: 1 of 4 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.29s]
[0m13:04:46.319925 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:04:46.330387 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:235e64dc-3a34-435b-80a2-19b19e3c5b13&page=queryresults
[0m13:04:46.331647 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:04:45.103709 => 13:04:46.331325
[0m13:04:46.332879 [info ] [Thread-4 (]: 4 of 4 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.29s]
[0m13:04:46.334214 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:04:46.340653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:46.341113 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:04:46.341527 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f' was properly closed.
[0m13:04:46.341891 [debug] [MainThread]: Connection 'test.coffee_shop.other_test' was properly closed.
[0m13:04:46.342266 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:04:46.342805 [info ] [MainThread]: 
[0m13:04:46.344204 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m13:04:46.345715 [debug] [MainThread]: Command end result
[0m13:04:46.361052 [info ] [MainThread]: 
[0m13:04:46.362093 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:04:46.362921 [info ] [MainThread]: 
[0m13:04:46.363770 [error] [MainThread]: [33mCompilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)[0m
[0m13:04:46.364843 [error] [MainThread]:   'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:46.365711 [info ] [MainThread]: 
[0m13:04:46.366530 [error] [MainThread]: [33mDatabase Error in test other_test (tests/other_test.sql)[0m
[0m13:04:46.367412 [error] [MainThread]:   Syntax error: Expected keyword JOIN but got ":" at [7:14]
[0m13:04:46.368201 [error] [MainThread]:   compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:04:46.369062 [info ] [MainThread]: 
[0m13:04:46.369966 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m13:04:46.371314 [debug] [MainThread]: Command `dbt test` failed at 13:04:46.371088 after 2.93 seconds
[0m13:04:46.372118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f310f27ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f310bc35ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f310bc36980>]}
[0m13:04:46.372915 [debug] [MainThread]: Flushing usage events
[0m13:05:09.192785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc514a22bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc513593d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc513593c70>]}


============================== 13:05:09.195812 | fddb5059-d1da-48e0-b455-bd95e81a5937 ==============================
[0m13:05:09.195812 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:05:09.196826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:05:09.549599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fddb5059-d1da-48e0-b455-bd95e81a5937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc511aa7a30>]}
[0m13:05:09.567021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fddb5059-d1da-48e0-b455-bd95e81a5937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc511a77670>]}
[0m13:05:09.567883 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:05:09.579830 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:05:09.609478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:05:09.609937 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:05:09.616142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fddb5059-d1da-48e0-b455-bd95e81a5937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc511869c30>]}
[0m13:05:09.623994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fddb5059-d1da-48e0-b455-bd95e81a5937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc511a298d0>]}
[0m13:05:09.624540 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:05:09.625116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fddb5059-d1da-48e0-b455-bd95e81a5937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc511a299c0>]}
[0m13:05:09.627783 [info ] [MainThread]: 
[0m13:05:09.628853 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:05:09.630455 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:05:09.630983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:10.701568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fddb5059-d1da-48e0-b455-bd95e81a5937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc511a13bb0>]}
[0m13:05:10.702834 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:05:10.703814 [info ] [MainThread]: 
[0m13:05:10.709785 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:05:10.710273 [debug] [Thread-2 (]: Began running node test.coffee_shop.other_test
[0m13:05:10.710700 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:05:10.711264 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:05:10.711719 [info ] [Thread-1 (]: 1 of 4 START test not_null_customers_customer_id ............................... [RUN]
[0m13:05:10.712546 [info ] [Thread-2 (]: 2 of 4 START test other_test ................................................... [RUN]
[0m13:05:10.715297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:05:10.717678 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:05:10.713116 [info ] [Thread-3 (]: 3 of 4 START test unique_customer_ids_customers_customer_id .................... [RUN]
[0m13:05:10.732081 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f'
[0m13:05:10.713960 [info ] [Thread-4 (]: 4 of 4 START test unique_customers_customer_id ................................. [RUN]
[0m13:05:10.731126 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:05:10.717156 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.other_test'
[0m13:05:10.732629 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:05:10.733485 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:05:10.734127 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.other_test
[0m13:05:10.743342 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.other_test"
[0m13:05:10.739891 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:05:10.739365 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f (compile): 13:05:10.734525 => 13:05:10.739048
[0m13:05:10.740372 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:05:10.717987 => 13:05:10.740150
[0m13:05:10.749306 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (compile): 13:05:10.740684 => 13:05:10.749044
[0m13:05:10.754925 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:05:10.754378 [debug] [Thread-3 (]: Compilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)
  'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:05:10.750812 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:05:10.755440 [debug] [Thread-2 (]: Began executing node test.coffee_shop.other_test
[0m13:05:10.758129 [error] [Thread-3 (]: 3 of 4 ERROR unique_customer_ids_customers_customer_id ......................... [[31mERROR[0m in 0.03s]
[0m13:05:10.772795 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:05:10.781526 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:05:10.743814 => 13:05:10.781121
[0m13:05:10.782240 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:05:10.820882 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.other_test"
[0m13:05:10.822057 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:05:10.825390 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:05:10.826167 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:05:10.827755 [debug] [Thread-2 (]: On test.coffee_shop.other_test: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.other_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      version: 2

models:
  - name: customers

tests:
  - unique_customer_ids:
      # Define the test logic using a custom SQL query
      query: >
        SELECT
            customer_id
        FROM
            `aec-students`.`dbt_marcel`.`customers`
        GROUP BY
            customer_id
        HAVING COUNT(*) > 1;
      
    ) dbt_internal_test
[0m13:05:10.827053 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:05:10.830855 [debug] [Thread-4 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:05:10.830203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:10.831677 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:05:11.238359 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got ":" at [7:14]')
[0m13:05:11.520322 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:295a94b5-433f-4f2e-9ab8-cb05acdc5bdb&page=queryresults
[0m13:05:11.522364 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (execute): 13:05:10.764249 => 13:05:11.521996
[0m13:05:11.526140 [debug] [Thread-2 (]: Database Error in test other_test (tests/other_test.sql)
  Syntax error: Expected keyword JOIN but got ":" at [7:14]
  compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:05:11.526821 [error] [Thread-2 (]: 2 of 4 ERROR other_test ........................................................ [[31mERROR[0m in 0.81s]
[0m13:05:11.527656 [debug] [Thread-2 (]: Finished running node test.coffee_shop.other_test
[0m13:05:12.048990 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:72c814e9-7e9e-4962-b2c0-55de23de35ab&page=queryresults
[0m13:05:12.051193 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:05:10.755796 => 13:05:12.050817
[0m13:05:12.052399 [info ] [Thread-1 (]: 1 of 4 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.34s]
[0m13:05:12.053653 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:05:12.254771 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c959d927-00bc-4e8e-84f6-2ea7d1c85ea7&page=queryresults
[0m13:05:12.256155 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:05:10.782720 => 13:05:12.255810
[0m13:05:12.257585 [info ] [Thread-4 (]: 4 of 4 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.52s]
[0m13:05:12.258850 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:05:12.261540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:12.261929 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:05:12.262302 [debug] [MainThread]: Connection 'test.coffee_shop.other_test' was properly closed.
[0m13:05:12.262665 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f' was properly closed.
[0m13:05:12.263030 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:05:12.263564 [info ] [MainThread]: 
[0m13:05:12.264196 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 2.64 seconds (2.64s).
[0m13:05:12.265359 [debug] [MainThread]: Command end result
[0m13:05:12.273456 [info ] [MainThread]: 
[0m13:05:12.274106 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:05:12.274723 [info ] [MainThread]: 
[0m13:05:12.275500 [error] [MainThread]: [33mCompilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)[0m
[0m13:05:12.276573 [error] [MainThread]:   'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:05:12.277309 [info ] [MainThread]: 
[0m13:05:12.278035 [error] [MainThread]: [33mDatabase Error in test other_test (tests/other_test.sql)[0m
[0m13:05:12.278798 [error] [MainThread]:   Syntax error: Expected keyword JOIN but got ":" at [7:14]
[0m13:05:12.279493 [error] [MainThread]:   compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:05:12.280105 [info ] [MainThread]: 
[0m13:05:12.280859 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m13:05:12.281995 [debug] [MainThread]: Command `dbt test` failed at 13:05:12.281814 after 3.10 seconds
[0m13:05:12.282705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc514a22bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc511a77670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc511923f70>]}
[0m13:05:12.283427 [debug] [MainThread]: Flushing usage events
[0m13:09:20.055063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb26f6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb11bfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb11bfc70>]}


============================== 13:09:20.057794 | f107757a-63e3-4681-9311-ee6bae1e9a9f ==============================
[0m13:09:20.057794 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:09:20.058619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:09:20.415695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f107757a-63e3-4681-9311-ee6bae1e9a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceaf6d3b80>]}
[0m13:09:20.433575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f107757a-63e3-4681-9311-ee6bae1e9a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceaf6a6f20>]}
[0m13:09:20.434442 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:09:20.445457 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:09:20.470702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:09:20.471104 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:09:20.477113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f107757a-63e3-4681-9311-ee6bae1e9a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceaf49ddb0>]}
[0m13:09:20.484684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f107757a-63e3-4681-9311-ee6bae1e9a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceaf45dab0>]}
[0m13:09:20.485190 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:09:20.485736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f107757a-63e3-4681-9311-ee6bae1e9a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceaf45da50>]}
[0m13:09:20.487802 [info ] [MainThread]: 
[0m13:09:20.489036 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:09:20.490485 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:09:20.491096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:21.545043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f107757a-63e3-4681-9311-ee6bae1e9a9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceaf643b20>]}
[0m13:09:21.546688 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:09:21.547577 [info ] [MainThread]: 
[0m13:09:21.554050 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:09:21.554551 [debug] [Thread-2 (]: Began running node test.coffee_shop.other_test
[0m13:09:21.555112 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:09:21.555597 [info ] [Thread-1 (]: 1 of 4 START test not_null_customers_customer_id ............................... [RUN]
[0m13:09:21.559424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:09:21.558074 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:09:21.557326 [info ] [Thread-3 (]: 3 of 4 START test unique_customer_ids_customers_customer_id .................... [RUN]
[0m13:09:21.560002 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:09:21.556467 [info ] [Thread-2 (]: 2 of 4 START test other_test ................................................... [RUN]
[0m13:09:21.562040 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f'
[0m13:09:21.560784 [info ] [Thread-4 (]: 4 of 4 START test unique_customers_customer_id ................................. [RUN]
[0m13:09:21.577761 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:09:21.578750 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.other_test'
[0m13:09:21.579305 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:09:21.580196 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:09:21.580994 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.other_test
[0m13:09:21.585796 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:09:21.562523 => 13:09:21.585504
[0m13:09:21.586203 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:09:21.589649 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.other_test"
[0m13:09:21.590472 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f (compile): 13:09:21.581472 => 13:09:21.590228
[0m13:09:21.591003 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:09:21.598388 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:09:21.600276 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (compile): 13:09:21.586733 => 13:09:21.600012
[0m13:09:21.619085 [debug] [Thread-2 (]: Began executing node test.coffee_shop.other_test
[0m13:09:21.634598 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:09:21.636213 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.other_test"
[0m13:09:21.637581 [debug] [Thread-3 (]: Compilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)
  'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:21.639682 [error] [Thread-3 (]: 3 of 4 ERROR unique_customer_ids_customers_customer_id ......................... [[31mERROR[0m in 0.08s]
[0m13:09:21.638890 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:09:21.591445 => 13:09:21.638648
[0m13:09:21.640509 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:09:21.638325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:21.641303 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:09:21.643827 [debug] [Thread-2 (]: On test.coffee_shop.other_test: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.other_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      version: 2

models:
  - name: customers

tests:
  - unique_customer_ids:
      # Define the test logic using a custom SQL query
      query: >
        SELECT
            customer_id
        FROM
            `aec-students`.`dbt_marcel`.`customers`
        GROUP BY
            customer_id
        HAVING COUNT(*) > 1;
      
    ) dbt_internal_test
[0m13:09:21.643227 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:09:21.642198 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:09:21.651043 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:09:21.653462 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:09:21.654528 [debug] [Thread-4 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:09:22.065496 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got ":" at [7:14]')
[0m13:09:22.859415 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a658e72d-2c13-4147-b7e4-1a13120fd28b&page=queryresults
[0m13:09:22.861079 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (execute): 13:09:21.619947 => 13:09:22.860534
[0m13:09:22.865125 [debug] [Thread-2 (]: Database Error in test other_test (tests/other_test.sql)
  Syntax error: Expected keyword JOIN but got ":" at [7:14]
  compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:09:22.865788 [error] [Thread-2 (]: 2 of 4 ERROR other_test ........................................................ [[31mERROR[0m in 1.29s]
[0m13:09:22.866664 [debug] [Thread-2 (]: Finished running node test.coffee_shop.other_test
[0m13:09:22.963884 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:268a545f-f940-4882-b37c-a0e59ca0ff38&page=queryresults
[0m13:09:22.965702 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:09:21.648371 => 13:09:22.965414
[0m13:09:22.966701 [info ] [Thread-4 (]: 4 of 4 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.39s]
[0m13:09:22.967812 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:09:23.032521 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a048ff98-3ccc-466f-9412-1b7b97b2f874&page=queryresults
[0m13:09:23.033816 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:09:21.600884 => 13:09:23.033470
[0m13:09:23.034953 [info ] [Thread-1 (]: 1 of 4 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.48s]
[0m13:09:23.036283 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:09:23.038963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:23.039382 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:09:23.039749 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f' was properly closed.
[0m13:09:23.040101 [debug] [MainThread]: Connection 'test.coffee_shop.other_test' was properly closed.
[0m13:09:23.040454 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:09:23.041098 [info ] [MainThread]: 
[0m13:09:23.041926 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 2.55 seconds (2.55s).
[0m13:09:23.043294 [debug] [MainThread]: Command end result
[0m13:09:23.051254 [info ] [MainThread]: 
[0m13:09:23.051901 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:09:23.052521 [info ] [MainThread]: 
[0m13:09:23.053153 [error] [MainThread]: [33mCompilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)[0m
[0m13:09:23.054202 [error] [MainThread]:   'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:23.054892 [info ] [MainThread]: 
[0m13:09:23.055924 [error] [MainThread]: [33mDatabase Error in test other_test (tests/other_test.sql)[0m
[0m13:09:23.056948 [error] [MainThread]:   Syntax error: Expected keyword JOIN but got ":" at [7:14]
[0m13:09:23.057942 [error] [MainThread]:   compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:09:23.058695 [info ] [MainThread]: 
[0m13:09:23.059359 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m13:09:23.060951 [debug] [MainThread]: Command `dbt test` failed at 13:09:23.060615 after 3.01 seconds
[0m13:09:23.061434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceb26f6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceaf6a6f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceaf54c160>]}
[0m13:09:23.062402 [debug] [MainThread]: Flushing usage events
[0m13:09:55.604610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b89f32bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b889bfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b889bfc70>]}


============================== 13:09:55.607488 | 4f801066-c8c2-47c6-82c1-8fa1fe63d747 ==============================
[0m13:09:55.607488 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:09:55.608309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:09:55.967178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f801066-c8c2-47c6-82c1-8fa1fe63d747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b86ed7b20>]}
[0m13:09:55.985422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f801066-c8c2-47c6-82c1-8fa1fe63d747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b86ea7790>]}
[0m13:09:55.986393 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:09:55.998611 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:09:56.044630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:09:56.045493 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:09:56.055869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f801066-c8c2-47c6-82c1-8fa1fe63d747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b86c9dd50>]}
[0m13:09:56.064399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f801066-c8c2-47c6-82c1-8fa1fe63d747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b86c5da50>]}
[0m13:09:56.064966 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:09:56.065558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f801066-c8c2-47c6-82c1-8fa1fe63d747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b86c5d9f0>]}
[0m13:09:56.067787 [info ] [MainThread]: 
[0m13:09:56.068836 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:09:56.070427 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:09:56.070978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:57.103943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f801066-c8c2-47c6-82c1-8fa1fe63d747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b86e3fd00>]}
[0m13:09:57.105133 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:09:57.106125 [info ] [MainThread]: 
[0m13:09:57.111916 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:09:57.113839 [info ] [Thread-1 (]: 1 of 4 START test not_null_customers_customer_id ............................... [RUN]
[0m13:09:57.112873 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:09:57.113346 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:09:57.116330 [info ] [Thread-4 (]: 4 of 4 START test unique_customers_customer_id ................................. [RUN]
[0m13:09:57.117538 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:09:57.115392 [info ] [Thread-3 (]: 3 of 4 START test unique_customer_ids_customers_customer_id .................... [RUN]
[0m13:09:57.119223 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f'
[0m13:09:57.112428 [debug] [Thread-2 (]: Began running node test.coffee_shop.other_test
[0m13:09:57.120243 [info ] [Thread-2 (]: 2 of 4 START test other_test ................................................... [RUN]
[0m13:09:57.121181 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.other_test'
[0m13:09:57.117986 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:09:57.114745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:09:57.134419 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:09:57.119734 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:09:57.133918 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:09:57.121606 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.other_test
[0m13:09:57.151438 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.other_test"
[0m13:09:57.143945 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:09:57.152573 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f (compile): 13:09:57.144405 => 13:09:57.152316
[0m13:09:57.153123 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:09:57.121972 => 13:09:57.152893
[0m13:09:57.153853 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (compile): 13:09:57.148611 => 13:09:57.153566
[0m13:09:57.155570 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:09:57.134732 => 13:09:57.155241
[0m13:09:57.155967 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:09:57.156550 [debug] [Thread-2 (]: Began executing node test.coffee_shop.other_test
[0m13:09:57.158157 [debug] [Thread-3 (]: Compilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)
  'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:57.158558 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:09:57.192195 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.other_test"
[0m13:09:57.196787 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:09:57.193195 [error] [Thread-3 (]: 3 of 4 ERROR unique_customer_ids_customers_customer_id ......................... [[31mERROR[0m in 0.07s]
[0m13:09:57.197749 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:09:57.198567 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:09:57.199348 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:09:57.200207 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:09:57.200880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:57.201328 [debug] [Thread-2 (]: On test.coffee_shop.other_test: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.other_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      version: 2

models:
  - name: customers

tests:
  - unique_customer_ids:
      # Define the test logic using a custom SQL query
      query: >
        SELECT
            customer_id
        FROM
            `aec-students`.`dbt_marcel`.`customers`
        GROUP BY
            customer_id
        HAVING COUNT(*) > 1;
      
    ) dbt_internal_test
[0m13:09:57.202139 [debug] [Thread-4 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:09:57.202687 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:09:57.572768 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got ":" at [7:14]')
[0m13:09:58.102866 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:59a14342-26fd-49e1-b202-2703decb7256&page=queryresults
[0m13:09:58.104960 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (execute): 13:09:57.161024 => 13:09:58.104261
[0m13:09:58.109939 [debug] [Thread-2 (]: Database Error in test other_test (tests/other_test.sql)
  Syntax error: Expected keyword JOIN but got ":" at [7:14]
  compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:09:58.110854 [error] [Thread-2 (]: 2 of 4 ERROR other_test ........................................................ [[31mERROR[0m in 0.99s]
[0m13:09:58.112181 [debug] [Thread-2 (]: Finished running node test.coffee_shop.other_test
[0m13:09:58.394193 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6c7cf4d0-4aea-44ca-9858-383ea96e3efd&page=queryresults
[0m13:09:58.395959 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:aa28f400-7d80-4586-bb36-92c17387e959&page=queryresults
[0m13:09:58.397971 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:09:57.193618 => 13:09:58.397685
[0m13:09:58.398984 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:09:57.158940 => 13:09:58.398724
[0m13:09:58.400123 [info ] [Thread-1 (]: 1 of 4 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.29s]
[0m13:09:58.403036 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:09:58.401622 [info ] [Thread-4 (]: 4 of 4 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.28s]
[0m13:09:58.404677 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:09:58.407090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:58.407565 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:09:58.407973 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:09:58.408313 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f' was properly closed.
[0m13:09:58.408646 [debug] [MainThread]: Connection 'test.coffee_shop.other_test' was properly closed.
[0m13:09:58.409037 [info ] [MainThread]: 
[0m13:09:58.409851 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m13:09:58.411636 [debug] [MainThread]: Command end result
[0m13:09:58.420804 [info ] [MainThread]: 
[0m13:09:58.421594 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:09:58.422517 [info ] [MainThread]: 
[0m13:09:58.423374 [error] [MainThread]: [33mCompilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)[0m
[0m13:09:58.424137 [error] [MainThread]:   'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:58.424977 [info ] [MainThread]: 
[0m13:09:58.425705 [error] [MainThread]: [33mDatabase Error in test other_test (tests/other_test.sql)[0m
[0m13:09:58.426428 [error] [MainThread]:   Syntax error: Expected keyword JOIN but got ":" at [7:14]
[0m13:09:58.427253 [error] [MainThread]:   compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:09:58.427986 [info ] [MainThread]: 
[0m13:09:58.428992 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m13:09:58.430193 [debug] [MainThread]: Command `dbt test` failed at 13:09:58.430004 after 2.83 seconds
[0m13:09:58.430963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b89f32bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b86b6d900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b86d418a0>]}
[0m13:09:58.431718 [debug] [MainThread]: Flushing usage events
[0m13:11:01.004816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc657c6b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc642c3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc642c3be0>]}


============================== 13:11:01.008376 | 0643bdd9-a068-4c22-9741-46201384bdd7 ==============================
[0m13:11:01.008376 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:11:01.009397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:11:01.430654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0643bdd9-a068-4c22-9741-46201384bdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc627bb0d0>]}
[0m13:11:01.448194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0643bdd9-a068-4c22-9741-46201384bdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc627e6050>]}
[0m13:11:01.449061 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:11:01.460385 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:11:01.485898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:11:01.486657 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m13:11:01.511793 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m13:11:01.569497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0643bdd9-a068-4c22-9741-46201384bdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc625d80d0>]}
[0m13:11:01.576882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0643bdd9-a068-4c22-9741-46201384bdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc62561240>]}
[0m13:11:01.577469 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:11:01.578174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0643bdd9-a068-4c22-9741-46201384bdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc62561210>]}
[0m13:11:01.580116 [info ] [MainThread]: 
[0m13:11:01.581431 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:11:01.582933 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:11:01.583477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:02.565113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0643bdd9-a068-4c22-9741-46201384bdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc625610c0>]}
[0m13:11:02.566344 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:11:02.567296 [info ] [MainThread]: 
[0m13:11:02.572936 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:11:02.573472 [debug] [Thread-2 (]: Began running node test.coffee_shop.other_test
[0m13:11:02.575428 [info ] [Thread-2 (]: 2 of 3 START test other_test ................................................... [RUN]
[0m13:11:02.576476 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.other_test'
[0m13:11:02.576911 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.other_test
[0m13:11:02.574827 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:11:02.581456 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.other_test"
[0m13:11:02.573987 [info ] [Thread-1 (]: 1 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m13:11:02.582011 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m13:11:02.584716 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:11:02.585724 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:11:02.585269 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (compile): 13:11:02.577253 => 13:11:02.585033
[0m13:11:02.583308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:11:02.597167 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:11:02.597927 [debug] [Thread-2 (]: Began executing node test.coffee_shop.other_test
[0m13:11:02.598509 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:11:02.624120 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:11:02.625026 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:11:02.586030 => 13:11:02.624722
[0m13:11:02.645175 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:11:02.600675 => 13:11:02.644707
[0m13:11:02.651682 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:11:02.650903 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:11:02.650226 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.other_test"
[0m13:11:02.657133 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:11:02.660699 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:11:02.662647 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:11:02.663427 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:11:02.667918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:02.669620 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:11:02.668945 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:11:02.672480 [debug] [Thread-2 (]: On test.coffee_shop.other_test: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.other_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      version: 2

models:
  - name: customers

tests:
  - unique_customer_ids:
      # Define the test logic using a custom SQL query
      query: >
        SELECT
            customer_id
        FROM
            `aec-students`.`dbt_marcel`.`customers`
        GROUP BY
            customer_id
        HAVING COUNT(*) > 1;
      
    ) dbt_internal_test
[0m13:11:03.093819 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got ":" at [7:14]')
[0m13:11:03.778792 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a2cea9f2-55fb-45b8-a060-5b68bfd10a50&page=queryresults
[0m13:11:03.780405 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (execute): 13:11:02.599114 => 13:11:03.779903
[0m13:11:03.784830 [debug] [Thread-2 (]: Database Error in test other_test (tests/other_test.sql)
  Syntax error: Expected keyword JOIN but got ":" at [7:14]
  compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:11:03.785561 [error] [Thread-2 (]: 2 of 3 ERROR other_test ........................................................ [[31mERROR[0m in 1.21s]
[0m13:11:03.786387 [debug] [Thread-2 (]: Finished running node test.coffee_shop.other_test
[0m13:11:03.913383 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:425a4c89-72a0-4d55-ac3b-1d03089fd132&page=queryresults
[0m13:11:03.915358 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:11:02.657636 => 13:11:03.915008
[0m13:11:03.916430 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.33s]
[0m13:11:03.917509 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:11:03.933082 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0e6fd0a6-051c-4fc7-bb72-e980a02c746c&page=queryresults
[0m13:11:03.934061 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:11:02.652201 => 13:11:03.933808
[0m13:11:03.935019 [info ] [Thread-1 (]: 1 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.35s]
[0m13:11:03.937260 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:11:03.940124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:03.940533 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:11:03.940927 [debug] [MainThread]: Connection 'test.coffee_shop.other_test' was properly closed.
[0m13:11:03.941308 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:11:03.941752 [info ] [MainThread]: 
[0m13:11:03.942487 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m13:11:03.944377 [debug] [MainThread]: Command end result
[0m13:11:03.952149 [info ] [MainThread]: 
[0m13:11:03.952858 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:11:03.953502 [info ] [MainThread]: 
[0m13:11:03.954174 [error] [MainThread]: [33mDatabase Error in test other_test (tests/other_test.sql)[0m
[0m13:11:03.955479 [error] [MainThread]:   Syntax error: Expected keyword JOIN but got ":" at [7:14]
[0m13:11:03.956185 [error] [MainThread]:   compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:11:03.957148 [info ] [MainThread]: 
[0m13:11:03.957904 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:11:03.959302 [debug] [MainThread]: Command `dbt test` failed at 13:11:03.959127 after 2.96 seconds
[0m13:11:03.959849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc657c6b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc625f0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc6209d7b0>]}
[0m13:11:03.960800 [debug] [MainThread]: Flushing usage events
[0m13:12:45.358182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b56fbab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b55ab7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b55ab7c10>]}


============================== 13:12:45.361225 | 72248579-5ddb-44c2-83e5-e26d5f90c039 ==============================
[0m13:12:45.361225 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:12:45.362110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:12:45.767416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72248579-5ddb-44c2-83e5-e26d5f90c039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b53fa6a40>]}
[0m13:12:45.785334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72248579-5ddb-44c2-83e5-e26d5f90c039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b53fdb3a0>]}
[0m13:12:45.786366 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:12:45.798723 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:12:45.830601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:45.831113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:45.837525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72248579-5ddb-44c2-83e5-e26d5f90c039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b53d95510>]}
[0m13:12:45.845624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72248579-5ddb-44c2-83e5-e26d5f90c039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b53f491b0>]}
[0m13:12:45.846183 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:12:45.846764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72248579-5ddb-44c2-83e5-e26d5f90c039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b53f492a0>]}
[0m13:12:45.848567 [info ] [MainThread]: 
[0m13:12:45.849740 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:12:45.851339 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:12:45.851884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:46.893154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72248579-5ddb-44c2-83e5-e26d5f90c039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b53f49180>]}
[0m13:12:46.894453 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:12:46.895419 [info ] [MainThread]: 
[0m13:12:46.900718 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:12:46.902190 [info ] [Thread-1 (]: 1 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m13:12:46.901690 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:12:46.901248 [debug] [Thread-2 (]: Began running node test.coffee_shop.other_test
[0m13:12:46.904663 [info ] [Thread-2 (]: 2 of 3 START test other_test ................................................... [RUN]
[0m13:12:46.903669 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m13:12:46.903028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:12:46.907345 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:12:46.906771 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:12:46.905755 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.other_test'
[0m13:12:46.921712 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:12:46.922291 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:12:46.922834 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.other_test
[0m13:12:46.930252 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:12:46.933582 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.other_test"
[0m13:12:46.934295 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:12:46.907799 => 13:12:46.934006
[0m13:12:46.935294 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (compile): 13:12:46.930821 => 13:12:46.934918
[0m13:12:46.935895 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:12:46.936508 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:12:46.923453 => 13:12:46.936254
[0m13:12:46.936892 [debug] [Thread-2 (]: Began executing node test.coffee_shop.other_test
[0m13:12:46.946130 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:12:46.962782 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.other_test"
[0m13:12:46.963723 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:12:46.966348 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:12:46.968201 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:12:46.968827 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:12:46.967282 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:12:46.972255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:46.972895 [debug] [Thread-2 (]: On test.coffee_shop.other_test: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.other_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      version: 2

models:
  - name: customers

tests:
  - unique_customer_ids:
      # Define the test logic using a custom SQL query
      query: >
        SELECT
            customer_id
        FROM
            `aec-students`.`dbt_marcel`.`customers`
        GROUP BY
            customer_id
        HAVING COUNT(*) > 1;
      
    ) dbt_internal_test
[0m13:12:46.973407 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:12:47.366498 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got ":" at [7:14]')
[0m13:12:47.808005 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a9de2298-5038-47d2-ab7d-68a998e7f663&page=queryresults
[0m13:12:47.809547 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (execute): 13:12:46.956936 => 13:12:47.809133
[0m13:12:47.815824 [debug] [Thread-2 (]: Database Error in test other_test (tests/other_test.sql)
  Syntax error: Expected keyword JOIN but got ":" at [7:14]
  compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:12:47.816644 [error] [Thread-2 (]: 2 of 3 ERROR other_test ........................................................ [[31mERROR[0m in 0.91s]
[0m13:12:47.817611 [debug] [Thread-2 (]: Finished running node test.coffee_shop.other_test
[0m13:12:48.171605 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8b465cc7-ce7e-4187-9e5d-8f5b8bd408bf&page=queryresults
[0m13:12:48.173812 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:12:46.964024 => 13:12:48.173516
[0m13:12:48.174861 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.27s]
[0m13:12:48.175894 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:12:48.214720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5cec1e3b-b11d-4edc-b506-34c712bca93a&page=queryresults
[0m13:12:48.216116 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:12:46.937214 => 13:12:48.215757
[0m13:12:48.217323 [info ] [Thread-1 (]: 1 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.31s]
[0m13:12:48.218594 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:12:48.221768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:48.222239 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:12:48.222663 [debug] [MainThread]: Connection 'test.coffee_shop.other_test' was properly closed.
[0m13:12:48.223072 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:12:48.223856 [info ] [MainThread]: 
[0m13:12:48.224618 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m13:12:48.225828 [debug] [MainThread]: Command end result
[0m13:12:48.233596 [info ] [MainThread]: 
[0m13:12:48.234243 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:12:48.234850 [info ] [MainThread]: 
[0m13:12:48.235918 [error] [MainThread]: [33mDatabase Error in test other_test (tests/other_test.sql)[0m
[0m13:12:48.236529 [error] [MainThread]:   Syntax error: Expected keyword JOIN but got ":" at [7:14]
[0m13:12:48.237098 [error] [MainThread]:   compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:12:48.238018 [info ] [MainThread]: 
[0m13:12:48.238675 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:12:48.239913 [debug] [MainThread]: Command `dbt test` failed at 13:12:48.239750 after 2.89 seconds
[0m13:12:48.240470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b56fbab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b53f485b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3b53f49060>]}
[0m13:12:48.240978 [debug] [MainThread]: Flushing usage events
[0m13:14:44.311184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c94beb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c7f93d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c7f93c10>]}


============================== 13:14:44.314032 | dd629df3-dfb7-4a02-93e5-2acea11a1826 ==============================
[0m13:14:44.314032 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:14:44.314873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:14:44.743824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd629df3-dfb7-4a02-93e5-2acea11a1826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c64a38e0>]}
[0m13:14:44.771660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd629df3-dfb7-4a02-93e5-2acea11a1826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c64778b0>]}
[0m13:14:44.772712 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:14:44.789811 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:14:44.816004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:14:44.816515 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:14:44.822922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd629df3-dfb7-4a02-93e5-2acea11a1826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c626d960>]}
[0m13:14:44.830876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd629df3-dfb7-4a02-93e5-2acea11a1826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c6429660>]}
[0m13:14:44.831496 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:14:44.832092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd629df3-dfb7-4a02-93e5-2acea11a1826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c6429600>]}
[0m13:14:44.833928 [info ] [MainThread]: 
[0m13:14:44.835271 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:14:44.836677 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:14:44.837444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:45.800669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd629df3-dfb7-4a02-93e5-2acea11a1826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c640fa00>]}
[0m13:14:45.801927 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:14:45.802983 [info ] [MainThread]: 
[0m13:14:45.808330 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:14:45.809882 [info ] [Thread-1 (]: 1 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m13:14:45.809289 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:14:45.808858 [debug] [Thread-2 (]: Began running node test.coffee_shop.other_test
[0m13:14:45.810964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:14:45.811502 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m13:14:45.814537 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:14:45.813445 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:14:45.812282 [info ] [Thread-2 (]: 2 of 3 START test other_test ................................................... [RUN]
[0m13:14:45.815011 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:14:45.830297 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:14:45.831233 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.other_test'
[0m13:14:45.838547 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:14:45.839408 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.other_test
[0m13:14:45.840314 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:14:45.815497 => 13:14:45.839951
[0m13:14:45.843530 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.other_test"
[0m13:14:45.844280 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:14:45.831640 => 13:14:45.843997
[0m13:14:45.844752 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:14:45.845718 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (compile): 13:14:45.840829 => 13:14:45.845456
[0m13:14:45.846108 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:14:45.868459 [debug] [Thread-2 (]: Began executing node test.coffee_shop.other_test
[0m13:14:45.872515 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:14:45.875610 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:14:45.878843 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.other_test"
[0m13:14:45.880106 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:14:45.881666 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:14:45.882213 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:14:45.885508 [debug] [Thread-2 (]: On test.coffee_shop.other_test: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.other_test"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      version: 2

models:
  - name: customers

tests:
  - unique_customer_ids:
      # Define the test logic using a custom SQL query
      query: >
        SELECT
            customer_id
        FROM
            `aec-students`.`dbt_marcel`.`customers`
        GROUP BY
            customer_id
        HAVING COUNT(*) > 1;
      
    ) dbt_internal_test
[0m13:14:45.883397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:45.889038 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:14:46.297903 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword JOIN but got ":" at [7:14]')
[0m13:14:47.098125 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:67f46d57-35a1-4def-b165-a07f0410b83b&page=queryresults
[0m13:14:47.101832 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:14:45.846431 => 13:14:47.101202
[0m13:14:47.103841 [info ] [Thread-1 (]: 1 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.29s]
[0m13:14:47.109584 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:14:47.113087 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6c8606a3-84d5-4897-80f0-92c5d1b4e6c9&page=queryresults
[0m13:14:47.113977 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test (execute): 13:14:45.876231 => 13:14:47.113727
[0m13:14:47.117605 [debug] [Thread-2 (]: Database Error in test other_test (tests/other_test.sql)
  Syntax error: Expected keyword JOIN but got ":" at [7:14]
  compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:14:47.118230 [error] [Thread-2 (]: 2 of 3 ERROR other_test ........................................................ [[31mERROR[0m in 1.29s]
[0m13:14:47.119030 [debug] [Thread-2 (]: Finished running node test.coffee_shop.other_test
[0m13:14:47.125282 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:08ae90db-46a3-4f96-9a1f-ac8fccc27a2d&page=queryresults
[0m13:14:47.126191 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:14:45.873037 => 13:14:47.125947
[0m13:14:47.127113 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.31s]
[0m13:14:47.128148 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:14:47.130664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:47.131050 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:14:47.131456 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:14:47.131821 [debug] [MainThread]: Connection 'test.coffee_shop.other_test' was properly closed.
[0m13:14:47.132243 [info ] [MainThread]: 
[0m13:14:47.132951 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m13:14:47.134166 [debug] [MainThread]: Command end result
[0m13:14:47.141474 [info ] [MainThread]: 
[0m13:14:47.142125 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:14:47.142713 [info ] [MainThread]: 
[0m13:14:47.143457 [error] [MainThread]: [33mDatabase Error in test other_test (tests/other_test.sql)[0m
[0m13:14:47.144223 [error] [MainThread]:   Syntax error: Expected keyword JOIN but got ":" at [7:14]
[0m13:14:47.144935 [error] [MainThread]:   compiled Code at target/run/coffee_shop/tests/other_test.sql
[0m13:14:47.145682 [info ] [MainThread]: 
[0m13:14:47.146377 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:14:47.147450 [debug] [MainThread]: Command `dbt test` failed at 13:14:47.147239 after 2.84 seconds
[0m13:14:47.148024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c94beb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c62f99c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94c6330c70>]}
[0m13:14:47.148577 [debug] [MainThread]: Flushing usage events
[0m13:15:36.794639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeffd62c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefe8c3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefe8c3ca0>]}


============================== 13:15:36.797699 | 617848de-3964-46e4-8e89-7515e8771665 ==============================
[0m13:15:36.797699 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:15:36.798574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:15:37.172910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '617848de-3964-46e4-8e89-7515e8771665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefcdd7c70>]}
[0m13:15:37.190946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '617848de-3964-46e4-8e89-7515e8771665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefcda9930>]}
[0m13:15:37.192104 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:15:37.203924 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:15:37.229066 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m13:15:37.229682 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://tests/other_test.sql
[0m13:15:37.241222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '617848de-3964-46e4-8e89-7515e8771665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefcba99c0>]}
[0m13:15:37.248414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '617848de-3964-46e4-8e89-7515e8771665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefcb61900>]}
[0m13:15:37.248986 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:15:37.249564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '617848de-3964-46e4-8e89-7515e8771665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefcb618d0>]}
[0m13:15:37.251385 [info ] [MainThread]: 
[0m13:15:37.252595 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:15:37.254172 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:15:37.254699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:38.280191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '617848de-3964-46e4-8e89-7515e8771665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefcb61780>]}
[0m13:15:38.281360 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:15:38.282156 [info ] [MainThread]: 
[0m13:15:38.288238 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:15:38.289279 [info ] [Thread-1 (]: 1 of 2 START test not_null_customers_customer_id ............................... [RUN]
[0m13:15:38.290292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:15:38.290757 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:15:38.288743 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:15:38.304928 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:15:38.305549 [info ] [Thread-2 (]: 2 of 2 START test unique_customers_customer_id ................................. [RUN]
[0m13:15:38.307375 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:15:38.308283 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:15:38.291076 => 13:15:38.307941
[0m13:15:38.308688 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:15:38.309205 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:15:38.316521 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:15:38.338927 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:15:38.339793 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:15:38.309625 => 13:15:38.339410
[0m13:15:38.340639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:38.341132 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:15:38.341700 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:15:38.344676 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:15:38.347726 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:15:38.348382 [debug] [Thread-2 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:15:39.442060 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:628f44db-c064-4e11-ae07-a4dd956ea073&page=queryresults
[0m13:15:39.444455 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:15:38.316878 => 13:15:39.444107
[0m13:15:39.445541 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.16s]
[0m13:15:39.446736 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:15:39.548463 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7a01b6c9-33fd-4169-a16f-0c14d9195134&page=queryresults
[0m13:15:39.550221 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:15:38.342135 => 13:15:39.549787
[0m13:15:39.552357 [info ] [Thread-2 (]: 2 of 2 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.25s]
[0m13:15:39.555800 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:15:39.559042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:39.559520 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:15:39.559865 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:15:39.560301 [info ] [MainThread]: 
[0m13:15:39.561099 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m13:15:39.562534 [debug] [MainThread]: Command end result
[0m13:15:39.574703 [info ] [MainThread]: 
[0m13:15:39.577483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:39.578786 [info ] [MainThread]: 
[0m13:15:39.580796 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:15:39.583335 [debug] [MainThread]: Command `dbt test` succeeded at 13:15:39.583103 after 2.80 seconds
[0m13:15:39.584719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeffd62c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdefcd43940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeffb54bb0>]}
[0m13:15:39.585344 [debug] [MainThread]: Flushing usage events
[0m13:16:22.688212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe1b30eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe19dbfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe19dbfc10>]}


============================== 13:16:22.691057 | 8c501c6d-8782-4d6c-aa99-c58c0aed3504 ==============================
[0m13:16:22.691057 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:16:22.691888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:16:23.053813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c501c6d-8782-4d6c-aa99-c58c0aed3504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe182d3970>]}
[0m13:16:23.071542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c501c6d-8782-4d6c-aa99-c58c0aed3504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe182a7580>]}
[0m13:16:23.072479 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:16:23.084026 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:16:23.109235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:23.110063 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m13:16:23.135539 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m13:16:23.203895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c501c6d-8782-4d6c-aa99-c58c0aed3504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe18121840>]}
[0m13:16:23.211113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c501c6d-8782-4d6c-aa99-c58c0aed3504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe181bd360>]}
[0m13:16:23.211746 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:16:23.212371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c501c6d-8782-4d6c-aa99-c58c0aed3504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe181bd330>]}
[0m13:16:23.214078 [info ] [MainThread]: 
[0m13:16:23.215257 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:16:23.216814 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:16:23.217340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:24.177708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c501c6d-8782-4d6c-aa99-c58c0aed3504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe181bd1e0>]}
[0m13:16:24.179021 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:16:24.179927 [info ] [MainThread]: 
[0m13:16:24.185223 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:16:24.185886 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:16:24.186901 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:16:24.187561 [info ] [Thread-2 (]: 2 of 3 START test unique_customer_ids_customers_customer_id .................... [RUN]
[0m13:16:24.189754 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f'
[0m13:16:24.190517 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:16:24.188428 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m13:16:24.186359 [info ] [Thread-1 (]: 1 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m13:16:24.198340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:16:24.197651 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f (compile): 13:16:24.190901 => 13:16:24.197404
[0m13:16:24.198814 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:16:24.196756 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:16:24.209534 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:16:24.209960 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:16:24.221197 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:16:24.221785 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:16:24.199931 => 13:16:24.221541
[0m13:16:24.223735 [debug] [Thread-2 (]: Compilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)
  'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:16:24.225294 [error] [Thread-2 (]: 2 of 3 ERROR unique_customer_ids_customers_customer_id ......................... [[31mERROR[0m in 0.04s]
[0m13:16:24.224638 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:16:24.226154 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:16:24.224243 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:16:24.210732 => 13:16:24.224018
[0m13:16:24.246078 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:16:24.245265 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:16:24.248905 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:16:24.249827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:24.250515 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:16:24.253217 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:16:24.254294 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:16:25.400659 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:dcef34b1-5146-420c-bd74-f6c05886404f&page=queryresults
[0m13:16:25.403090 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:16:24.226563 => 13:16:25.402709
[0m13:16:25.404439 [info ] [Thread-1 (]: 1 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.21s]
[0m13:16:25.405615 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:16:25.428816 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4514529e-ec35-45d2-a5b0-eb456f55e9e0&page=queryresults
[0m13:16:25.429800 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:16:24.246487 => 13:16:25.429537
[0m13:16:25.430765 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.23s]
[0m13:16:25.431868 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:16:25.434564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:25.434944 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:16:25.435342 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f' was properly closed.
[0m13:16:25.435709 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:16:25.436136 [info ] [MainThread]: 
[0m13:16:25.436891 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m13:16:25.438163 [debug] [MainThread]: Command end result
[0m13:16:25.446965 [info ] [MainThread]: 
[0m13:16:25.447770 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:16:25.448691 [info ] [MainThread]: 
[0m13:16:25.449514 [error] [MainThread]: [33mCompilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)[0m
[0m13:16:25.450184 [error] [MainThread]:   'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:16:25.451006 [info ] [MainThread]: 
[0m13:16:25.451716 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:16:25.452828 [debug] [MainThread]: Command `dbt test` failed at 13:16:25.452613 after 2.77 seconds
[0m13:16:25.453414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe1b30eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe1823f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe180b5c00>]}
[0m13:16:25.453987 [debug] [MainThread]: Flushing usage events
[0m13:17:45.920803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2aaf1ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a9bcfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a9bcfc70>]}


============================== 13:17:45.923783 | 821e00d2-3aba-43a2-bcc0-c0919247fa84 ==============================
[0m13:17:45.923783 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:17:45.924808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:17:46.283383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '821e00d2-3aba-43a2-bcc0-c0919247fa84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a80e7a90>]}
[0m13:17:46.300772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '821e00d2-3aba-43a2-bcc0-c0919247fa84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a80b76d0>]}
[0m13:17:46.301690 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:17:46.313249 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:17:46.338530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:17:46.339463 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m13:17:46.364878 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m13:17:46.433516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '821e00d2-3aba-43a2-bcc0-c0919247fa84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a7f35840>]}
[0m13:17:46.440779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '821e00d2-3aba-43a2-bcc0-c0919247fa84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a7e6d5d0>]}
[0m13:17:46.441335 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:17:46.441898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '821e00d2-3aba-43a2-bcc0-c0919247fa84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a7e6d660>]}
[0m13:17:46.443619 [info ] [MainThread]: 
[0m13:17:46.444863 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:17:46.446378 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:17:46.446875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:47.476938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '821e00d2-3aba-43a2-bcc0-c0919247fa84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a804fa90>]}
[0m13:17:47.478021 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:17:47.478731 [info ] [MainThread]: 
[0m13:17:47.483859 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:17:47.485296 [info ] [Thread-1 (]: 1 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m13:17:47.486294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:17:47.486737 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:17:47.484809 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:17:47.484368 [debug] [Thread-2 (]: Began running node test.coffee_shop.other_test_customers_customer_id.3857e78992
[0m13:17:47.497035 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:17:47.497637 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m13:17:47.498269 [info ] [Thread-2 (]: 2 of 3 START test other_test_customers_customer_id ............................. [RUN]
[0m13:17:47.500076 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:17:47.501674 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:17:47.501059 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.other_test_customers_customer_id.3857e78992'
[0m13:17:47.502290 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:17:47.487046 => 13:17:47.502040
[0m13:17:47.513643 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:17:47.513157 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:17:47.511426 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.other_test_customers_customer_id.3857e78992
[0m13:17:47.531678 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:17:47.536713 [debug] [Thread-2 (]: Timing info for test.coffee_shop.other_test_customers_customer_id.3857e78992 (compile): 13:17:47.532228 => 13:17:47.536462
[0m13:17:47.537321 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:17:47.502544 => 13:17:47.537029
[0m13:17:47.538828 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:17:47.541979 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:17:47.543458 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:17:47.543882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:47.544933 [debug] [Thread-2 (]: Compilation Error in test other_test_customers_customer_id (models/customers_test.yml)
  'test_other_test' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:17:47.546709 [error] [Thread-2 (]: 2 of 3 ERROR other_test_customers_customer_id .................................. [[31mERROR[0m in 0.05s]
[0m13:17:47.547574 [debug] [Thread-2 (]: Finished running node test.coffee_shop.other_test_customers_customer_id.3857e78992
[0m13:17:47.545380 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:17:47.546050 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:17:48.652186 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:aa516fb2-8052-4591-aa21-40c4b5a895b6&page=queryresults
[0m13:17:48.655027 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:17:47.513940 => 13:17:48.654488
[0m13:17:48.656409 [info ] [Thread-1 (]: 1 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.17s]
[0m13:17:48.658645 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:17:48.718494 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:80d20ef8-6bc3-4338-9b20-58ef2c8ab4a1&page=queryresults
[0m13:17:48.719729 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:17:47.539717 => 13:17:48.719423
[0m13:17:48.720848 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.22s]
[0m13:17:48.721931 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:17:48.724388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:48.724803 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:17:48.725153 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:17:48.725497 [debug] [MainThread]: Connection 'test.coffee_shop.other_test_customers_customer_id.3857e78992' was properly closed.
[0m13:17:48.725886 [info ] [MainThread]: 
[0m13:17:48.726464 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m13:17:48.729083 [debug] [MainThread]: Command end result
[0m13:17:48.736278 [info ] [MainThread]: 
[0m13:17:48.737029 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:17:48.737704 [info ] [MainThread]: 
[0m13:17:48.738576 [error] [MainThread]: [33mCompilation Error in test other_test_customers_customer_id (models/customers_test.yml)[0m
[0m13:17:48.739328 [error] [MainThread]:   'test_other_test' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:17:48.739933 [info ] [MainThread]: 
[0m13:17:48.740814 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:17:48.741786 [debug] [MainThread]: Command `dbt test` failed at 13:17:48.741651 after 2.83 seconds
[0m13:17:48.742254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2aaf1ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a80b76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a804f220>]}
[0m13:17:48.742846 [debug] [MainThread]: Flushing usage events
[0m13:18:21.845256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0049fab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0034c3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0034c3c10>]}


============================== 13:18:21.848398 | b465adb4-a817-4ff9-911c-2dd79aeb88a6 ==============================
[0m13:18:21.848398 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:18:21.849372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:18:22.276055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b465adb4-a817-4ff9-911c-2dd79aeb88a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0019d7af0>]}
[0m13:18:22.298441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b465adb4-a817-4ff9-911c-2dd79aeb88a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0019ab070>]}
[0m13:18:22.299647 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:18:22.311579 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:18:22.336857 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:18:22.337742 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m13:18:22.363677 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m13:18:22.433105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b465adb4-a817-4ff9-911c-2dd79aeb88a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc001829b70>]}
[0m13:18:22.440742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b465adb4-a817-4ff9-911c-2dd79aeb88a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc001761690>]}
[0m13:18:22.441415 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:18:22.442049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b465adb4-a817-4ff9-911c-2dd79aeb88a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc001761780>]}
[0m13:18:22.444173 [info ] [MainThread]: 
[0m13:18:22.445311 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:18:22.447008 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:18:22.447627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:23.432018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b465adb4-a817-4ff9-911c-2dd79aeb88a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc001943bb0>]}
[0m13:18:23.433112 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:18:23.433753 [info ] [MainThread]: 
[0m13:18:23.439876 [debug] [Thread-1 (]: Began running node test.coffee_shop.fart_customers_customer_id.5aa9b1cd16
[0m13:18:23.441420 [info ] [Thread-1 (]: 1 of 3 START test fart_customers_customer_id ................................... [RUN]
[0m13:18:23.442275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.fart_customers_customer_id.5aa9b1cd16)
[0m13:18:23.442727 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.fart_customers_customer_id.5aa9b1cd16
[0m13:18:23.440390 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:18:23.448434 [info ] [Thread-2 (]: 2 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m13:18:23.449569 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m13:18:23.450922 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:18:23.450479 [debug] [Thread-1 (]: Timing info for test.coffee_shop.fart_customers_customer_id.5aa9b1cd16 (compile): 13:18:23.443025 => 13:18:23.450234
[0m13:18:23.440899 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:18:23.465383 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:18:23.466154 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m13:18:23.467580 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:18:23.468110 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:18:23.475549 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:18:23.477266 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:18:23.451646 => 13:18:23.477005
[0m13:18:23.478313 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:18:23.484289 [debug] [Thread-1 (]: Compilation Error in test fart_customers_customer_id (models/customers_test.yml)
  'test_fart' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:18:23.490063 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:18:23.468416 => 13:18:23.489780
[0m13:18:23.499723 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:18:23.498418 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:18:23.498996 [error] [Thread-1 (]: 1 of 3 ERROR fart_customers_customer_id ........................................ [[31mERROR[0m in 0.06s]
[0m13:18:23.504288 [debug] [Thread-1 (]: Finished running node test.coffee_shop.fart_customers_customer_id.5aa9b1cd16
[0m13:18:23.503331 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:18:23.505413 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:18:23.505971 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:18:23.511715 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:18:23.512441 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:18:24.566861 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3ca8d4ab-4dc8-4c5d-8236-63f5d886d32c&page=queryresults
[0m13:18:24.569044 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:18:23.478866 => 13:18:24.568752
[0m13:18:24.570110 [info ] [Thread-2 (]: 2 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.12s]
[0m13:18:24.571261 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:18:24.576499 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ce6f9e21-02df-4463-95ac-946f151dbb73&page=queryresults
[0m13:18:24.577580 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:18:23.500378 => 13:18:24.577140
[0m13:18:24.578762 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.11s]
[0m13:18:24.579825 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:18:24.582370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:24.584016 [debug] [MainThread]: Connection 'test.coffee_shop.fart_customers_customer_id.5aa9b1cd16' was properly closed.
[0m13:18:24.585947 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:18:24.586356 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:18:24.586829 [info ] [MainThread]: 
[0m13:18:24.587625 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m13:18:24.589232 [debug] [MainThread]: Command end result
[0m13:18:24.596847 [info ] [MainThread]: 
[0m13:18:24.597524 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:18:24.598151 [info ] [MainThread]: 
[0m13:18:24.598869 [error] [MainThread]: [33mCompilation Error in test fart_customers_customer_id (models/customers_test.yml)[0m
[0m13:18:24.599621 [error] [MainThread]:   'test_fart' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:18:24.600221 [info ] [MainThread]: 
[0m13:18:24.600974 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:18:24.602002 [debug] [MainThread]: Command `dbt test` failed at 13:18:24.601864 after 2.76 seconds
[0m13:18:24.602485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0049fab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc001943d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc001943ca0>]}
[0m13:18:24.603103 [debug] [MainThread]: Flushing usage events
[0m13:20:40.930020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c064febf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c04f93d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c04f93c70>]}


============================== 13:20:40.932939 | f52a4d2d-c6e8-4ee5-b0f1-b6c2ed1267aa ==============================
[0m13:20:40.932939 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:20:40.933764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:20:41.297400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f52a4d2d-c6e8-4ee5-b0f1-b6c2ed1267aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c03477010>]}
[0m13:20:41.314872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f52a4d2d-c6e8-4ee5-b0f1-b6c2ed1267aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c034b13f0>]}
[0m13:20:41.315966 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:20:41.328154 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:20:41.357261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:41.358586 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m13:20:41.385346 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m13:20:41.454418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f52a4d2d-c6e8-4ee5-b0f1-b6c2ed1267aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c032f5600>]}
[0m13:20:41.461961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f52a4d2d-c6e8-4ee5-b0f1-b6c2ed1267aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c03429420>]}
[0m13:20:41.462622 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:20:41.463489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f52a4d2d-c6e8-4ee5-b0f1-b6c2ed1267aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c034293f0>]}
[0m13:20:41.465443 [info ] [MainThread]: 
[0m13:20:41.466563 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:20:41.468209 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:20:41.468743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:42.455332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f52a4d2d-c6e8-4ee5-b0f1-b6c2ed1267aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c034292a0>]}
[0m13:20:42.456453 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:20:42.457272 [info ] [MainThread]: 
[0m13:20:42.463137 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:20:42.463918 [info ] [Thread-1 (]: 1 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m13:20:42.465146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:20:42.465790 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:20:42.466805 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:20:42.473397 [info ] [Thread-2 (]: 2 of 3 START test unique_customer_ids_customers_customer_id .................... [RUN]
[0m13:20:42.474913 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f'
[0m13:20:42.467475 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:20:42.476716 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m13:20:42.478130 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:20:42.478778 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:20:42.475619 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:20:42.495292 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f (compile): 13:20:42.488413 => 13:20:42.494773
[0m13:20:42.518659 [debug] [Thread-2 (]: Compilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)
  'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:20:42.519654 [error] [Thread-2 (]: 2 of 3 ERROR unique_customer_ids_customers_customer_id ......................... [[31mERROR[0m in 0.05s]
[0m13:20:42.520642 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:20:42.506765 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:20:42.521953 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:20:42.467922 => 13:20:42.521597
[0m13:20:42.522595 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:20:42.515364 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:20:42.533026 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:20:42.479572 => 13:20:42.532650
[0m13:20:42.533655 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:20:42.580987 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:20:42.584978 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:20:42.586210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:42.586980 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:20:42.590312 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:20:42.590962 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:20:43.796471 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2bfb7221-da2a-433f-9ece-e791160dfabb&page=queryresults
[0m13:20:43.798402 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:20:42.523031 => 13:20:43.798108
[0m13:20:43.799473 [info ] [Thread-1 (]: 1 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.33s]
[0m13:20:43.800590 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:20:43.817376 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:042aea79-40f1-4493-82aa-dc944b6320d0&page=queryresults
[0m13:20:43.818410 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:20:42.534095 => 13:20:43.818150
[0m13:20:43.819438 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.34s]
[0m13:20:43.820527 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:20:43.823135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:43.823561 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:20:43.823941 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f' was properly closed.
[0m13:20:43.824307 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:20:43.824735 [info ] [MainThread]: 
[0m13:20:43.825328 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m13:20:43.827251 [debug] [MainThread]: Command end result
[0m13:20:43.834265 [info ] [MainThread]: 
[0m13:20:43.834910 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:20:43.835597 [info ] [MainThread]: 
[0m13:20:43.836230 [error] [MainThread]: [33mCompilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)[0m
[0m13:20:43.837197 [error] [MainThread]:   'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:20:43.837815 [info ] [MainThread]: 
[0m13:20:43.838830 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:20:43.839888 [debug] [MainThread]: Command `dbt test` failed at 13:20:43.839704 after 2.92 seconds
[0m13:20:43.840570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c064febf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c032c3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c03413970>]}
[0m13:20:43.841265 [debug] [MainThread]: Flushing usage events
[0m13:24:29.867009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d5e62c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d4bcfdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d4bcfca0>]}


============================== 13:24:29.873698 | ba50f6ed-2448-496e-a1a1-a311ebe5c600 ==============================
[0m13:24:29.873698 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:24:29.874749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:24:30.240518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba50f6ed-2448-496e-a1a1-a311ebe5c600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d30e3b50>]}
[0m13:24:30.269233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba50f6ed-2448-496e-a1a1-a311ebe5c600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d30b76d0>]}
[0m13:24:30.270499 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:24:30.286284 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:24:30.312111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:30.312693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:30.319248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba50f6ed-2448-496e-a1a1-a311ebe5c600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d2ea59c0>]}
[0m13:24:30.327377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba50f6ed-2448-496e-a1a1-a311ebe5c600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d2e6d660>]}
[0m13:24:30.327993 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:24:30.328789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba50f6ed-2448-496e-a1a1-a311ebe5c600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d2e6d750>]}
[0m13:24:30.330849 [info ] [MainThread]: 
[0m13:24:30.331975 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:24:30.334691 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:24:30.335383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:31.319695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba50f6ed-2448-496e-a1a1-a311ebe5c600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d304fbb0>]}
[0m13:24:31.320991 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:24:31.321893 [info ] [MainThread]: 
[0m13:24:31.327543 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:24:31.328571 [info ] [Thread-1 (]: 1 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m13:24:31.329492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:24:31.329934 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:24:31.328070 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:24:31.344966 [info ] [Thread-2 (]: 2 of 3 START test unique_customer_ids_customers_customer_id .................... [RUN]
[0m13:24:31.346003 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f'
[0m13:24:31.346436 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:24:31.336094 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:24:31.344459 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:24:31.351396 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m13:24:31.352479 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f (compile): 13:24:31.346766 => 13:24:31.352246
[0m13:24:31.353779 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:24:31.354578 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:24:31.330227 => 13:24:31.354314
[0m13:24:31.355814 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:24:31.356477 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:24:31.363906 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:24:31.386809 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:24:31.387366 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:24:31.357085 => 13:24:31.387112
[0m13:24:31.389767 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:24:31.389243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:31.388612 [debug] [Thread-2 (]: Compilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)
  'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:24:31.394323 [error] [Thread-2 (]: 2 of 3 ERROR unique_customer_ids_customers_customer_id ......................... [[31mERROR[0m in 0.05s]
[0m13:24:31.393714 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:24:31.393160 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:24:31.395326 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f
[0m13:24:31.399110 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:24:31.399618 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:24:32.539662 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cb1a9285-2a2a-48af-9917-e5ea06045065&page=queryresults
[0m13:24:32.542298 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:24:31.390130 => 13:24:32.541919
[0m13:24:32.543728 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.19s]
[0m13:24:32.545571 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:24:32.558131 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:96983371-54e7-406d-91e2-8b9e67b3ee00&page=queryresults
[0m13:24:32.559055 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:24:31.364462 => 13:24:32.558804
[0m13:24:32.559988 [info ] [Thread-1 (]: 1 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.23s]
[0m13:24:32.560974 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:24:32.563740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:32.564117 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:24:32.564487 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customer_ids_customers_customer_id.966213361f' was properly closed.
[0m13:24:32.564840 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:24:32.565247 [info ] [MainThread]: 
[0m13:24:32.565920 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m13:24:32.567179 [debug] [MainThread]: Command end result
[0m13:24:32.574324 [info ] [MainThread]: 
[0m13:24:32.575061 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:24:32.575778 [info ] [MainThread]: 
[0m13:24:32.576528 [error] [MainThread]: [33mCompilation Error in test unique_customer_ids_customers_customer_id (models/customers_test.yml)[0m
[0m13:24:32.577428 [error] [MainThread]:   'test_unique_customer_ids' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:24:32.578286 [info ] [MainThread]: 
[0m13:24:32.579046 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:24:32.580224 [debug] [MainThread]: Command `dbt test` failed at 13:24:32.580086 after 2.73 seconds
[0m13:24:32.580713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d5e62c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d30b76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d2f21150>]}
[0m13:24:32.581410 [debug] [MainThread]: Flushing usage events
[0m13:27:17.991015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b670f6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b65bbfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b65bbfc10>]}


============================== 13:27:17.994141 | ff44bbf2-2241-4164-85b7-b1ba06afd4ea ==============================
[0m13:27:17.994141 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:27:17.994983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:27:18.353060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff44bbf2-2241-4164-85b7-b1ba06afd4ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b640ae770>]}
[0m13:27:18.370360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff44bbf2-2241-4164-85b7-b1ba06afd4ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b640e15a0>]}
[0m13:27:18.371275 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:27:18.383775 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:27:18.409225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:27:18.409985 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m13:27:18.435133 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m13:27:18.494022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff44bbf2-2241-4164-85b7-b1ba06afd4ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b63ecc0d0>]}
[0m13:27:18.501166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff44bbf2-2241-4164-85b7-b1ba06afd4ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b63e5d270>]}
[0m13:27:18.501736 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:27:18.502311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff44bbf2-2241-4164-85b7-b1ba06afd4ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b63e5d240>]}
[0m13:27:18.503977 [info ] [MainThread]: 
[0m13:27:18.505372 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:27:18.506967 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:27:18.507484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:19.498828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff44bbf2-2241-4164-85b7-b1ba06afd4ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b6403ffd0>]}
[0m13:27:19.500073 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:27:19.500788 [info ] [MainThread]: 
[0m13:27:19.506599 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:27:19.507641 [info ] [Thread-1 (]: 1 of 2 START test not_null_customers_customer_id ............................... [RUN]
[0m13:27:19.508547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:27:19.508986 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:27:19.507072 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:27:19.522876 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:27:19.523458 [info ] [Thread-2 (]: 2 of 2 START test unique_customers_customer_id ................................. [RUN]
[0m13:27:19.526191 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:27:19.526852 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:27:19.509273 => 13:27:19.526577
[0m13:27:19.527271 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:27:19.527757 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:27:19.536251 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:27:19.558686 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:27:19.559772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:19.560856 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:27:19.560302 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:27:19.528116 => 13:27:19.560059
[0m13:27:19.563313 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:27:19.566471 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:27:19.567433 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:27:19.567922 [debug] [Thread-2 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:27:20.749750 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f2eafa6c-1d25-4ad2-a5eb-b27a789b8e53&page=queryresults
[0m13:27:20.752100 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:27:19.536733 => 13:27:20.751736
[0m13:27:20.753539 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.25s]
[0m13:27:20.754831 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:27:20.781875 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5a7d4f8d-3994-40d3-8720-99cf1c1bfb3f&page=queryresults
[0m13:27:20.782802 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:27:19.563805 => 13:27:20.782554
[0m13:27:20.783747 [info ] [Thread-2 (]: 2 of 2 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.26s]
[0m13:27:20.784725 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:27:20.787306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:20.787675 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:27:20.788015 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:27:20.788393 [info ] [MainThread]: 
[0m13:27:20.788966 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m13:27:20.790063 [debug] [MainThread]: Command end result
[0m13:27:20.797744 [info ] [MainThread]: 
[0m13:27:20.798401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:20.798997 [info ] [MainThread]: 
[0m13:27:20.800003 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:27:20.800917 [debug] [MainThread]: Command `dbt test` succeeded at 13:27:20.800787 after 2.82 seconds
[0m13:27:20.801366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b670f6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b66fb61a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b639c5660>]}
[0m13:27:20.801867 [debug] [MainThread]: Flushing usage events
[0m13:28:00.903009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdaf3b2b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdae3d3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdae3d3be0>]}


============================== 13:28:00.905888 | d691c0d2-98be-44a8-b702-cc2689d84220 ==============================
[0m13:28:00.905888 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:28:00.906908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:28:01.261157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd691c0d2-98be-44a8-b702-cc2689d84220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdac5c1b10>]}
[0m13:28:01.278606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd691c0d2-98be-44a8-b702-cc2689d84220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdac5f5570>]}
[0m13:28:01.279436 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:28:01.290456 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:28:01.315225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:01.315671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:01.323499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd691c0d2-98be-44a8-b702-cc2689d84220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdac3a5270>]}
[0m13:28:01.337497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd691c0d2-98be-44a8-b702-cc2689d84220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdac4ccf70>]}
[0m13:28:01.338439 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:28:01.339868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd691c0d2-98be-44a8-b702-cc2689d84220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdac4ccf10>]}
[0m13:28:01.342292 [info ] [MainThread]: 
[0m13:28:01.344246 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:28:01.346638 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:28:01.347521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:02.403448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd691c0d2-98be-44a8-b702-cc2689d84220', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdac357c10>]}
[0m13:28:02.404529 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:28:02.405160 [info ] [MainThread]: 
[0m13:28:02.412019 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:28:02.412614 [info ] [Thread-1 (]: 1 of 2 START test not_null_customers_customer_id ............................... [RUN]
[0m13:28:02.413515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:28:02.413983 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:28:02.420482 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:28:02.426182 [info ] [Thread-2 (]: 2 of 2 START test unique_customers_customer_id ................................. [RUN]
[0m13:28:02.427233 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:28:02.431279 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:28:02.438268 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:28:02.430737 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:28:02.439280 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:28:02.431647 => 13:28:02.438955
[0m13:28:02.439898 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:28:02.445880 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:28:02.414283 => 13:28:02.445636
[0m13:28:02.456641 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:28:02.461633 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:28:02.459063 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:28:02.462752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:02.463408 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:28:02.463999 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:28:02.466294 [debug] [Thread-2 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:28:03.645778 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b6d58dcd-6d01-4492-bfd2-b7f53d6b3255&page=queryresults
[0m13:28:03.648347 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:28:02.440285 => 13:28:03.648001
[0m13:28:03.649621 [info ] [Thread-2 (]: 2 of 2 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.22s]
[0m13:28:03.650786 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:28:03.800496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f83b611a-c6f2-490c-9658-423e17f7353c&page=queryresults
[0m13:28:03.801747 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:28:02.459491 => 13:28:03.801451
[0m13:28:03.802824 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.39s]
[0m13:28:03.803986 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:28:03.806926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:03.807369 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:28:03.807755 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:28:03.808238 [info ] [MainThread]: 
[0m13:28:03.808829 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m13:28:03.810050 [debug] [MainThread]: Command end result
[0m13:28:03.819802 [info ] [MainThread]: 
[0m13:28:03.820868 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:03.821955 [info ] [MainThread]: 
[0m13:28:03.823204 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:28:03.824629 [debug] [MainThread]: Command `dbt test` succeeded at 13:28:03.824478 after 2.93 seconds
[0m13:28:03.825211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdaf3b2b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdac6e04f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdac444040>]}
[0m13:28:03.825780 [debug] [MainThread]: Flushing usage events
[0m13:30:54.606699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fb5dabc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fa0c3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fa0c3c40>]}


============================== 13:30:54.609669 | 65421f42-f306-49eb-a8ef-edd1a8c77932 ==============================
[0m13:30:54.609669 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:30:54.610700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:30:54.992933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65421f42-f306-49eb-a8ef-edd1a8c77932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f85bb5e0>]}
[0m13:30:55.010992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65421f42-f306-49eb-a8ef-edd1a8c77932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f85e7340>]}
[0m13:30:55.012061 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:30:55.024463 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:30:55.049466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:30:55.049916 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:30:55.056166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65421f42-f306-49eb-a8ef-edd1a8c77932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f83950c0>]}
[0m13:30:55.063854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65421f42-f306-49eb-a8ef-edd1a8c77932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f84bcdc0>]}
[0m13:30:55.064381 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:30:55.065157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65421f42-f306-49eb-a8ef-edd1a8c77932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f84bcd60>]}
[0m13:30:55.066866 [info ] [MainThread]: 
[0m13:30:55.068030 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:30:55.069626 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:30:55.070063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:56.219559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m13:30:56.220388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:56.408741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65421f42-f306-49eb-a8ef-edd1a8c77932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f85e6c20>]}
[0m13:30:56.409888 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:30:56.410868 [info ] [MainThread]: 
[0m13:30:56.416236 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m13:30:56.416927 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customers .............................. [RUN]
[0m13:30:56.417808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m13:30:56.418242 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m13:30:56.421539 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m13:30:56.422393 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 13:30:56.418529 => 13:30:56.422048
[0m13:30:56.422873 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m13:30:56.438461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:56.706178 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m13:30:56.707096 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m13:31:05.179245 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e0194e6f-c22f-4c71-88b9-8288370416e9&page=queryresults
[0m13:31:05.197677 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 13:30:56.423179 => 13:31:05.197441
[0m13:31:05.198667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65421f42-f306-49eb-a8ef-edd1a8c77932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f8394520>]}
[0m13:31:05.199491 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.78s]
[0m13:31:05.200541 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m13:31:05.201662 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m13:31:05.202742 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_orders .......................... [RUN]
[0m13:31:05.203775 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m13:31:05.204226 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m13:31:05.207729 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m13:31:05.208552 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 13:31:05.204521 => 13:31:05.208247
[0m13:31:05.209404 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m13:31:05.237090 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_orders"
[0m13:31:05.238008 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:31:05.238573 [debug] [Thread-3 (]: On model.coffee_shop.monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customers`
group by 1;


[0m13:31:05.836261 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4213d7d1-b24b-4db4-96cd-bd5faafdd0da&page=queryresults
[0m13:31:05.839430 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 13:31:05.209765 => 13:31:05.839194
[0m13:31:05.840416 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65421f42-f306-49eb-a8ef-edd1a8c77932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f4250fd0>]}
[0m13:31:05.841179 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 0.64s]
[0m13:31:05.842154 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m13:31:05.844851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:05.845369 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m13:31:05.845851 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m13:31:05.846390 [info ] [MainThread]: 
[0m13:31:05.847117 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.78 seconds (10.78s).
[0m13:31:05.848815 [debug] [MainThread]: Command end result
[0m13:31:05.859673 [info ] [MainThread]: 
[0m13:31:05.860627 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:31:05.861468 [info ] [MainThread]: 
[0m13:31:05.862260 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:31:05.863487 [debug] [MainThread]: Command `dbt run` succeeded at 13:31:05.863330 after 11.26 seconds
[0m13:31:05.864175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78fb5dabc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f84463b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f4253520>]}
[0m13:31:05.864704 [debug] [MainThread]: Flushing usage events
[0m13:31:43.226559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ae312bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88acdbfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88acdbfc40>]}


============================== 13:31:43.229478 | 97e4c2a5-0eeb-4f17-86b7-e6887cea0e8a ==============================
[0m13:31:43.229478 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:31:43.230336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:31:43.588021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97e4c2a5-0eeb-4f17-86b7-e6887cea0e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ab2aaf20>]}
[0m13:31:43.605952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97e4c2a5-0eeb-4f17-86b7-e6887cea0e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ab2e0070>]}
[0m13:31:43.606882 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:31:43.618174 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:31:43.642845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:31:43.643285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:31:43.649337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97e4c2a5-0eeb-4f17-86b7-e6887cea0e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ab091450>]}
[0m13:31:43.656960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97e4c2a5-0eeb-4f17-86b7-e6887cea0e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ab1b50f0>]}
[0m13:31:43.657493 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:31:43.658193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97e4c2a5-0eeb-4f17-86b7-e6887cea0e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ab1b51e0>]}
[0m13:31:43.660098 [info ] [MainThread]: 
[0m13:31:43.661162 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:31:43.662723 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:31:43.663290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:44.661110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97e4c2a5-0eeb-4f17-86b7-e6887cea0e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ab23fdf0>]}
[0m13:31:44.662417 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:31:44.663444 [info ] [MainThread]: 
[0m13:31:44.669171 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:31:44.670253 [info ] [Thread-1 (]: 1 of 2 START test not_null_customers_customer_id ............................... [RUN]
[0m13:31:44.671214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m13:31:44.671676 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:31:44.669755 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:31:44.685578 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:31:44.686119 [info ] [Thread-2 (]: 2 of 2 START test unique_customers_customer_id ................................. [RUN]
[0m13:31:44.687625 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m13:31:44.688224 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:31:44.695909 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:31:44.696531 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 13:31:44.672003 => 13:31:44.696289
[0m13:31:44.697836 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:31:44.697348 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 13:31:44.688708 => 13:31:44.697017
[0m13:31:44.716485 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m13:31:44.716953 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:31:44.720011 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m13:31:44.720668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:44.721376 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m13:31:44.723601 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:31:44.724425 [debug] [Thread-2 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:31:45.968836 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d904c124-4281-4b6d-8deb-7c26f321411b&page=queryresults
[0m13:31:45.970730 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 13:31:44.698139 => 13:31:45.970438
[0m13:31:45.971753 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.30s]
[0m13:31:45.972907 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m13:31:46.386325 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d27cc204-69a7-4854-a911-a45c765fa432&page=queryresults
[0m13:31:46.387598 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 13:31:44.717699 => 13:31:46.387279
[0m13:31:46.388713 [info ] [Thread-2 (]: 2 of 2 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.70s]
[0m13:31:46.389785 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m13:31:46.392266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:46.392653 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m13:31:46.392993 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m13:31:46.393374 [info ] [MainThread]: 
[0m13:31:46.394876 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.73 seconds (2.73s).
[0m13:31:46.396537 [debug] [MainThread]: Command end result
[0m13:31:46.403552 [info ] [MainThread]: 
[0m13:31:46.404268 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:31:46.405051 [info ] [MainThread]: 
[0m13:31:46.405862 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:31:46.406987 [debug] [MainThread]: Command `dbt test` succeeded at 13:31:46.406844 after 3.19 seconds
[0m13:31:46.407483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ae312bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ae1263b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88ab12a020>]}
[0m13:31:46.408158 [debug] [MainThread]: Flushing usage events
[0m15:35:24.136658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d95662c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d941bfdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d941bfca0>]}


============================== 15:35:24.140304 | 6e4058ee-f3cb-4703-a0b9-98dbd2e270fe ==============================
[0m15:35:24.140304 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:35:24.141390 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:35:25.700100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e4058ee-f3cb-4703-a0b9-98dbd2e270fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d926b74f0>]}
[0m15:35:25.718386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e4058ee-f3cb-4703-a0b9-98dbd2e270fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d926e3040>]}
[0m15:35:25.719504 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:35:25.731380 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:35:25.812868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:35:25.813551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:35:25.820888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e4058ee-f3cb-4703-a0b9-98dbd2e270fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d92490fd0>]}
[0m15:35:25.830965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e4058ee-f3cb-4703-a0b9-98dbd2e270fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d925b8cd0>]}
[0m15:35:25.831580 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:35:25.832181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e4058ee-f3cb-4703-a0b9-98dbd2e270fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d925b8c70>]}
[0m15:35:25.833904 [info ] [MainThread]: 
[0m15:35:25.835424 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:35:25.837199 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:35:25.837740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:30.501458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m15:35:30.502267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:30.696335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e4058ee-f3cb-4703-a0b9-98dbd2e270fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d926e0100>]}
[0m15:35:30.697400 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:35:30.698145 [info ] [MainThread]: 
[0m15:35:30.712931 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:35:30.713642 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customers .............................. [RUN]
[0m15:35:30.714716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m15:35:30.715322 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:35:30.720386 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:35:30.721437 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 15:35:30.715622 => 15:35:30.721169
[0m15:35:30.721931 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:35:30.741591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:31.051438 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m15:35:31.052518 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m15:35:38.088695 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:03107861-2d49-4b3e-beeb-983960461995&page=queryresults
[0m15:35:38.108346 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 15:35:30.722297 => 15:35:38.108074
[0m15:35:38.109265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e4058ee-f3cb-4703-a0b9-98dbd2e270fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d92490340>]}
[0m15:35:38.110006 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 7.39s]
[0m15:35:38.111203 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:35:38.112625 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m15:35:38.113352 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_orders .......................... [RUN]
[0m15:35:38.114501 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m15:35:38.114958 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m15:35:38.118485 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m15:35:38.119317 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 15:35:38.115256 => 15:35:38.119022
[0m15:35:38.119762 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m15:35:38.144442 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_orders"
[0m15:35:38.145261 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:35:38.145770 [debug] [Thread-3 (]: On model.coffee_shop.monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customers`
group by 1;


[0m15:35:38.847094 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:81eaf019-e79f-4d04-961b-5f4a3c858f6d&page=queryresults
[0m15:35:38.850586 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 15:35:38.120063 => 15:35:38.850317
[0m15:35:38.851775 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e4058ee-f3cb-4703-a0b9-98dbd2e270fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d90352fe0>]}
[0m15:35:38.852752 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 0.74s]
[0m15:35:38.854029 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m15:35:38.856900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:38.857309 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m15:35:38.857670 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m15:35:38.858098 [info ] [MainThread]: 
[0m15:35:38.858684 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 13.02 seconds (13.02s).
[0m15:35:38.860441 [debug] [MainThread]: Command end result
[0m15:35:38.868974 [info ] [MainThread]: 
[0m15:35:38.869819 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:35:38.870535 [info ] [MainThread]: 
[0m15:35:38.871558 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:35:38.872657 [debug] [MainThread]: Command `dbt run` succeeded at 15:35:38.872517 after 14.76 seconds
[0m15:35:38.873093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d95662c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d926e3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d90353fa0>]}
[0m15:35:38.873718 [debug] [MainThread]: Flushing usage events
[0m15:37:29.498093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9515c6b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9500b7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9500b7be0>]}


============================== 15:37:29.500898 | be099fc6-fa45-4516-9a37-46f549dfd33a ==============================
[0m15:37:29.500898 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:37:29.502034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:37:29.898278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be099fc6-fa45-4516-9a37-46f549dfd33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e5cf8e0>]}
[0m15:37:29.915688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be099fc6-fa45-4516-9a37-46f549dfd33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e59f8b0>]}
[0m15:37:29.916455 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:37:29.927623 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:37:29.953183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:29.953624 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:29.959630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be099fc6-fa45-4516-9a37-46f549dfd33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e389540>]}
[0m15:37:29.968748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be099fc6-fa45-4516-9a37-46f549dfd33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e54d240>]}
[0m15:37:29.969536 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:37:29.970306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be099fc6-fa45-4516-9a37-46f549dfd33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e54d1e0>]}
[0m15:37:29.972496 [info ] [MainThread]: 
[0m15:37:29.973822 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:37:29.975662 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m15:37:29.976301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:30.962351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be099fc6-fa45-4516-9a37-46f549dfd33a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e537fd0>]}
[0m15:37:30.963639 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:37:30.964707 [info ] [MainThread]: 
[0m15:37:30.970551 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:37:30.971203 [info ] [Thread-1 (]: 1 of 2 START test not_null_customers_customer_id ............................... [RUN]
[0m15:37:30.972245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m15:37:30.972706 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:37:30.982528 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:37:30.983184 [info ] [Thread-2 (]: 2 of 2 START test unique_customers_customer_id ................................. [RUN]
[0m15:37:30.984995 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m15:37:30.991304 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m15:37:30.991864 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:37:30.999371 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m15:37:31.000366 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 15:37:30.992389 => 15:37:31.000076
[0m15:37:31.000888 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:37:31.001439 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 15:37:30.973002 => 15:37:31.001161
[0m15:37:31.020451 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m15:37:31.021058 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:37:31.022064 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:37:31.024764 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m15:37:31.026188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:37:31.026803 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:37:31.025341 [debug] [Thread-2 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:37:32.318423 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:bace11df-f67d-428d-b0f3-21475f0e1ef4&page=queryresults
[0m15:37:32.320337 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 15:37:31.022371 => 15:37:32.320049
[0m15:37:32.321518 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.35s]
[0m15:37:32.323060 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:37:32.625597 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ca6b6933-0fff-41ee-a4ba-a80d40d67f2a&page=queryresults
[0m15:37:32.626811 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 15:37:31.001776 => 15:37:32.626516
[0m15:37:32.627902 [info ] [Thread-2 (]: 2 of 2 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.64s]
[0m15:37:32.628973 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:37:32.631889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:32.632287 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m15:37:32.632657 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m15:37:32.633102 [info ] [MainThread]: 
[0m15:37:32.633955 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m15:37:32.635589 [debug] [MainThread]: Command end result
[0m15:37:32.642609 [info ] [MainThread]: 
[0m15:37:32.643787 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:37:32.644472 [info ] [MainThread]: 
[0m15:37:32.645653 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:37:32.646896 [debug] [MainThread]: Command `dbt test` succeeded at 15:37:32.646702 after 3.16 seconds
[0m15:37:32.647634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9515c6b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e433e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94e6b80a0>]}
[0m15:37:32.648178 [debug] [MainThread]: Flushing usage events
[0m15:39:17.107444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4882386b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4880eb7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4880eb7c10>]}


============================== 15:39:17.110389 | 527f3895-6aa4-47e3-9457-e7b0cedae2bf ==============================
[0m15:39:17.110389 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:39:17.111208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:39:17.532950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '527f3895-6aa4-47e3-9457-e7b0cedae2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487f3cf850>]}
[0m15:39:17.550708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '527f3895-6aa4-47e3-9457-e7b0cedae2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487f39f850>]}
[0m15:39:17.551699 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:39:17.563360 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:39:17.588682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:39:17.589407 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:39:17.595831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '527f3895-6aa4-47e3-9457-e7b0cedae2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487f1894b0>]}
[0m15:39:17.603932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '527f3895-6aa4-47e3-9457-e7b0cedae2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487f34d1b0>]}
[0m15:39:17.604527 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:39:17.605126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '527f3895-6aa4-47e3-9457-e7b0cedae2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487f34d150>]}
[0m15:39:17.606833 [info ] [MainThread]: 
[0m15:39:17.608145 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:39:17.609714 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:39:17.610349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:19.390436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m15:39:19.391361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:19.618211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '527f3895-6aa4-47e3-9457-e7b0cedae2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487f3377f0>]}
[0m15:39:19.619256 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:39:19.619914 [info ] [MainThread]: 
[0m15:39:19.625548 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:39:19.626212 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customers .............................. [RUN]
[0m15:39:19.627093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m15:39:19.627560 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:39:19.632020 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:39:19.633377 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 15:39:19.627861 => 15:39:19.633079
[0m15:39:19.633911 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:39:19.649516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:19.911201 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m15:39:19.912935 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m15:39:26.910175 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cdf18586-d9f8-4ff1-a8db-d879b4dacdce&page=queryresults
[0m15:39:26.929635 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 15:39:19.634277 => 15:39:26.929398
[0m15:39:26.930637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527f3895-6aa4-47e3-9457-e7b0cedae2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487f213f10>]}
[0m15:39:26.931465 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 7.30s]
[0m15:39:26.932507 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:39:26.933680 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m15:39:26.934476 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_orders .......................... [RUN]
[0m15:39:26.935586 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m15:39:26.936038 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m15:39:26.939326 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m15:39:26.940214 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 15:39:26.936335 => 15:39:26.939874
[0m15:39:26.940834 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m15:39:26.967309 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_orders"
[0m15:39:26.968302 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:39:26.968861 [debug] [Thread-3 (]: On model.coffee_shop.monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customers`
group by 1;


[0m15:39:27.636018 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:88774a4d-f258-40a8-a95d-4ec5b3c396ae&page=queryresults
[0m15:39:27.639133 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 15:39:26.941141 => 15:39:27.638893
[0m15:39:27.640200 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527f3895-6aa4-47e3-9457-e7b0cedae2bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487f249e40>]}
[0m15:39:27.641053 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 0.70s]
[0m15:39:27.642227 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m15:39:27.645521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:27.645898 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m15:39:27.646259 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m15:39:27.646677 [info ] [MainThread]: 
[0m15:39:27.647269 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.04 seconds (10.04s).
[0m15:39:27.648641 [debug] [MainThread]: Command end result
[0m15:39:27.660392 [info ] [MainThread]: 
[0m15:39:27.661455 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:27.662267 [info ] [MainThread]: 
[0m15:39:27.663067 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:39:27.664294 [debug] [MainThread]: Command `dbt run` succeeded at 15:39:27.664101 after 10.56 seconds
[0m15:39:27.665479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4882386b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487f238cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f487f2496f0>]}
[0m15:39:27.666268 [debug] [MainThread]: Flushing usage events
[0m15:40:04.118561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2028326bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026fcfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2026fcfc40>]}


============================== 15:40:04.121527 | 094cf50d-c716-41e6-afcd-cb0effe21ea6 ==============================
[0m15:40:04.121527 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:40:04.122375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:40:04.502808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '094cf50d-c716-41e6-afcd-cb0effe21ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20254b6e60>]}
[0m15:40:04.520358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '094cf50d-c716-41e6-afcd-cb0effe21ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20254f1420>]}
[0m15:40:04.521444 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:40:04.533613 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:40:04.558613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:40:04.559156 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:40:04.565715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '094cf50d-c716-41e6-afcd-cb0effe21ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20252a13c0>]}
[0m15:40:04.573860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '094cf50d-c716-41e6-afcd-cb0effe21ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20253c9060>]}
[0m15:40:04.574491 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:40:04.575348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '094cf50d-c716-41e6-afcd-cb0effe21ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20253c9150>]}
[0m15:40:04.577399 [info ] [MainThread]: 
[0m15:40:04.578593 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:40:04.580247 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m15:40:04.580787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:05.567609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '094cf50d-c716-41e6-afcd-cb0effe21ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202544fdf0>]}
[0m15:40:05.568925 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:40:05.569768 [info ] [MainThread]: 
[0m15:40:05.576930 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:40:05.577488 [info ] [Thread-1 (]: 1 of 2 START test not_null_customers_customer_id ............................... [RUN]
[0m15:40:05.578436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.not_null_customers_customer_id.5c9bf9911d)
[0m15:40:05.578891 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:40:05.586558 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:40:05.594136 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m15:40:05.594608 [info ] [Thread-2 (]: 2 of 2 START test unique_customers_customer_id ................................. [RUN]
[0m15:40:05.596313 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m15:40:05.597235 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:40:05.598055 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 15:40:05.579188 => 15:40:05.597716
[0m15:40:05.605331 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m15:40:05.606939 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 15:40:05.598327 => 15:40:05.606589
[0m15:40:05.607417 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:40:05.605969 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:40:05.626465 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m15:40:05.629618 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m15:40:05.630700 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:40:05.631474 [debug] [Thread-2 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:40:05.633993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:05.634912 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:40:06.946396 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8894e17e-f5ad-4974-95a2-d1fa00c18c8d&page=queryresults
[0m15:40:06.949763 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 15:40:05.626894 => 15:40:06.949304
[0m15:40:06.951455 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.37s]
[0m15:40:06.954987 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:40:07.350716 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c2b28a77-98da-4b8b-bc2c-aa33ea72cf81&page=queryresults
[0m15:40:07.352041 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 15:40:05.607742 => 15:40:07.351720
[0m15:40:07.353115 [info ] [Thread-2 (]: 2 of 2 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.76s]
[0m15:40:07.354314 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:40:07.357002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:07.357419 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m15:40:07.357759 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m15:40:07.358147 [info ] [MainThread]: 
[0m15:40:07.359137 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m15:40:07.360776 [debug] [MainThread]: Command end result
[0m15:40:07.368039 [info ] [MainThread]: 
[0m15:40:07.368876 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:07.369734 [info ] [MainThread]: 
[0m15:40:07.371582 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:40:07.374055 [debug] [MainThread]: Command `dbt test` succeeded at 15:40:07.373904 after 3.26 seconds
[0m15:40:07.374638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2028326bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20283323b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202517bca0>]}
[0m15:40:07.375599 [debug] [MainThread]: Flushing usage events
[0m15:41:27.885869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02247abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0211cfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0211cfc40>]}


============================== 15:41:27.889099 | bd4a64f2-2724-49fa-abe9-18b88d149915 ==============================
[0m15:41:27.889099 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:41:27.889987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:41:28.303591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd4a64f2-2724-49fa-abe9-18b88d149915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa01f6b5c30>]}
[0m15:41:28.340543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd4a64f2-2724-49fa-abe9-18b88d149915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa01f6f1450>]}
[0m15:41:28.342186 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:41:28.367066 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:41:28.395736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:41:28.396629 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m15:41:28.422575 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m15:41:28.494605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd4a64f2-2724-49fa-abe9-18b88d149915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa01f531ae0>]}
[0m15:41:28.501726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd4a64f2-2724-49fa-abe9-18b88d149915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa01f5c9120>]}
[0m15:41:28.502334 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:41:28.503133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd4a64f2-2724-49fa-abe9-18b88d149915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa01f5c90f0>]}
[0m15:41:28.504993 [info ] [MainThread]: 
[0m15:41:28.506181 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:41:28.507823 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:41:28.508397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:29.590454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m15:41:29.591288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:29.784528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd4a64f2-2724-49fa-abe9-18b88d149915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa01f64f970>]}
[0m15:41:29.786115 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:41:29.787770 [info ] [MainThread]: 
[0m15:41:29.796285 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:41:29.797343 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customers .............................. [RUN]
[0m15:41:29.800272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m15:41:29.801106 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:41:29.804889 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:41:29.805830 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 15:41:29.801681 => 15:41:29.805578
[0m15:41:29.806284 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:41:29.825801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:30.103528 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m15:41:30.104495 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m15:41:37.399408 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e5afd54e-5e98-4162-be39-53b4c97ab836&page=queryresults
[0m15:41:37.423793 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 15:41:29.806582 => 15:41:37.423550
[0m15:41:37.424789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4a64f2-2724-49fa-abe9-18b88d149915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa01f6f0940>]}
[0m15:41:37.425722 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 7.62s]
[0m15:41:37.427170 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:41:37.428849 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m15:41:37.429520 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_orders .......................... [RUN]
[0m15:41:37.430660 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m15:41:37.431121 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m15:41:37.435048 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m15:41:37.436123 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 15:41:37.431921 => 15:41:37.435871
[0m15:41:37.436609 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m15:41:37.457619 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_orders"
[0m15:41:37.458650 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:41:37.459250 [debug] [Thread-3 (]: On model.coffee_shop.monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customers`
group by 1;


[0m15:41:38.090880 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5868173c-8cbb-4b9d-9b8e-028234aa90eb&page=queryresults
[0m15:41:38.094050 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 15:41:37.436968 => 15:41:38.093827
[0m15:41:38.095070 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4a64f2-2724-49fa-abe9-18b88d149915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa01f51f2b0>]}
[0m15:41:38.095869 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 0.66s]
[0m15:41:38.097067 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m15:41:38.099993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:38.100367 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m15:41:38.100701 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m15:41:38.101083 [info ] [MainThread]: 
[0m15:41:38.102036 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.60 seconds (9.60s).
[0m15:41:38.103697 [debug] [MainThread]: Command end result
[0m15:41:38.112739 [info ] [MainThread]: 
[0m15:41:38.113635 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:41:38.114430 [info ] [MainThread]: 
[0m15:41:38.115253 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:41:38.116520 [debug] [MainThread]: Command `dbt run` succeeded at 15:41:38.116333 after 10.24 seconds
[0m15:41:38.117260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02247abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02253a380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa01f5c8a90>]}
[0m15:41:38.117990 [debug] [MainThread]: Flushing usage events
[0m15:41:47.227120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062bb86bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062a6b7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062a6b7c40>]}


============================== 15:41:47.230021 | b3318bcd-7a28-4b2d-9033-e48806e0da8c ==============================
[0m15:41:47.230021 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:41:47.230885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:41:47.594374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3318bcd-7a28-4b2d-9033-e48806e0da8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0628bcfaf0>]}
[0m15:41:47.612447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3318bcd-7a28-4b2d-9033-e48806e0da8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0628b9d930>]}
[0m15:41:47.613451 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:41:47.625274 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:41:47.650431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:41:47.650937 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:41:47.657452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3318bcd-7a28-4b2d-9033-e48806e0da8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062898dae0>]}
[0m15:41:47.665622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3318bcd-7a28-4b2d-9033-e48806e0da8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0628b4d7e0>]}
[0m15:41:47.666195 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:41:47.666790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3318bcd-7a28-4b2d-9033-e48806e0da8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0628b4d780>]}
[0m15:41:47.668502 [info ] [MainThread]: 
[0m15:41:47.669797 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:41:47.671414 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m15:41:47.671888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:48.616873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3318bcd-7a28-4b2d-9033-e48806e0da8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0628b37c70>]}
[0m15:41:48.618083 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:41:48.618936 [info ] [MainThread]: 
[0m15:41:48.625165 [debug] [Thread-1 (]: Began running node test.coffee_shop.accepted_values_customers_customer_id.f457786769
[0m15:41:48.625688 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:41:48.627627 [info ] [Thread-2 (]: 2 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m15:41:48.626690 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_customers_customer_id ........................ [RUN]
[0m15:41:48.626136 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:41:48.629682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.accepted_values_customers_customer_id.f457786769)
[0m15:41:48.631266 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.accepted_values_customers_customer_id.f457786769
[0m15:41:48.630461 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m15:41:48.628701 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m15:41:48.644323 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_customers_customer_id.f457786769"
[0m15:41:48.645304 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m15:41:48.645849 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:41:48.646605 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:41:48.656222 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m15:41:48.667349 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 15:41:48.647059 => 15:41:48.667012
[0m15:41:48.668053 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:41:48.665901 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id.f457786769 (compile): 15:41:48.631649 => 15:41:48.665552
[0m15:41:48.675001 [debug] [Thread-1 (]: Began executing node test.coffee_shop.accepted_values_customers_customer_id.f457786769
[0m15:41:48.664894 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m15:41:48.721604 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.accepted_values_customers_customer_id.f457786769"
[0m15:41:48.722910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:48.723571 [debug] [Thread-1 (]: On test.coffee_shop.accepted_values_customers_customer_id.f457786769: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_customers_customer_id.f457786769"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_id as value_field,
        count(*) as n_records

    from `aec-students`.`dbt_marcel`.`customers`
    group by customer_id

)

select *
from all_values
where value_field not in (
    
)



      
    ) dbt_internal_test
[0m15:41:48.719559 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m15:41:48.724277 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 15:41:48.656670 => 15:41:48.724031
[0m15:41:48.727437 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:41:48.731079 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m15:41:48.732056 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:41:48.732766 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:48.733713 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:41:48.736923 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:41:49.101392 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [26:1]')
[0m15:41:49.421387 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1888d31f-3c8f-482a-87cd-e0c21510d6f8&page=queryresults
[0m15:41:49.422914 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id.f457786769 (execute): 15:41:48.675575 => 15:41:49.422607
[0m15:41:49.441976 [debug] [Thread-1 (]: Database Error in test accepted_values_customers_customer_id (models/customers_test.yml)
  Syntax error: Unexpected ")" at [26:1]
  compiled Code at target/run/coffee_shop/models/customers_test.yml/accepted_values_customers_customer_id.sql
[0m15:41:49.442880 [error] [Thread-1 (]: 1 of 3 ERROR accepted_values_customers_customer_id ............................. [[31mERROR[0m in 0.81s]
[0m15:41:49.443856 [debug] [Thread-1 (]: Finished running node test.coffee_shop.accepted_values_customers_customer_id.f457786769
[0m15:41:50.018103 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:24d8fd18-9e4c-4411-9158-e409e04ad4f1&page=queryresults
[0m15:41:50.020213 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 15:41:48.668557 => 15:41:50.019879
[0m15:41:50.021414 [info ] [Thread-2 (]: 2 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.39s]
[0m15:41:50.022684 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:41:50.537387 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:edad8ee8-50a1-4982-ab06-19fd9fdb8baa&page=queryresults
[0m15:41:50.538765 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 15:41:48.727882 => 15:41:50.538406
[0m15:41:50.540039 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.90s]
[0m15:41:50.541470 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:41:50.544440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:50.544902 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_customers_customer_id.f457786769' was properly closed.
[0m15:41:50.545305 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m15:41:50.545726 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m15:41:50.546234 [info ] [MainThread]: 
[0m15:41:50.546893 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m15:41:50.548305 [debug] [MainThread]: Command end result
[0m15:41:50.556000 [info ] [MainThread]: 
[0m15:41:50.556786 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:41:50.557517 [info ] [MainThread]: 
[0m15:41:50.558299 [error] [MainThread]: [33mDatabase Error in test accepted_values_customers_customer_id (models/customers_test.yml)[0m
[0m15:41:50.559629 [error] [MainThread]:   Syntax error: Unexpected ")" at [26:1]
[0m15:41:50.560425 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers_test.yml/accepted_values_customers_customer_id.sql
[0m15:41:50.561304 [info ] [MainThread]: 
[0m15:41:50.562156 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:41:50.563528 [debug] [MainThread]: Command `dbt test` failed at 15:41:50.563300 after 3.34 seconds
[0m15:41:50.564289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062bb86bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0628b9d930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0628a19750>]}
[0m15:41:50.564841 [debug] [MainThread]: Flushing usage events
[0m15:45:14.876485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a38d2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a25cfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a25cfc10>]}


============================== 15:45:14.879428 | d0bc37a9-8725-4e2c-9e6e-538e1a866aea ==============================
[0m15:45:14.879428 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:45:14.880516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:45:15.230534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0bc37a9-8725-4e2c-9e6e-538e1a866aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a0ac71c0>]}
[0m15:45:15.247863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0bc37a9-8725-4e2c-9e6e-538e1a866aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a0af2110>]}
[0m15:45:15.248635 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:45:15.261269 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:45:15.272153 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading coffee_shop: customers_test.yml - Runtime Error
    Syntax error near line 13
    ------------------------------
    10 |           - unique
    11 |           - not_null
    12 |           - accepted_values
    13 |               values: ['1','2']
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 13, column 21
[0m15:45:15.273139 [debug] [MainThread]: Command `dbt run` failed at 15:45:15.272966 after 0.40 seconds
[0m15:45:15.273729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a38d2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a0856fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7a0857160>]}
[0m15:45:15.274199 [debug] [MainThread]: Flushing usage events
[0m15:46:06.985052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bc8c7ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bc77bfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bc77bfc40>]}


============================== 15:46:06.990033 | d59d8f66-8d2d-4b82-b9bd-91dbd529d13e ==============================
[0m15:46:06.990033 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:46:06.991085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:46:07.359051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd59d8f66-8d2d-4b82-b9bd-91dbd529d13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bc5cd3820>]}
[0m15:46:07.376867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd59d8f66-8d2d-4b82-b9bd-91dbd529d13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bc5ca77c0>]}
[0m15:46:07.377898 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:46:07.389696 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:46:07.401096 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading coffee_shop: customers_test.yml - Runtime Error
    Syntax error near line 13
    ------------------------------
    10 |           - unique
    11 |           - not_null
    12 |           - accepted_values
    13 |               values: [1,2]
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 13, column 21
[0m15:46:07.402330 [debug] [MainThread]: Command `dbt run` failed at 15:46:07.402140 after 0.43 seconds
[0m15:46:07.402847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bc8c7ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bc5c3f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bc5c3f730>]}
[0m15:46:07.403454 [debug] [MainThread]: Flushing usage events
[0m15:46:29.185317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe24f2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe11cfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe11cfc40>]}


============================== 15:46:29.188240 | e1df0d09-d418-4c4f-9f92-658313d37d84 ==============================
[0m15:46:29.188240 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:46:29.189204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:46:29.620517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1df0d09-d418-4c4f-9f92-658313d37d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdf6be6e0>]}
[0m15:46:29.638070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1df0d09-d418-4c4f-9f92-658313d37d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdf6f3400>]}
[0m15:46:29.639033 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:46:29.650641 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:46:29.676056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:46:29.676874 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m15:46:29.702862 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m15:46:29.773868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1df0d09-d418-4c4f-9f92-658313d37d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdf5037c0>]}
[0m15:46:29.780961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1df0d09-d418-4c4f-9f92-658313d37d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdf46d1e0>]}
[0m15:46:29.781578 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:46:29.782157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1df0d09-d418-4c4f-9f92-658313d37d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdf46d1b0>]}
[0m15:46:29.783806 [info ] [MainThread]: 
[0m15:46:29.784990 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:46:29.786518 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:46:29.787279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:30.919694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m15:46:30.920401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:31.115667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1df0d09-d418-4c4f-9f92-658313d37d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdf64ee30>]}
[0m15:46:31.116998 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:46:31.118374 [info ] [MainThread]: 
[0m15:46:31.124535 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:46:31.125299 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customers .............................. [RUN]
[0m15:46:31.126383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m15:46:31.126842 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:46:31.130622 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:46:31.131596 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 15:46:31.127136 => 15:46:31.131345
[0m15:46:31.132049 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:46:31.152253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:31.430491 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m15:46:31.432463 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m15:46:38.404852 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9abaa8f5-c107-480d-978d-47698baaad8f&page=queryresults
[0m15:46:38.423443 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 15:46:31.132342 => 15:46:38.423217
[0m15:46:38.424431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1df0d09-d418-4c4f-9f92-658313d37d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdf4d69e0>]}
[0m15:46:38.425259 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 7.30s]
[0m15:46:38.426468 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:46:38.427660 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m15:46:38.428529 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_orders .......................... [RUN]
[0m15:46:38.429716 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m15:46:38.430188 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m15:46:38.433792 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m15:46:38.434639 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 15:46:38.430490 => 15:46:38.434342
[0m15:46:38.435097 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m15:46:38.455494 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_orders"
[0m15:46:38.456392 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:46:38.456922 [debug] [Thread-3 (]: On model.coffee_shop.monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customers`
group by 1;


[0m15:46:39.051104 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:eeba7859-3166-44bd-b263-d5093d556a54&page=queryresults
[0m15:46:39.054282 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 15:46:38.435394 => 15:46:39.054062
[0m15:46:39.055301 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1df0d09-d418-4c4f-9f92-658313d37d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdf527970>]}
[0m15:46:39.056102 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 0.63s]
[0m15:46:39.057306 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m15:46:39.060302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:39.060690 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m15:46:39.061027 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m15:46:39.061603 [info ] [MainThread]: 
[0m15:46:39.062267 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.28 seconds (9.28s).
[0m15:46:39.063900 [debug] [MainThread]: Command end result
[0m15:46:39.072500 [info ] [MainThread]: 
[0m15:46:39.073296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:46:39.074076 [info ] [MainThread]: 
[0m15:46:39.074867 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:46:39.075976 [debug] [MainThread]: Command `dbt run` succeeded at 15:46:39.075779 after 9.90 seconds
[0m15:46:39.076536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe24f2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefdefcdab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefe25ae1d0>]}
[0m15:46:39.077037 [debug] [MainThread]: Flushing usage events
[0m15:46:47.371426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f255d11eb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f255bbb7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f255bbb7be0>]}


============================== 15:46:47.374378 | 04ec53c6-a200-44f5-b56f-9727560f8ff8 ==============================
[0m15:46:47.374378 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:46:47.375220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:46:47.771945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04ec53c6-a200-44f5-b56f-9727560f8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f255a0cb820>]}
[0m15:46:47.789731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04ec53c6-a200-44f5-b56f-9727560f8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f255a09f7c0>]}
[0m15:46:47.790826 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:46:47.806713 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:46:47.832980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:46:47.833575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:46:47.840192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04ec53c6-a200-44f5-b56f-9727560f8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2559e8d720>]}
[0m15:46:47.848464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04ec53c6-a200-44f5-b56f-9727560f8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f255a049420>]}
[0m15:46:47.849088 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:46:47.849740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04ec53c6-a200-44f5-b56f-9727560f8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f255a0493c0>]}
[0m15:46:47.852006 [info ] [MainThread]: 
[0m15:46:47.853231 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:46:47.854901 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m15:46:47.855438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:48.832042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04ec53c6-a200-44f5-b56f-9727560f8ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f255a049360>]}
[0m15:46:48.833492 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:46:48.834474 [info ] [MainThread]: 
[0m15:46:48.841345 [debug] [Thread-1 (]: Began running node test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b
[0m15:46:48.842980 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_customers_customer_id__1__2 .................. [RUN]
[0m15:46:48.844024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b)
[0m15:46:48.844502 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b
[0m15:46:48.842376 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:46:48.858930 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m15:46:48.860003 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m15:46:48.860483 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:46:48.841895 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:46:48.858208 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b"
[0m15:46:48.869321 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m15:46:48.870038 [info ] [Thread-2 (]: 2 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m15:46:48.871975 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m15:46:48.872598 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:46:48.883370 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m15:46:48.884244 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b (compile): 15:46:48.844807 => 15:46:48.883853
[0m15:46:48.886257 [debug] [Thread-1 (]: Began executing node test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b
[0m15:46:48.885737 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 15:46:48.860790 => 15:46:48.885514
[0m15:46:48.892505 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:46:48.885222 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 15:46:48.873072 => 15:46:48.884832
[0m15:46:48.914297 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b"
[0m15:46:48.914768 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m15:46:48.915456 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:46:48.919239 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m15:46:48.919947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:48.920884 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:46:48.922059 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:46:48.921390 [debug] [Thread-1 (]: On test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_id as value_field,
        count(*) as n_records

    from `aec-students`.`dbt_marcel`.`customers`
    group by customer_id

)

select *
from all_values
where value_field not in (
    '1','2'
)



      
    ) dbt_internal_test
[0m15:46:48.922680 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:46:48.927100 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:46:50.245930 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ce8fcdee-c69d-4ea1-9dd7-797c6b1f31fb&page=queryresults
[0m15:46:50.248006 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 15:46:48.916605 => 15:46:50.247708
[0m15:46:50.249103 [info ] [Thread-2 (]: 2 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.38s]
[0m15:46:50.250538 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:46:50.500993 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d448b9ed-52de-47b2-9cb8-f4996ed232d2&page=queryresults
[0m15:46:50.502419 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b (execute): 15:46:48.886578 => 15:46:50.501982
[0m15:46:50.503512 [error] [Thread-1 (]: 1 of 3 FAIL 174397 accepted_values_customers_customer_id__1__2 ................. [[31mFAIL 174397[0m in 1.66s]
[0m15:46:50.504573 [debug] [Thread-1 (]: Finished running node test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b
[0m15:46:50.586888 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d1e3c9e2-3e4b-455e-9952-70c1969dd3c8&page=queryresults
[0m15:46:50.588143 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 15:46:48.908806 => 15:46:50.587847
[0m15:46:50.589355 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.73s]
[0m15:46:50.590634 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:46:50.593332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:50.593761 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b' was properly closed.
[0m15:46:50.594167 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m15:46:50.594550 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m15:46:50.594996 [info ] [MainThread]: 
[0m15:46:50.595873 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m15:46:50.597301 [debug] [MainThread]: Command end result
[0m15:46:50.604588 [info ] [MainThread]: 
[0m15:46:50.605302 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:46:50.605929 [info ] [MainThread]: 
[0m15:46:50.607199 [error] [MainThread]: [31mFailure in test accepted_values_customers_customer_id__1__2 (models/customers_test.yml)[0m
[0m15:46:50.607802 [error] [MainThread]:   Got 174397 results, configured to fail if != 0
[0m15:46:50.608558 [info ] [MainThread]: 
[0m15:46:50.609295 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/customers_test.yml/accepted_values_customers_customer_id__1__2.sql
[0m15:46:50.609949 [info ] [MainThread]: 
[0m15:46:50.610847 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:46:50.612072 [debug] [MainThread]: Command `dbt test` failed at 15:46:50.611877 after 3.25 seconds
[0m15:46:50.612695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f255d11eb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f255a0379a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f255a037b80>]}
[0m15:46:50.613208 [debug] [MainThread]: Flushing usage events
[0m15:48:41.954004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb749bab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb734b7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb734b7c10>]}


============================== 15:48:41.957003 | 1a3a2e4f-359a-4f16-864e-fa3f65fb5d5e ==============================
[0m15:48:41.957003 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:48:41.957955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:48:42.321839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a3a2e4f-359a-4f16-864e-fa3f65fb5d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb719af0a0>]}
[0m15:48:42.339350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a3a2e4f-359a-4f16-864e-fa3f65fb5d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb719da080>]}
[0m15:48:42.340382 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:48:42.352117 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:48:42.380260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:42.380836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:42.387745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a3a2e4f-359a-4f16-864e-fa3f65fb5d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb7178d0c0>]}
[0m15:48:42.398222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a3a2e4f-359a-4f16-864e-fa3f65fb5d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb71948d60>]}
[0m15:48:42.398853 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:48:42.399475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a3a2e4f-359a-4f16-864e-fa3f65fb5d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb71948e50>]}
[0m15:48:42.401639 [info ] [MainThread]: 
[0m15:48:42.402780 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:48:42.404396 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m15:48:42.404877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:43.348041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a3a2e4f-359a-4f16-864e-fa3f65fb5d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb71948d30>]}
[0m15:48:43.349409 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:48:43.350501 [info ] [MainThread]: 
[0m15:48:43.356951 [debug] [Thread-1 (]: Began running node test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b
[0m15:48:43.360689 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:48:43.361933 [info ] [Thread-2 (]: 2 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m15:48:43.361374 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:48:43.364486 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m15:48:43.360101 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_customers_customer_id__1__2 .................. [RUN]
[0m15:48:43.366801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b)
[0m15:48:43.365615 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m15:48:43.367783 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:48:43.363572 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m15:48:43.367282 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b
[0m15:48:43.379289 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m15:48:43.379858 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:48:43.388616 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b"
[0m15:48:43.400846 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 15:48:43.368122 => 15:48:43.400470
[0m15:48:43.401493 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:48:43.402040 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b (compile): 15:48:43.380202 => 15:48:43.401804
[0m15:48:43.403334 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m15:48:43.408070 [debug] [Thread-1 (]: Began executing node test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b
[0m15:48:43.409088 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 15:48:43.389221 => 15:48:43.408796
[0m15:48:43.443908 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b"
[0m15:48:43.444776 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m15:48:43.445425 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:48:43.446501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:43.449476 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m15:48:43.450156 [debug] [Thread-1 (]: On test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_id as value_field,
        count(*) as n_records

    from `aec-students`.`dbt_marcel`.`customers`
    group by customer_id

)

select *
from all_values
where value_field not in (
    '1','2'
)



      
    ) dbt_internal_test
[0m15:48:43.450819 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:48:43.453540 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:48:43.454848 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:48:43.454320 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:48:44.649515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d5a7a068-821c-4fb9-b576-53ee789c700e&page=queryresults
[0m15:48:44.651834 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b (execute): 15:48:43.409397 => 15:48:44.651472
[0m15:48:44.653089 [error] [Thread-1 (]: 1 of 3 FAIL 174397 accepted_values_customers_customer_id__1__2 ................. [[31mFAIL 174397[0m in 1.29s]
[0m15:48:44.654429 [debug] [Thread-1 (]: Finished running node test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b
[0m15:48:44.662107 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8a9745dc-c49d-4629-b6a3-fc5a139a1f26&page=queryresults
[0m15:48:44.662986 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 15:48:43.447021 => 15:48:44.662752
[0m15:48:44.663886 [info ] [Thread-2 (]: 2 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.30s]
[0m15:48:44.664825 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:48:44.691928 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:410cf204-22d6-4703-9947-cdbd5db0c990&page=queryresults
[0m15:48:44.693219 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 15:48:43.403673 => 15:48:44.692856
[0m15:48:44.694448 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.33s]
[0m15:48:44.695749 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:48:44.699307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:44.699699 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2.ce4cfb337b' was properly closed.
[0m15:48:44.700149 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m15:48:44.700788 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m15:48:44.701289 [info ] [MainThread]: 
[0m15:48:44.701885 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m15:48:44.703548 [debug] [MainThread]: Command end result
[0m15:48:44.710694 [info ] [MainThread]: 
[0m15:48:44.711323 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:48:44.711956 [info ] [MainThread]: 
[0m15:48:44.712698 [error] [MainThread]: [31mFailure in test accepted_values_customers_customer_id__1__2 (models/customers_test.yml)[0m
[0m15:48:44.713371 [error] [MainThread]:   Got 174397 results, configured to fail if != 0
[0m15:48:44.714380 [info ] [MainThread]: 
[0m15:48:44.715017 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/customers_test.yml/accepted_values_customers_customer_id__1__2.sql
[0m15:48:44.715697 [info ] [MainThread]: 
[0m15:48:44.716466 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:48:44.718222 [debug] [MainThread]: Command `dbt test` failed at 15:48:44.718030 after 2.77 seconds
[0m15:48:44.721443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb749bab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb71948880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb719484f0>]}
[0m15:48:44.722175 [debug] [MainThread]: Flushing usage events
[0m15:49:56.685496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005826ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0056dbfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0056dbfc70>]}


============================== 15:49:56.688602 | b53b1b57-c02a-454a-9eb6-0a792eb4f455 ==============================
[0m15:49:56.688602 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:49:56.689700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:49:57.115979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b53b1b57-c02a-454a-9eb6-0a792eb4f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0057da1a50>]}
[0m15:49:57.138529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b53b1b57-c02a-454a-9eb6-0a792eb4f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00552e1540>]}
[0m15:49:57.139631 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:49:57.152165 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:49:57.177608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:57.178553 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m15:49:57.204089 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m15:49:57.276974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b53b1b57-c02a-454a-9eb6-0a792eb4f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00551259f0>]}
[0m15:49:57.284513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b53b1b57-c02a-454a-9eb6-0a792eb4f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005505d1e0>]}
[0m15:49:57.285165 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:49:57.285820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b53b1b57-c02a-454a-9eb6-0a792eb4f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005505d2d0>]}
[0m15:49:57.287955 [info ] [MainThread]: 
[0m15:49:57.289920 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:49:57.291621 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m15:49:57.292403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:58.245966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b53b1b57-c02a-454a-9eb6-0a792eb4f455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005505d1b0>]}
[0m15:49:58.247858 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:49:58.248914 [info ] [MainThread]: 
[0m15:49:58.269375 [debug] [Thread-1 (]: Began running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m15:49:58.271002 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:49:58.270321 [info ] [Thread-1 (]: 1 of 3 START test accepted_values_customers_customer_id__1__2__3 ............... [RUN]
[0m15:49:58.273361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934)
[0m15:49:58.274072 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m15:49:58.271621 [info ] [Thread-2 (]: 2 of 3 START test not_null_customers_customer_id ............................... [RUN]
[0m15:49:58.280533 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m15:49:58.281145 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:49:58.290357 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:49:58.291019 [info ] [Thread-3 (]: 3 of 3 START test unique_customers_customer_id ................................. [RUN]
[0m15:49:58.292513 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m15:49:58.292980 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:49:58.297896 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m15:49:58.315225 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (compile): 15:49:58.274561 => 15:49:58.314764
[0m15:49:58.316012 [debug] [Thread-1 (]: Began executing node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m15:49:58.337301 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m15:49:58.339338 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m15:49:58.353446 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m15:49:58.354682 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 15:49:58.304288 => 15:49:58.354318
[0m15:49:58.355738 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:49:58.356374 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 15:49:58.281619 => 15:49:58.356072
[0m15:49:58.360936 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m15:49:58.361887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:58.362463 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:49:58.363200 [debug] [Thread-1 (]: On test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_id as value_field,
        count(*) as n_records

    from `aec-students`.`dbt_marcel`.`customers`
    group by customer_id

)

select *
from all_values
where value_field not in (
    '1','2','3'
)



      
    ) dbt_internal_test
[0m15:49:58.363842 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:49:58.368965 [debug] [Thread-3 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:49:58.366595 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m15:49:58.372301 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:49:58.372802 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:49:59.580139 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:69e3b14c-1a71-41b7-82ce-7ce6c2551f11&page=queryresults
[0m15:49:59.582804 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 15:49:58.364236 => 15:49:59.582431
[0m15:49:59.584310 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7bf6fe63-c2ca-4e2a-99df-48055f9f365f&page=queryresults
[0m15:49:59.585585 [info ] [Thread-2 (]: 2 of 3 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.31s]
[0m15:49:59.587208 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 15:49:58.356636 => 15:49:59.586884
[0m15:49:59.589123 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:49:59.590799 [info ] [Thread-3 (]: 3 of 3 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.30s]
[0m15:49:59.592248 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:50:00.095170 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cc8c391a-666e-4e43-830c-d1d0f053d18d&page=queryresults
[0m15:50:00.096327 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (execute): 15:49:58.323185 => 15:50:00.096024
[0m15:50:00.097363 [error] [Thread-1 (]: 1 of 3 FAIL 174397 accepted_values_customers_customer_id__1__2__3 .............. [[31mFAIL 174397[0m in 1.82s]
[0m15:50:00.098400 [debug] [Thread-1 (]: Finished running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m15:50:00.100803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:00.101178 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934' was properly closed.
[0m15:50:00.101685 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m15:50:00.102126 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m15:50:00.102566 [info ] [MainThread]: 
[0m15:50:00.103562 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m15:50:00.105423 [debug] [MainThread]: Command end result
[0m15:50:00.119036 [info ] [MainThread]: 
[0m15:50:00.120648 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:50:00.121364 [info ] [MainThread]: 
[0m15:50:00.122275 [error] [MainThread]: [31mFailure in test accepted_values_customers_customer_id__1__2__3 (models/customers_test.yml)[0m
[0m15:50:00.122991 [error] [MainThread]:   Got 174397 results, configured to fail if != 0
[0m15:50:00.123843 [info ] [MainThread]: 
[0m15:50:00.124502 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/customers_test.yml/accepted_values_customers_customer_id__1__2__3.sql
[0m15:50:00.126872 [info ] [MainThread]: 
[0m15:50:00.129808 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:50:00.130880 [debug] [MainThread]: Command `dbt test` failed at 15:50:00.130740 after 3.45 seconds
[0m15:50:00.131356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f005826ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0054c02aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0054c02fb0>]}
[0m15:50:00.132167 [debug] [MainThread]: Flushing usage events
[0m15:58:04.000466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f140a57abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14092d3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14092d3c70>]}


============================== 15:58:04.003548 | 48642675-659a-491f-9337-2acb3f69beab ==============================
[0m15:58:04.003548 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:58:04.004415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:58:04.379105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48642675-659a-491f-9337-2acb3f69beab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14077bb0a0>]}
[0m15:58:04.396676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48642675-659a-491f-9337-2acb3f69beab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14077f4040>]}
[0m15:58:04.397725 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:58:04.409687 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:58:04.435859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:58:04.436825 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m15:58:04.462845 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m15:58:04.544053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48642675-659a-491f-9337-2acb3f69beab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1407603070>]}
[0m15:58:04.551902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48642675-659a-491f-9337-2acb3f69beab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1407571390>]}
[0m15:58:04.552554 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:58:04.553410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48642675-659a-491f-9337-2acb3f69beab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1407571480>]}
[0m15:58:04.555389 [info ] [MainThread]: 
[0m15:58:04.556533 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:58:04.558139 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:58:04.558745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:05.734940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m15:58:05.735684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:05.993260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48642675-659a-491f-9337-2acb3f69beab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1407557ee0>]}
[0m15:58:05.994291 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:58:05.994906 [info ] [MainThread]: 
[0m15:58:06.000313 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:58:06.000965 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customers .............................. [RUN]
[0m15:58:06.001982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m15:58:06.002426 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:58:06.006044 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:58:06.006985 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 15:58:06.002718 => 15:58:06.006686
[0m15:58:06.007435 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:58:06.031032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:06.289770 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m15:58:06.290758 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m15:58:14.565565 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7a537ce1-14d6-4574-90d1-e815f6a02b77&page=queryresults
[0m15:58:14.584731 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 15:58:06.007728 => 15:58:14.584496
[0m15:58:14.585795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48642675-659a-491f-9337-2acb3f69beab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14075575b0>]}
[0m15:58:14.586624 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.58s]
[0m15:58:14.587644 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:58:14.589032 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m15:58:14.589662 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_orders .......................... [RUN]
[0m15:58:14.590650 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m15:58:14.591094 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m15:58:14.595317 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m15:58:14.596541 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 15:58:14.591385 => 15:58:14.596165
[0m15:58:14.597256 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m15:58:14.623428 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_orders"
[0m15:58:14.624448 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:58:14.625008 [debug] [Thread-3 (]: On model.coffee_shop.monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customers`
group by 1;


[0m15:58:15.222541 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e18d688a-a137-4e5a-be6b-ce7026157535&page=queryresults
[0m15:58:15.225469 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 15:58:14.597711 => 15:58:15.225181
[0m15:58:15.227080 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48642675-659a-491f-9337-2acb3f69beab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14070c5cc0>]}
[0m15:58:15.228546 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 0.64s]
[0m15:58:15.229686 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m15:58:15.235607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:15.236502 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m15:58:15.237159 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m15:58:15.238099 [info ] [MainThread]: 
[0m15:58:15.240713 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.68 seconds (10.68s).
[0m15:58:15.242802 [debug] [MainThread]: Command end result
[0m15:58:15.252963 [info ] [MainThread]: 
[0m15:58:15.254024 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:15.254837 [info ] [MainThread]: 
[0m15:58:15.255723 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:58:15.256962 [debug] [MainThread]: Command `dbt run` succeeded at 15:58:15.256769 after 11.26 seconds
[0m15:58:15.257508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f140a57abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14077f4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14075715d0>]}
[0m15:58:15.258043 [debug] [MainThread]: Flushing usage events
[0m15:58:22.802510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35b6d62c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35b5897df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35b5897cd0>]}


============================== 15:58:22.805583 | 47d29485-b546-47a9-b95a-0507e19c8d45 ==============================
[0m15:58:22.805583 [info ] [MainThread]: Running with dbt=1.5.2
[0m15:58:22.806629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:58:23.240773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47d29485-b546-47a9-b95a-0507e19c8d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35b3da7a00>]}
[0m15:58:23.258850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47d29485-b546-47a9-b95a-0507e19c8d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35b3d7b6a0>]}
[0m15:58:23.259964 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m15:58:23.272220 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m15:58:23.298724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:23.299385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:23.306283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47d29485-b546-47a9-b95a-0507e19c8d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35b3b69ba0>]}
[0m15:58:23.319639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47d29485-b546-47a9-b95a-0507e19c8d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35b3d2d8a0>]}
[0m15:58:23.320671 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:58:23.321527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47d29485-b546-47a9-b95a-0507e19c8d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35b3d2d840>]}
[0m15:58:23.323609 [info ] [MainThread]: 
[0m15:58:23.324871 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:58:23.326550 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m15:58:23.327070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:24.315143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47d29485-b546-47a9-b95a-0507e19c8d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35b3d17b20>]}
[0m15:58:24.316527 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:58:24.317520 [info ] [MainThread]: 
[0m15:58:24.325940 [debug] [Thread-1 (]: Began running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m15:58:24.327536 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:58:24.328339 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m15:58:24.332796 [info ] [Thread-3 (]: 3 of 4 START test unique_customer_mjb_customers_customer_id .................... [RUN]
[0m15:58:24.329386 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:58:24.334934 [info ] [Thread-4 (]: 4 of 4 START test unique_customers_customer_id ................................. [RUN]
[0m15:58:24.331902 [info ] [Thread-2 (]: 2 of 4 START test not_null_customers_customer_id ............................... [RUN]
[0m15:58:24.334351 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7'
[0m15:58:24.330469 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_customers_customer_id__1__2__3 ............... [RUN]
[0m15:58:24.338796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934)
[0m15:58:24.337471 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m15:58:24.338038 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m15:58:24.339292 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m15:58:24.336249 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m15:58:24.358285 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:58:24.339782 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:58:24.357503 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m15:58:24.365771 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m15:58:24.366979 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7 (compile): 15:58:24.340172 => 15:58:24.366679
[0m15:58:24.380584 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m15:58:24.381641 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (compile): 15:58:24.348941 => 15:58:24.381266
[0m15:58:24.383420 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 15:58:24.358678 => 15:58:24.383133
[0m15:58:24.385524 [debug] [Thread-3 (]: Compilation Error in test unique_customer_mjb_customers_customer_id (models/customers_test.yml)
  'test_unique_customer_mjb' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:58:24.388508 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 15:58:24.367286 => 15:58:24.388156
[0m15:58:24.387126 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:58:24.386467 [debug] [Thread-1 (]: Began executing node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m15:58:24.389341 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:58:24.387816 [error] [Thread-3 (]: 3 of 4 ERROR unique_customer_mjb_customers_customer_id ......................... [[31mERROR[0m in 0.05s]
[0m15:58:24.415074 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m15:58:24.415515 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m15:58:24.418472 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m15:58:24.419217 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m15:58:24.420307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:24.421733 [debug] [Thread-1 (]: On test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_id as value_field,
        count(*) as n_records

    from `aec-students`.`dbt_marcel`.`customers`
    group by customer_id

)

select *
from all_values
where value_field not in (
    '1','2','3'
)



      
    ) dbt_internal_test
[0m15:58:24.424852 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:58:24.425512 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:58:24.426050 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:58:24.429245 [debug] [Thread-4 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:58:25.682614 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:206f2db5-ccd1-4623-b846-e48975a2e834&page=queryresults
[0m15:58:25.685038 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 15:58:24.415936 => 15:58:25.684664
[0m15:58:25.686448 [info ] [Thread-2 (]: 2 of 4 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.35s]
[0m15:58:25.688275 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m15:58:26.073451 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ffafb755-f3ea-460a-9ed1-dd650eee5f31&page=queryresults
[0m15:58:26.074709 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (execute): 15:58:24.412322 => 15:58:26.074405
[0m15:58:26.075771 [error] [Thread-1 (]: 1 of 4 FAIL 174397 accepted_values_customers_customer_id__1__2__3 .............. [[31mFAIL 174397[0m in 1.74s]
[0m15:58:26.076817 [debug] [Thread-1 (]: Finished running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m15:58:26.263843 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0a3210d6-07d7-4884-b1c7-835f5050ff3d&page=queryresults
[0m15:58:26.265331 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 15:58:24.389921 => 15:58:26.264930
[0m15:58:26.266716 [info ] [Thread-4 (]: 4 of 4 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.93s]
[0m15:58:26.268061 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m15:58:26.271045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:26.271468 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934' was properly closed.
[0m15:58:26.271857 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7' was properly closed.
[0m15:58:26.272228 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m15:58:26.272598 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m15:58:26.273062 [info ] [MainThread]: 
[0m15:58:26.273948 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m15:58:26.275809 [debug] [MainThread]: Command end result
[0m15:58:26.284262 [info ] [MainThread]: 
[0m15:58:26.285000 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:58:26.285692 [info ] [MainThread]: 
[0m15:58:26.286417 [error] [MainThread]: [33mCompilation Error in test unique_customer_mjb_customers_customer_id (models/customers_test.yml)[0m
[0m15:58:26.287108 [error] [MainThread]:   'test_unique_customer_mjb' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:58:26.287827 [info ] [MainThread]: 
[0m15:58:26.288487 [error] [MainThread]: [31mFailure in test accepted_values_customers_customer_id__1__2__3 (models/customers_test.yml)[0m
[0m15:58:26.289083 [error] [MainThread]:   Got 174397 results, configured to fail if != 0
[0m15:58:26.289826 [info ] [MainThread]: 
[0m15:58:26.290528 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/customers_test.yml/accepted_values_customers_customer_id__1__2__3.sql
[0m15:58:26.291307 [info ] [MainThread]: 
[0m15:58:26.292063 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m15:58:26.293282 [debug] [MainThread]: Command `dbt test` failed at 15:58:26.293047 after 3.50 seconds
[0m15:58:26.293946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35b6d62c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35b3d7b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35b3d2d990>]}
[0m15:58:26.294468 [debug] [MainThread]: Flushing usage events
[0m16:01:48.409683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f833eb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f6db7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f6db7be0>]}


============================== 16:01:48.412844 | de70ecc3-983d-461f-a4b0-9b4d8f9ffabf ==============================
[0m16:01:48.412844 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:01:48.413690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:01:48.831562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de70ecc3-983d-461f-a4b0-9b4d8f9ffabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f52a67a0>]}
[0m16:01:48.849006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de70ecc3-983d-461f-a4b0-9b4d8f9ffabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f52d9570>]}
[0m16:01:48.850291 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:01:48.863230 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:01:48.889117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:01:48.889689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:01:48.896368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de70ecc3-983d-461f-a4b0-9b4d8f9ffabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f508d7b0>]}
[0m16:01:48.905059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de70ecc3-983d-461f-a4b0-9b4d8f9ffabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f524d4b0>]}
[0m16:01:48.905683 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:01:48.906308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de70ecc3-983d-461f-a4b0-9b4d8f9ffabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f524d450>]}
[0m16:01:48.908598 [info ] [MainThread]: 
[0m16:01:48.910030 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:01:48.912013 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:01:48.913667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:50.001811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m16:01:50.002674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:01:50.237789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de70ecc3-983d-461f-a4b0-9b4d8f9ffabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f524c520>]}
[0m16:01:50.239126 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:01:50.239975 [info ] [MainThread]: 
[0m16:01:50.246286 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m16:01:50.246913 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customers .............................. [RUN]
[0m16:01:50.247893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m16:01:50.248345 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m16:01:50.252003 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m16:01:50.253051 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 16:01:50.248649 => 16:01:50.252796
[0m16:01:50.253532 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m16:01:50.269170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:50.544367 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m16:01:50.545490 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m16:01:58.326645 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:43f5b3aa-66f3-4f38-ba6a-77abe92b267a&page=queryresults
[0m16:01:58.345380 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 16:01:50.253832 => 16:01:58.345102
[0m16:01:58.346410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de70ecc3-983d-461f-a4b0-9b4d8f9ffabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f5117d00>]}
[0m16:01:58.347238 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.10s]
[0m16:01:58.348365 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m16:01:58.350374 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m16:01:58.351195 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_orders .......................... [RUN]
[0m16:01:58.352481 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m16:01:58.352969 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m16:01:58.361244 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m16:01:58.362108 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 16:01:58.353353 => 16:01:58.361805
[0m16:01:58.362556 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m16:01:58.382977 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_orders"
[0m16:01:58.383836 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:01:58.384365 [debug] [Thread-3 (]: On model.coffee_shop.monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customers`
group by 1;


[0m16:01:59.005621 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:123a3642-d76a-4393-99e5-3e0ad23ec846&page=queryresults
[0m16:01:59.008825 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 16:01:58.362852 => 16:01:59.008597
[0m16:01:59.009760 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de70ecc3-983d-461f-a4b0-9b4d8f9ffabf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f508c4f0>]}
[0m16:01:59.010504 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 0.66s]
[0m16:01:59.011713 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m16:01:59.014467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:59.014855 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m16:01:59.015199 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m16:01:59.015595 [info ] [MainThread]: 
[0m16:01:59.016488 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.11 seconds (10.11s).
[0m16:01:59.018091 [debug] [MainThread]: Command end result
[0m16:01:59.026940 [info ] [MainThread]: 
[0m16:01:59.027821 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:59.028538 [info ] [MainThread]: 
[0m16:01:59.029308 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:01:59.030474 [debug] [MainThread]: Command `dbt run` succeeded at 16:01:59.030329 after 10.63 seconds
[0m16:01:59.030998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f833eb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f7d71e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f5115a50>]}
[0m16:01:59.031773 [debug] [MainThread]: Flushing usage events
[0m16:02:08.386610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd93f2b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd7ec3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd7ec3bb0>]}


============================== 16:02:08.389514 | 551d83a0-03d9-4e33-a7f3-5859c996cdb4 ==============================
[0m16:02:08.389514 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:02:08.390587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:02:08.752605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '551d83a0-03d9-4e33-a7f3-5859c996cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd63b28f0>]}
[0m16:02:08.770202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '551d83a0-03d9-4e33-a7f3-5859c996cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd63e7400>]}
[0m16:02:08.771199 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:02:08.782620 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:02:08.807863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:02:08.808401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:02:08.815171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '551d83a0-03d9-4e33-a7f3-5859c996cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd61996f0>]}
[0m16:02:08.823776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '551d83a0-03d9-4e33-a7f3-5859c996cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd61613f0>]}
[0m16:02:08.824564 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:02:08.825329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551d83a0-03d9-4e33-a7f3-5859c996cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd6161390>]}
[0m16:02:08.827581 [info ] [MainThread]: 
[0m16:02:08.828837 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:02:08.830685 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m16:02:08.831308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:09.803086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551d83a0-03d9-4e33-a7f3-5859c996cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd6161330>]}
[0m16:02:09.804420 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:02:09.805258 [info ] [MainThread]: 
[0m16:02:09.812248 [debug] [Thread-1 (]: Began running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:02:09.812823 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:02:09.814587 [info ] [Thread-2 (]: 2 of 4 START test not_null_customers_customer_id ............................... [RUN]
[0m16:02:09.813860 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_customers_customer_id__1__2__3 ............... [RUN]
[0m16:02:09.817566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934)
[0m16:02:09.815774 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m16:02:09.816384 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:02:09.818075 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:02:09.813406 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:02:09.818543 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:02:09.819075 [info ] [Thread-4 (]: 4 of 4 START test unique_customers_customer_id ................................. [RUN]
[0m16:02:09.832417 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m16:02:09.845769 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (compile): 16:02:09.819809 => 16:02:09.845498
[0m16:02:09.832981 [info ] [Thread-3 (]: 3 of 4 START test unique_customer_mjb_customers_customer_id .................... [RUN]
[0m16:02:09.843747 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:02:09.846230 [debug] [Thread-1 (]: Began executing node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:02:09.844850 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m16:02:09.847167 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7'
[0m16:02:09.864166 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:02:09.858441 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:02:09.864779 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 16:02:09.833409 => 16:02:09.864521
[0m16:02:09.885029 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:02:09.870252 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m16:02:09.886793 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7 (compile): 16:02:09.870546 => 16:02:09.886553
[0m16:02:09.885982 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:02:09.890155 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:02:09.892554 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:02:09.893109 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m16:02:09.893679 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 16:02:09.878162 => 16:02:09.893448
[0m16:02:09.894303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:09.898224 [debug] [Thread-1 (]: On test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_id as value_field,
        count(*) as n_records

    from `aec-students`.`dbt_marcel`.`customers`
    group by customer_id

)

select *
from all_values
where value_field not in (
    '1','2','3'
)



      
    ) dbt_internal_test
[0m16:02:09.897047 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:02:09.899618 [debug] [Thread-3 (]: Compilation Error in test unique_customer_mjb_customers_customer_id (models/customers_test.yml)
  'test_unique_customer_mjb' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:02:09.905833 [error] [Thread-3 (]: 3 of 4 ERROR unique_customer_mjb_customers_customer_id ......................... [[31mERROR[0m in 0.06s]
[0m16:02:09.906921 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:02:09.904732 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:02:09.911453 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:02:09.912253 [debug] [Thread-4 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:02:11.317017 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4e3c5a39-9c3d-46c8-bbf1-036ece4bdc65&page=queryresults
[0m16:02:11.319491 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 16:02:09.887120 => 16:02:11.319119
[0m16:02:11.320832 [info ] [Thread-2 (]: 2 of 4 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.51s]
[0m16:02:11.322072 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:02:11.613521 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:473bc283-660b-4a96-8047-7ec114c45837&page=queryresults
[0m16:02:11.614969 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (execute): 16:02:09.847766 => 16:02:11.614593
[0m16:02:11.616297 [error] [Thread-1 (]: 1 of 4 FAIL 174397 accepted_values_customers_customer_id__1__2__3 .............. [[31mFAIL 174397[0m in 1.80s]
[0m16:02:11.617628 [debug] [Thread-1 (]: Finished running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:02:11.902208 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6f1ef10d-44b8-4acb-b717-9fe0c06a0aa8&page=queryresults
[0m16:02:11.903453 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 16:02:09.901823 => 16:02:11.903151
[0m16:02:11.904595 [info ] [Thread-4 (]: 4 of 4 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 2.06s]
[0m16:02:11.905988 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:02:11.908365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:11.908757 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934' was properly closed.
[0m16:02:11.909130 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m16:02:11.909530 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m16:02:11.909895 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7' was properly closed.
[0m16:02:11.910320 [info ] [MainThread]: 
[0m16:02:11.910967 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m16:02:11.913760 [debug] [MainThread]: Command end result
[0m16:02:11.922471 [info ] [MainThread]: 
[0m16:02:11.923116 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:02:11.923731 [info ] [MainThread]: 
[0m16:02:11.924452 [error] [MainThread]: [33mCompilation Error in test unique_customer_mjb_customers_customer_id (models/customers_test.yml)[0m
[0m16:02:11.925180 [error] [MainThread]:   'test_unique_customer_mjb' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:02:11.925814 [info ] [MainThread]: 
[0m16:02:11.926555 [error] [MainThread]: [31mFailure in test accepted_values_customers_customer_id__1__2__3 (models/customers_test.yml)[0m
[0m16:02:11.927265 [error] [MainThread]:   Got 174397 results, configured to fail if != 0
[0m16:02:11.927833 [info ] [MainThread]: 
[0m16:02:11.928507 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/customers_test.yml/accepted_values_customers_customer_id__1__2__3.sql
[0m16:02:11.929442 [info ] [MainThread]: 
[0m16:02:11.930224 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m16:02:11.931295 [debug] [MainThread]: Command `dbt test` failed at 16:02:11.931087 after 3.55 seconds
[0m16:02:11.931825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd93f2b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd63e7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd621cf70>]}
[0m16:02:11.932335 [debug] [MainThread]: Flushing usage events
[0m16:03:09.021513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7dbe6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7c6b7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7c6b7c40>]}


============================== 16:03:09.024463 | 37fcbf10-7e08-49d3-86e3-d2ff42326fe4 ==============================
[0m16:03:09.024463 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:03:09.025328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:03:09.389364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37fcbf10-7e08-49d3-86e3-d2ff42326fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7abcb880>]}
[0m16:03:09.407768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37fcbf10-7e08-49d3-86e3-d2ff42326fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7ab9f880>]}
[0m16:03:09.408734 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:03:09.420913 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:03:09.446019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:09.446479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:09.452650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37fcbf10-7e08-49d3-86e3-d2ff42326fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7a98da20>]}
[0m16:03:09.460645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37fcbf10-7e08-49d3-86e3-d2ff42326fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7ab4d6f0>]}
[0m16:03:09.461251 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:03:09.461962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37fcbf10-7e08-49d3-86e3-d2ff42326fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7ab4d720>]}
[0m16:03:09.464060 [info ] [MainThread]: 
[0m16:03:09.465164 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:03:09.466883 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m16:03:09.467415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:10.478344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37fcbf10-7e08-49d3-86e3-d2ff42326fe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7ab37f70>]}
[0m16:03:10.479631 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:03:10.480571 [info ] [MainThread]: 
[0m16:03:10.486266 [debug] [Thread-1 (]: Began running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:03:10.486810 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:03:10.487254 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:03:10.488489 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:03:10.488989 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_customers_customer_id__1__2__3 ............... [RUN]
[0m16:03:10.489635 [info ] [Thread-2 (]: 2 of 4 START test not_null_customers_customer_id ............................... [RUN]
[0m16:03:10.496000 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m16:03:10.490508 [info ] [Thread-3 (]: 3 of 4 START test unique_customer_mjb_customers_customer_id .................... [RUN]
[0m16:03:10.491984 [info ] [Thread-4 (]: 4 of 4 START test unique_customers_customer_id ................................. [RUN]
[0m16:03:10.498147 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m16:03:10.498576 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:03:10.497327 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7'
[0m16:03:10.493252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934)
[0m16:03:10.496455 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:03:10.509977 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:03:10.510608 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:03:10.511160 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:03:10.520712 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:03:10.536952 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m16:03:10.538050 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7 (compile): 16:03:10.521306 => 16:03:10.537794
[0m16:03:10.538672 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 16:03:10.498862 => 16:03:10.538417
[0m16:03:10.541651 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:03:10.539684 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (compile): 16:03:10.525565 => 16:03:10.539336
[0m16:03:10.542503 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 16:03:10.511546 => 16:03:10.542266
[0m16:03:10.563924 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:03:10.562796 [debug] [Thread-3 (]: Compilation Error in test unique_customer_mjb_customers_customer_id (models/customers_test.yml)
  'test_unique_customer_mjb' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:03:10.563309 [debug] [Thread-1 (]: Began executing node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:03:10.566793 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:03:10.561935 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:03:10.570843 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m16:03:10.567451 [error] [Thread-3 (]: 3 of 4 ERROR unique_customer_mjb_customers_customer_id ......................... [[31mERROR[0m in 0.07s]
[0m16:03:10.573465 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:03:10.572700 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:03:10.574510 [debug] [Thread-4 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:03:10.571909 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:03:10.575031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:03:10.577778 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m16:03:10.578568 [debug] [Thread-1 (]: On test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_id as value_field,
        count(*) as n_records

    from `aec-students`.`dbt_marcel`.`customers`
    group by customer_id

)

select *
from all_values
where value_field not in (
    '1','2','3'
)



      
    ) dbt_internal_test
[0m16:03:11.750639 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1ef31bb8-fd67-4860-b947-70f1f2f6a7b7&page=queryresults
[0m16:03:11.752970 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 16:03:10.542855 => 16:03:11.752626
[0m16:03:11.754765 [info ] [Thread-4 (]: 4 of 4 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.26s]
[0m16:03:11.755880 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:03:11.756635 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8e520bba-9293-4302-b1a3-24f6ed2b08ff&page=queryresults
[0m16:03:11.757953 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fd84170a-eb85-461e-aa1f-512a72fe5f3d&page=queryresults
[0m16:03:11.758866 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (execute): 16:03:10.567923 => 16:03:11.758632
[0m16:03:11.759702 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 16:03:10.564313 => 16:03:11.759429
[0m16:03:11.762156 [info ] [Thread-2 (]: 2 of 4 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.27s]
[0m16:03:11.763122 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:03:11.760684 [error] [Thread-1 (]: 1 of 4 FAIL 174397 accepted_values_customers_customer_id__1__2__3 .............. [[31mFAIL 174397[0m in 1.27s]
[0m16:03:11.764206 [debug] [Thread-1 (]: Finished running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:03:11.766512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:11.766961 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934' was properly closed.
[0m16:03:11.767321 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m16:03:11.767676 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7' was properly closed.
[0m16:03:11.768025 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m16:03:11.768430 [info ] [MainThread]: 
[0m16:03:11.768921 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m16:03:11.770396 [debug] [MainThread]: Command end result
[0m16:03:11.778210 [info ] [MainThread]: 
[0m16:03:11.778964 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:03:11.779628 [info ] [MainThread]: 
[0m16:03:11.780353 [error] [MainThread]: [33mCompilation Error in test unique_customer_mjb_customers_customer_id (models/customers_test.yml)[0m
[0m16:03:11.781107 [error] [MainThread]:   'test_unique_customer_mjb' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:03:11.781756 [info ] [MainThread]: 
[0m16:03:11.782488 [error] [MainThread]: [31mFailure in test accepted_values_customers_customer_id__1__2__3 (models/customers_test.yml)[0m
[0m16:03:11.783169 [error] [MainThread]:   Got 174397 results, configured to fail if != 0
[0m16:03:11.783766 [info ] [MainThread]: 
[0m16:03:11.784503 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/customers_test.yml/accepted_values_customers_customer_id__1__2__3.sql
[0m16:03:11.785285 [info ] [MainThread]: 
[0m16:03:11.785948 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m16:03:11.787072 [debug] [MainThread]: Command `dbt test` failed at 16:03:11.786940 after 2.77 seconds
[0m16:03:11.787555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7dbe6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7ab9f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7ab4cf40>]}
[0m16:03:11.788174 [debug] [MainThread]: Flushing usage events
[0m16:04:18.114762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a64e2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a51cfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a51cfc70>]}


============================== 16:04:18.117584 | 06e9fc2a-40e6-40d1-ae11-5b31db95069e ==============================
[0m16:04:18.117584 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:04:18.118415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:04:18.487507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06e9fc2a-40e6-40d1-ae11-5b31db95069e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a61b1a50>]}
[0m16:04:18.505254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06e9fc2a-40e6-40d1-ae11-5b31db95069e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a36f34c0>]}
[0m16:04:18.506205 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:04:18.517922 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:04:18.543019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:04:18.543468 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:04:18.549665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06e9fc2a-40e6-40d1-ae11-5b31db95069e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a34a5750>]}
[0m16:04:18.557715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06e9fc2a-40e6-40d1-ae11-5b31db95069e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a346d420>]}
[0m16:04:18.558246 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:04:18.558818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06e9fc2a-40e6-40d1-ae11-5b31db95069e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a346d450>]}
[0m16:04:18.560590 [info ] [MainThread]: 
[0m16:04:18.561879 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:04:18.563451 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m16:04:18.563962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:19.616054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06e9fc2a-40e6-40d1-ae11-5b31db95069e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a346d2d0>]}
[0m16:04:19.617230 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:04:19.618181 [info ] [MainThread]: 
[0m16:04:19.624326 [debug] [Thread-1 (]: Began running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:04:19.624847 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:04:19.625312 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:04:19.625859 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:04:19.626304 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_customers_customer_id__1__2__3 ............... [RUN]
[0m16:04:19.627138 [info ] [Thread-2 (]: 2 of 4 START test not_null_customers_customer_id ............................... [RUN]
[0m16:04:19.627889 [info ] [Thread-3 (]: 3 of 4 START test unique_customer_mjb_customers_customer_id .................... [RUN]
[0m16:04:19.632858 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7'
[0m16:04:19.628984 [info ] [Thread-4 (]: 4 of 4 START test unique_customers_customer_id ................................. [RUN]
[0m16:04:19.634213 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m16:04:19.633327 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:04:19.630584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934)
[0m16:04:19.634649 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:04:19.631980 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m16:04:19.643871 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:04:19.644747 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7 (compile): 16:04:19.635012 => 16:04:19.644497
[0m16:04:19.651891 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:04:19.652431 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:04:19.661079 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m16:04:19.669109 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 16:04:19.645138 => 16:04:19.668786
[0m16:04:19.676796 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:04:19.677942 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (compile): 16:04:19.652784 => 16:04:19.677564
[0m16:04:19.678376 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:04:19.679523 [debug] [Thread-1 (]: Began executing node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:04:19.704446 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m16:04:19.691350 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 16:04:19.662731 => 16:04:19.691077
[0m16:04:19.701634 [debug] [Thread-3 (]: Compilation Error in test unique_customer_mjb_customers_customer_id (models/customers_test.yml)
  'test_unique_customer_mjb' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:04:19.700886 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:04:19.706504 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:04:19.708176 [error] [Thread-3 (]: 3 of 4 ERROR unique_customer_mjb_customers_customer_id ......................... [[31mERROR[0m in 0.08s]
[0m16:04:19.713695 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:04:19.713021 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:04:19.709051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:19.714360 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:04:19.716536 [debug] [Thread-4 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:19.716000 [debug] [Thread-1 (]: On test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_id as value_field,
        count(*) as n_records

    from `aec-students`.`dbt_marcel`.`customers`
    group by customer_id

)

select *
from all_values
where value_field not in (
    '1','2','3'
)



      
    ) dbt_internal_test
[0m16:04:19.715433 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:04:19.721426 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m16:04:20.865025 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:50ade3e3-b6f7-483f-a44e-eb975c03cb74&page=queryresults
[0m16:04:20.867060 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 16:04:19.709714 => 16:04:20.866765
[0m16:04:20.868120 [info ] [Thread-2 (]: 2 of 4 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.24s]
[0m16:04:20.869329 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:04:20.917783 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6cc19936-32e2-4e29-8cc5-a383e2efd672&page=queryresults
[0m16:04:20.918956 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 16:04:19.680566 => 16:04:20.918655
[0m16:04:20.919974 [info ] [Thread-4 (]: 4 of 4 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.29s]
[0m16:04:20.921107 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:04:20.928401 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:afefb0c1-7de2-4c02-955f-75cb60b12817&page=queryresults
[0m16:04:20.929338 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (execute): 16:04:19.701990 => 16:04:20.929070
[0m16:04:20.930277 [error] [Thread-1 (]: 1 of 4 FAIL 174397 accepted_values_customers_customer_id__1__2__3 .............. [[31mFAIL 174397[0m in 1.30s]
[0m16:04:20.932083 [debug] [Thread-1 (]: Finished running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:04:20.935545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:20.936079 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934' was properly closed.
[0m16:04:20.936608 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m16:04:20.936983 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7' was properly closed.
[0m16:04:20.937399 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m16:04:20.937886 [info ] [MainThread]: 
[0m16:04:20.938481 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m16:04:20.939838 [debug] [MainThread]: Command end result
[0m16:04:20.949450 [info ] [MainThread]: 
[0m16:04:20.950151 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:04:20.950837 [info ] [MainThread]: 
[0m16:04:20.951567 [error] [MainThread]: [33mCompilation Error in test unique_customer_mjb_customers_customer_id (models/customers_test.yml)[0m
[0m16:04:20.952293 [error] [MainThread]:   'test_unique_customer_mjb' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:04:20.953011 [info ] [MainThread]: 
[0m16:04:20.953656 [error] [MainThread]: [31mFailure in test accepted_values_customers_customer_id__1__2__3 (models/customers_test.yml)[0m
[0m16:04:20.954370 [error] [MainThread]:   Got 174397 results, configured to fail if != 0
[0m16:04:20.955045 [info ] [MainThread]: 
[0m16:04:20.955678 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/customers_test.yml/accepted_values_customers_customer_id__1__2__3.sql
[0m16:04:20.956414 [info ] [MainThread]: 
[0m16:04:20.957339 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m16:04:20.958475 [debug] [MainThread]: Command `dbt test` failed at 16:04:20.958242 after 2.85 seconds
[0m16:04:20.958980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a64e2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a36f34c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66a348b400>]}
[0m16:04:20.959491 [debug] [MainThread]: Flushing usage events
[0m16:06:01.977788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7653ed2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76529b7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76529b7cd0>]}


============================== 16:06:01.980585 | 184a2850-187c-4d4d-a5e2-413412950d2a ==============================
[0m16:06:01.980585 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:06:01.981539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:06:02.335544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '184a2850-187c-4d4d-a5e2-413412950d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7650e9dbd0>]}
[0m16:06:02.353408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '184a2850-187c-4d4d-a5e2-413412950d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7650ed93f0>]}
[0m16:06:02.354274 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:06:02.365356 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:06:02.390280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:06:02.390689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:06:02.396586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '184a2850-187c-4d4d-a5e2-413412950d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7650c8d930>]}
[0m16:06:02.404304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '184a2850-187c-4d4d-a5e2-413412950d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7650e4d630>]}
[0m16:06:02.404815 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:06:02.405538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '184a2850-187c-4d4d-a5e2-413412950d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7650e4d5d0>]}
[0m16:06:02.407510 [info ] [MainThread]: 
[0m16:06:02.408572 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:06:02.410142 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m16:06:02.410644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:03.412990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '184a2850-187c-4d4d-a5e2-413412950d2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7650e4d570>]}
[0m16:06:03.414306 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:06:03.415203 [info ] [MainThread]: 
[0m16:06:03.421146 [debug] [Thread-1 (]: Began running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:06:03.423282 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_customers_customer_id__1__2__3 ............... [RUN]
[0m16:06:03.424301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934)
[0m16:06:03.422560 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:06:03.425476 [info ] [Thread-4 (]: 4 of 4 START test unique_customers_customer_id ................................. [RUN]
[0m16:06:03.422147 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:06:03.424769 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:06:03.426472 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m16:06:03.433565 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:06:03.421705 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:06:03.427267 [info ] [Thread-3 (]: 3 of 4 START test unique_customer_mjb_customers_customer_id .................... [RUN]
[0m16:06:03.441486 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7'
[0m16:06:03.442186 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:06:03.440022 [info ] [Thread-2 (]: 2 of 4 START test not_null_customers_customer_id ............................... [RUN]
[0m16:06:03.460577 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m16:06:03.461258 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:06:03.474435 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:06:03.480096 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7 (compile): 16:06:03.442639 => 16:06:03.479709
[0m16:06:03.499269 [debug] [Thread-3 (]: Compilation Error in test unique_customer_mjb_customers_customer_id (models/customers_test.yml)
  'test_unique_customer_mjb' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:06:03.500199 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 16:06:03.434026 => 16:06:03.499837
[0m16:06:03.501762 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:06:03.486117 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m16:06:03.519672 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (compile): 16:06:03.427806 => 16:06:03.519308
[0m16:06:03.520310 [debug] [Thread-1 (]: Began executing node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:06:03.518739 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:06:03.542965 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 16:06:03.461721 => 16:06:03.542588
[0m16:06:03.543662 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:06:03.500953 [error] [Thread-3 (]: 3 of 4 ERROR unique_customer_mjb_customers_customer_id ......................... [[31mERROR[0m in 0.06s]
[0m16:06:03.556029 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:06:03.558064 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:06:03.559032 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m16:06:03.559584 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:06:03.560447 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:06:03.562284 [debug] [Thread-4 (]: On test.coffee_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:06:03.561256 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:06:03.564638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:03.565364 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m16:06:03.565999 [debug] [Thread-1 (]: On test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_id as value_field,
        count(*) as n_records

    from `aec-students`.`dbt_marcel`.`customers`
    group by customer_id

)

select *
from all_values
where value_field not in (
    '1','2','3'
)



      
    ) dbt_internal_test
[0m16:06:04.706587 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d0ef74a9-7dae-42c1-adb3-377430c78cd6&page=queryresults
[0m16:06:04.708607 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 16:06:03.544117 => 16:06:04.708305
[0m16:06:04.709742 [info ] [Thread-2 (]: 2 of 4 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.25s]
[0m16:06:04.710791 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:06:04.715993 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:57b0742e-e5db-45b6-98c8-c14716213883&page=queryresults
[0m16:06:04.716988 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (execute): 16:06:03.520746 => 16:06:04.716710
[0m16:06:04.717940 [error] [Thread-1 (]: 1 of 4 FAIL 174397 accepted_values_customers_customer_id__1__2__3 .............. [[31mFAIL 174397[0m in 1.29s]
[0m16:06:04.718980 [debug] [Thread-1 (]: Finished running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:06:04.744357 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5e0586a5-7613-4306-afbd-1fbcd734ebae&page=queryresults
[0m16:06:04.745332 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 16:06:03.502296 => 16:06:04.745051
[0m16:06:04.746266 [info ] [Thread-4 (]: 4 of 4 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.32s]
[0m16:06:04.747292 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:06:04.752635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:04.753019 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934' was properly closed.
[0m16:06:04.753481 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m16:06:04.753863 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7' was properly closed.
[0m16:06:04.754226 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m16:06:04.754649 [info ] [MainThread]: 
[0m16:06:04.755352 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m16:06:04.757069 [debug] [MainThread]: Command end result
[0m16:06:04.764090 [info ] [MainThread]: 
[0m16:06:04.764724 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:06:04.765361 [info ] [MainThread]: 
[0m16:06:04.765975 [error] [MainThread]: [33mCompilation Error in test unique_customer_mjb_customers_customer_id (models/customers_test.yml)[0m
[0m16:06:04.766904 [error] [MainThread]:   'test_unique_customer_mjb' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:06:04.767489 [info ] [MainThread]: 
[0m16:06:04.768560 [error] [MainThread]: [31mFailure in test accepted_values_customers_customer_id__1__2__3 (models/customers_test.yml)[0m
[0m16:06:04.769182 [error] [MainThread]:   Got 174397 results, configured to fail if != 0
[0m16:06:04.770218 [info ] [MainThread]: 
[0m16:06:04.770926 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/customers_test.yml/accepted_values_customers_customer_id__1__2__3.sql
[0m16:06:04.771834 [info ] [MainThread]: 
[0m16:06:04.772481 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m16:06:04.773679 [debug] [MainThread]: Command `dbt test` failed at 16:06:04.773540 after 2.80 seconds
[0m16:06:04.774171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7653ed2c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7650ed93f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7650e3bb20>]}
[0m16:06:04.774669 [debug] [MainThread]: Flushing usage events
[0m16:07:20.483110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b8eb2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b7993b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b7990e80>]}


============================== 16:07:20.485894 | b340f431-ec25-4e0f-85e8-c68139bc3ac4 ==============================
[0m16:07:20.485894 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:07:20.486725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:07:20.487353 [info ] [MainThread]: dbt version: 1.5.2
[0m16:07:20.487899 [info ] [MainThread]: python version: 3.10.6
[0m16:07:20.488519 [info ] [MainThread]: python path: /usr/local/python/current/bin/python
[0m16:07:20.489172 [info ] [MainThread]: os info: Linux-5.15.0-1041-azure-x86_64-with-glibc2.35
[0m16:07:20.489903 [info ] [MainThread]: Using profiles.yml file at /home/vscode/.dbt/profiles.yml
[0m16:07:20.490574 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/aec-self-study-marcel/coffee_shop_marcel/dbt_project.yml
[0m16:07:20.491124 [info ] [MainThread]: Configuration:
[0m16:07:20.828247 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:07:20.862758 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:07:20.863676 [info ] [MainThread]: Required dependencies:
[0m16:07:20.864407 [debug] [MainThread]: Executing "git --help"
[0m16:07:20.894857 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:07:20.895451 [debug] [MainThread]: STDERR: "b''"
[0m16:07:20.895853 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:07:20.896430 [info ] [MainThread]: Connection:
[0m16:07:20.897115 [info ] [MainThread]:   method: oauth
[0m16:07:20.897715 [info ] [MainThread]:   database: aec-students
[0m16:07:20.898688 [info ] [MainThread]:   schema: dbt_marcel
[0m16:07:20.899289 [info ] [MainThread]:   location: US
[0m16:07:20.899858 [info ] [MainThread]:   priority: interactive
[0m16:07:20.900761 [info ] [MainThread]:   timeout_seconds: 300
[0m16:07:20.901401 [info ] [MainThread]:   maximum_bytes_billed: None
[0m16:07:20.901947 [info ] [MainThread]:   execution_project: aec-students
[0m16:07:20.902890 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m16:07:20.903474 [info ] [MainThread]:   job_retries: 1
[0m16:07:20.904358 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m16:07:20.904940 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m16:07:20.905810 [info ] [MainThread]:   gcs_bucket: None
[0m16:07:20.906736 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:07:20.907650 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m16:07:20.908340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:21.598403 [debug] [MainThread]: On debug: select 1 as id
[0m16:07:22.527039 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e56e04b2-0bff-43b6-a9fd-81e36272945c&page=queryresults
[0m16:07:22.527812 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:07:22.528740 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:07:22.530129 [debug] [MainThread]: Command `dbt debug` succeeded at 16:07:22.529942 after 2.05 seconds
[0m16:07:22.530860 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:07:22.531302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b8eb2bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b5e5f130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b5e5e440>]}
[0m16:07:22.531819 [debug] [MainThread]: Flushing usage events
[0m16:08:24.724920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e838b2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e82393ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e82390e20>]}


============================== 16:08:24.729272 | d44fd807-23b9-45fa-9beb-3598b8014e1d ==============================
[0m16:08:24.729272 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:08:24.730190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:08:24.730854 [info ] [MainThread]: dbt version: 1.5.2
[0m16:08:24.731550 [info ] [MainThread]: python version: 3.10.6
[0m16:08:24.732195 [info ] [MainThread]: python path: /usr/local/python/current/bin/python
[0m16:08:24.732862 [info ] [MainThread]: os info: Linux-5.15.0-1041-azure-x86_64-with-glibc2.35
[0m16:08:24.733546 [info ] [MainThread]: Using profiles.yml file at /home/vscode/.dbt/profiles.yml
[0m16:08:24.734256 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/aec-self-study-marcel/coffee_shop_marcel/dbt_project.yml
[0m16:08:24.734916 [info ] [MainThread]: Configuration:
[0m16:08:25.084298 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:08:25.110223 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:08:25.110910 [info ] [MainThread]: Required dependencies:
[0m16:08:25.111595 [debug] [MainThread]: Executing "git --help"
[0m16:08:25.114094 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:08:25.114557 [debug] [MainThread]: STDERR: "b''"
[0m16:08:25.114935 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:08:25.115493 [info ] [MainThread]: Connection:
[0m16:08:25.116386 [info ] [MainThread]:   method: oauth
[0m16:08:25.116969 [info ] [MainThread]:   database: aec-students
[0m16:08:25.117836 [info ] [MainThread]:   schema: dbt_marcel
[0m16:08:25.118505 [info ] [MainThread]:   location: US
[0m16:08:25.119327 [info ] [MainThread]:   priority: interactive
[0m16:08:25.119920 [info ] [MainThread]:   timeout_seconds: 300
[0m16:08:25.120771 [info ] [MainThread]:   maximum_bytes_billed: None
[0m16:08:25.121394 [info ] [MainThread]:   execution_project: aec-students
[0m16:08:25.121968 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m16:08:25.122826 [info ] [MainThread]:   job_retries: 1
[0m16:08:25.123527 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m16:08:25.124374 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m16:08:25.128284 [info ] [MainThread]:   gcs_bucket: None
[0m16:08:25.129878 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:08:25.131166 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m16:08:25.131777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:25.777036 [debug] [MainThread]: On debug: select 1 as id
[0m16:08:26.767814 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2988ac85-6b01-4f4d-94f5-aeed07a8de2f&page=queryresults
[0m16:08:26.768663 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:08:26.769739 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:08:26.770902 [debug] [MainThread]: Command `dbt debug` succeeded at 16:08:26.770727 after 2.06 seconds
[0m16:08:26.771409 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:08:26.772197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e838b2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e8085e980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e8085f910>]}
[0m16:08:26.772962 [debug] [MainThread]: Flushing usage events
[0m16:11:43.139541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31491e2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31481d3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31481d0e20>]}


============================== 16:11:43.142338 | 73d5e602-ecca-48cf-a7c8-dc3638fc5bbe ==============================
[0m16:11:43.142338 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:11:43.143416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:11:43.143997 [info ] [MainThread]: dbt version: 1.5.2
[0m16:11:43.144668 [info ] [MainThread]: python version: 3.10.6
[0m16:11:43.145798 [info ] [MainThread]: python path: /usr/local/python/current/bin/python
[0m16:11:43.146493 [info ] [MainThread]: os info: Linux-5.15.0-1041-azure-x86_64-with-glibc2.35
[0m16:11:43.147347 [info ] [MainThread]: Using profiles.yml file at /home/vscode/.dbt/profiles.yml
[0m16:11:43.148013 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/aec-self-study-marcel/coffee_shop_marcel/dbt_project.yml
[0m16:11:43.148923 [info ] [MainThread]: Configuration:
[0m16:11:43.522212 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:11:43.548860 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:11:43.549722 [info ] [MainThread]: Required dependencies:
[0m16:11:43.550469 [debug] [MainThread]: Executing "git --help"
[0m16:11:43.552954 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:11:43.553462 [debug] [MainThread]: STDERR: "b''"
[0m16:11:43.553851 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:11:43.554577 [info ] [MainThread]: Connection:
[0m16:11:43.555744 [info ] [MainThread]:   method: oauth
[0m16:11:43.556439 [info ] [MainThread]:   database: aec-students
[0m16:11:43.557399 [info ] [MainThread]:   schema: dbt_marcel
[0m16:11:43.558090 [info ] [MainThread]:   location: US
[0m16:11:43.559050 [info ] [MainThread]:   priority: interactive
[0m16:11:43.559765 [info ] [MainThread]:   timeout_seconds: 300
[0m16:11:43.560470 [info ] [MainThread]:   maximum_bytes_billed: None
[0m16:11:43.561486 [info ] [MainThread]:   execution_project: aec-students
[0m16:11:43.562238 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m16:11:43.562964 [info ] [MainThread]:   job_retries: 1
[0m16:11:43.563772 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m16:11:43.564466 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m16:11:43.565210 [info ] [MainThread]:   gcs_bucket: None
[0m16:11:43.566315 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:11:43.567531 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m16:11:43.567981 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:44.230755 [debug] [MainThread]: On debug: select 1 as id
[0m16:11:45.080029 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c671cf17-62fe-4e38-9920-a8500571d0b3&page=queryresults
[0m16:11:45.080869 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:11:45.081842 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:11:45.083331 [debug] [MainThread]: Command `dbt debug` succeeded at 16:11:45.082986 after 1.96 seconds
[0m16:11:45.084005 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:11:45.084645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31491e2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31463a2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31463a3910>]}
[0m16:11:45.085219 [debug] [MainThread]: Flushing usage events
[0m16:15:16.665489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70db3abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70c7cfe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70c7cfe20>]}


============================== 16:15:16.668600 | b1884b39-199f-4d6a-beee-58855b7eed4f ==============================
[0m16:15:16.668600 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:15:16.669486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:15:17.032999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1884b39-199f-4d6a-beee-58855b7eed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70acc27a0>]}
[0m16:15:17.050457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1884b39-199f-4d6a-beee-58855b7eed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70acf5570>]}
[0m16:15:17.051569 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:15:17.063628 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:15:17.088803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:17.089275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:17.095396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1884b39-199f-4d6a-beee-58855b7eed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70aaa57b0>]}
[0m16:15:17.096942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1884b39-199f-4d6a-beee-58855b7eed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70aa6d450>]}
[0m16:15:17.097484 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:15:17.098058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1884b39-199f-4d6a-beee-58855b7eed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70aa6d540>]}
[0m16:15:17.099776 [info ] [MainThread]: 
[0m16:15:17.101177 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:15:17.102878 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m16:15:17.103477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:18.189829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1884b39-199f-4d6a-beee-58855b7eed4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70aa6d3f0>]}
[0m16:15:18.191173 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:15:18.192241 [info ] [MainThread]: 
[0m16:15:18.197787 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m16:15:18.198649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m16:15:18.199166 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m16:15:18.202625 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m16:15:18.203579 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 16:15:18.199501 => 16:15:18.203261
[0m16:15:18.204310 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m16:15:18.209144 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 16:15:18.207902 => 16:15:18.207928
[0m16:15:18.210658 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m16:15:18.214639 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m16:15:18.216612 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m16:15:18.220804 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m16:15:18.218675 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:15:18.219616 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:15:18.226292 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7'
[0m16:15:18.226732 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:15:18.217621 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:15:18.225380 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m16:15:18.236137 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:15:18.220285 [debug] [Thread-7 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:15:18.235172 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934'
[0m16:15:18.224402 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m16:15:18.245935 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:15:18.246767 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m16:15:18.247325 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:15:18.248357 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7 (compile): 16:15:18.227028 => 16:15:18.248117
[0m16:15:18.249320 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 16:15:18.236506 => 16:15:18.248947
[0m16:15:18.249789 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:15:18.255725 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 16:15:18.221175 => 16:15:18.255467
[0m16:15:18.259088 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m16:15:18.260318 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:15:18.269930 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:15:18.270625 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m16:15:18.274886 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 16:15:18.274596 => 16:15:18.274611
[0m16:15:18.276057 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m16:15:18.274191 [debug] [Thread-6 (]: Compilation Error in test unique_customer_mjb_customers_customer_id (models/customers_test.yml)
  'test_unique_customer_mjb' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:15:18.272714 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (compile): 16:15:18.250239 => 16:15:18.272462
[0m16:15:18.277905 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:15:18.276943 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7
[0m16:15:18.277426 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 16:15:18.260867 => 16:15:18.277211
[0m16:15:18.273271 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 16:15:18.273003 => 16:15:18.273018
[0m16:15:18.278480 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (execute): 16:15:18.278206 => 16:15:18.278217
[0m16:15:18.281347 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:15:18.279275 [debug] [Thread-7 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:15:18.280319 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:15:18.282121 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 16:15:18.281883 => 16:15:18.281893
[0m16:15:18.283289 [debug] [Thread-7 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:15:18.283846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:18.284445 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m16:15:18.284801 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m16:15:18.285152 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m16:15:18.285537 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customer_mjb_customers_customer_id.cdca46b2f7' was properly closed.
[0m16:15:18.285890 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934' was properly closed.
[0m16:15:18.286239 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m16:15:18.286742 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test unique_customer_mjb_customers_customer_id (models/customers_test.yml)
    'test_unique_customer_mjb' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:15:18.287947 [debug] [MainThread]: Command `dbt docs generate` failed at 16:15:18.287816 after 1.63 seconds
[0m16:15:18.288383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70db3abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe70816b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe708169150>]}
[0m16:15:18.289053 [debug] [MainThread]: Flushing usage events
[0m16:15:52.786595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd41982bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd40497d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd40497c40>]}


============================== 16:15:52.789647 | f5b65ba0-1cfb-4798-b7ab-eb1e13d37ab7 ==============================
[0m16:15:52.789647 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:15:52.790509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:15:53.222245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5b65ba0-1cfb-4798-b7ab-eb1e13d37ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3e982a10>]}
[0m16:15:53.240153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5b65ba0-1cfb-4798-b7ab-eb1e13d37ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3e9b7400>]}
[0m16:15:53.241098 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:15:53.254858 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:15:53.286694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:15:53.287577 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m16:15:53.313522 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m16:15:53.385816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5b65ba0-1cfb-4798-b7ab-eb1e13d37ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3e7f8490>]}
[0m16:15:53.393348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5b65ba0-1cfb-4798-b7ab-eb1e13d37ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3e92d480>]}
[0m16:15:53.394000 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:15:53.394635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5b65ba0-1cfb-4798-b7ab-eb1e13d37ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3e92d450>]}
[0m16:15:53.396340 [info ] [MainThread]: 
[0m16:15:53.397675 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:15:53.399224 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:15:53.399806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:54.509483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m16:15:54.510183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:54.732830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5b65ba0-1cfb-4798-b7ab-eb1e13d37ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3e9170d0>]}
[0m16:15:54.733932 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:15:54.734678 [info ] [MainThread]: 
[0m16:15:54.740525 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m16:15:54.741170 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customers .............................. [RUN]
[0m16:15:54.742355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m16:15:54.742815 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m16:15:54.746680 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m16:15:54.747762 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 16:15:54.743382 => 16:15:54.747498
[0m16:15:54.748304 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m16:15:54.767406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:55.017433 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m16:15:55.018483 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m16:16:02.352652 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:df3ae63a-b5b0-4dfc-ab7d-fb3bf456c5ce&page=queryresults
[0m16:16:02.372063 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 16:15:54.748669 => 16:16:02.371836
[0m16:16:02.373026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b65ba0-1cfb-4798-b7ab-eb1e13d37ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3e9b4fa0>]}
[0m16:16:02.373840 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 7.63s]
[0m16:16:02.375035 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m16:16:02.376205 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m16:16:02.377082 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_orders .......................... [RUN]
[0m16:16:02.378261 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m16:16:02.378722 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m16:16:02.382307 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m16:16:02.383172 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 16:16:02.379034 => 16:16:02.382873
[0m16:16:02.383621 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m16:16:02.404213 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_orders"
[0m16:16:02.405120 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:16:02.405704 [debug] [Thread-3 (]: On model.coffee_shop.monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customers`
group by 1;


[0m16:16:03.056530 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:901f0398-2311-460d-b18b-abf2ad3a0193&page=queryresults
[0m16:16:03.059999 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 16:16:02.383917 => 16:16:03.059723
[0m16:16:03.061225 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5b65ba0-1cfb-4798-b7ab-eb1e13d37ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3e7e8f10>]}
[0m16:16:03.062178 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 0.68s]
[0m16:16:03.063449 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m16:16:03.066319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:03.066706 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m16:16:03.067049 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m16:16:03.067439 [info ] [MainThread]: 
[0m16:16:03.068010 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.67 seconds (9.67s).
[0m16:16:03.069803 [debug] [MainThread]: Command end result
[0m16:16:03.078752 [info ] [MainThread]: 
[0m16:16:03.079403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:16:03.080018 [info ] [MainThread]: 
[0m16:16:03.081081 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:16:03.082353 [debug] [MainThread]: Command `dbt run` succeeded at 16:16:03.082199 after 10.30 seconds
[0m16:16:03.082810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd41982bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd418461d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3e9170a0>]}
[0m16:16:03.083311 [debug] [MainThread]: Flushing usage events
[0m16:16:10.337124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb40aec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb2dcfee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb2dcfe80>]}


============================== 16:16:10.340107 | 66e36b09-8ca6-4e8a-beb9-5ee425c29b1c ==============================
[0m16:16:10.340107 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:16:10.340961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:16:10.767104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66e36b09-8ca6-4e8a-beb9-5ee425c29b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb12ebbb0>]}
[0m16:16:10.785070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66e36b09-8ca6-4e8a-beb9-5ee425c29b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb12bb730>]}
[0m16:16:10.786141 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:16:10.798033 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:16:10.823820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:16:10.824348 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:16:10.830874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66e36b09-8ca6-4e8a-beb9-5ee425c29b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb10a1a20>]}
[0m16:16:10.832524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66e36b09-8ca6-4e8a-beb9-5ee425c29b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb10696c0>]}
[0m16:16:10.833062 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:16:10.833920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66e36b09-8ca6-4e8a-beb9-5ee425c29b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb10697b0>]}
[0m16:16:10.835899 [info ] [MainThread]: 
[0m16:16:10.837009 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:16:10.838477 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m16:16:10.839007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:11.843732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66e36b09-8ca6-4e8a-beb9-5ee425c29b1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb1069660>]}
[0m16:16:11.844921 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:16:11.845920 [info ] [MainThread]: 
[0m16:16:11.852125 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m16:16:11.853053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m16:16:11.853700 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m16:16:11.857273 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m16:16:11.858187 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 16:16:11.854020 => 16:16:11.857884
[0m16:16:11.858651 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m16:16:11.859209 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 16:16:11.858947 => 16:16:11.858975
[0m16:16:11.860221 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m16:16:11.861307 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m16:16:11.861778 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:16:11.864405 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934'
[0m16:16:11.864876 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:16:11.863497 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m16:16:11.862202 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:16:11.862611 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:16:11.877776 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m16:16:11.878406 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m16:16:11.879410 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m16:16:11.880355 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m16:16:11.881414 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (compile): 16:16:11.865181 => 16:16:11.880994
[0m16:16:11.884622 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m16:16:11.885169 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:16:11.885697 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:16:11.886204 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:16:11.896353 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:16:11.902710 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (execute): 16:16:11.902326 => 16:16:11.902356
[0m16:16:11.903342 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 16:16:11.881717 => 16:16:11.903073
[0m16:16:11.907246 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m16:16:11.906648 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:16:11.905115 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:16:11.907911 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 16:16:11.907654 => 16:16:11.907671
[0m16:16:11.910131 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m16:16:11.908693 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 16:16:11.886759 => 16:16:11.908397
[0m16:16:11.911521 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:16:11.912113 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 16:16:11.911858 => 16:16:11.911872
[0m16:16:11.913148 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:16:11.910887 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 16:16:11.896710 => 16:16:11.910567
[0m16:16:11.913868 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:16:11.914450 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 16:16:11.914200 => 16:16:11.914212
[0m16:16:11.915440 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:16:11.917003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:11.917405 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m16:16:11.917746 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m16:16:11.918081 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934' was properly closed.
[0m16:16:11.918414 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m16:16:11.918742 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m16:16:11.920103 [debug] [MainThread]: Command end result
[0m16:16:11.990166 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m16:16:11.990757 [info ] [MainThread]: Building catalog
[0m16:16:11.992465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:12.298999 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m16:16:12.315674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:12.316673 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_marcel`.__TABLES__
        where (upper(dataset_id) = upper('dbt_marcel'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m16:16:14.828750 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2fc45920-dc77-42f1-a951-a7210e64ef58&page=queryresults
[0m16:16:14.848020 [info ] [MainThread]: Catalog written to /workspaces/aec-self-study-marcel/coffee_shop_marcel/target/catalog.json
[0m16:16:14.849413 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:16:14.849244 after 4.52 seconds
[0m16:16:14.849912 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:16:14.850446 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m16:16:14.851148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb40aec20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb12bb730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9bb1068370>]}
[0m16:16:14.851674 [debug] [MainThread]: Flushing usage events
[0m16:17:05.844581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e962ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e85d3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e85d3c40>]}


============================== 16:17:05.847621 | 40cd4254-8999-498e-816d-f4a776810f8e ==============================
[0m16:17:05.847621 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:17:05.848499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:17:06.234795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40cd4254-8999-498e-816d-f4a776810f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e67eba90>]}
[0m16:17:06.252659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40cd4254-8999-498e-816d-f4a776810f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e67bb6d0>]}
[0m16:19:04.497272 [error] [MainThread]: Encountered an error:

[0m16:19:04.521774 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 299, in docs_serve
    results = task.run()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m16:19:04.523275 [debug] [MainThread]: Command `dbt docs serve` failed at 16:19:04.523097 after 118.69 seconds
[0m16:19:04.523823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e962ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e67d66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e67d58a0>]}
[0m16:19:04.524476 [debug] [MainThread]: Flushing usage events
[0m16:19:10.548942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e15beb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e00c3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e00c3be0>]}


============================== 16:19:10.553005 | 4d223c4c-affb-43ce-be75-005e1bc7551e ==============================
[0m16:19:10.553005 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:19:10.554975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:19:10.971297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d223c4c-affb-43ce-be75-005e1bc7551e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53de5b2860>]}
[0m16:19:10.988647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d223c4c-affb-43ce-be75-005e1bc7551e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53de5e94b0>]}
[0m16:26:01.966258 [error] [MainThread]: Encountered an error:

[0m16:26:01.991632 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 299, in docs_serve
    results = task.run()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 237, in serve_forever
    self._handle_request_noblock()
  File "/usr/lib/python3.10/socketserver.py", line 316, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/lib/python3.10/socketserver.py", line 347, in process_request
    self.finish_request(request, client_address)
  File "/usr/lib/python3.10/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/lib/python3.10/http/server.py", line 658, in __init__
    super().__init__(*args, **kwargs)
  File "/usr/lib/python3.10/socketserver.py", line 747, in __init__
    self.handle()
  File "/usr/lib/python3.10/http/server.py", line 432, in handle
    self.handle_one_request()
  File "/usr/lib/python3.10/http/server.py", line 400, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
KeyboardInterrupt

[0m16:26:01.993097 [debug] [MainThread]: Command `dbt docs serve` failed at 16:26:01.992887 after 411.45 seconds
[0m16:26:01.993952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e15beb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53de5e8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53de5e84f0>]}
[0m16:26:01.994491 [debug] [MainThread]: Flushing usage events
[0m16:37:17.239854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6a666bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c691bfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c691bfe50>]}


============================== 16:37:17.242663 | c22b87af-e24b-4307-b2ee-c1ec4e3f841c ==============================
[0m16:37:17.242663 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:37:17.243638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:37:17.602840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c22b87af-e24b-4307-b2ee-c1ec4e3f841c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c676dbd90>]}
[0m16:37:17.621068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c22b87af-e24b-4307-b2ee-c1ec4e3f841c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c676c2dd0>]}
[0m16:37:17.621990 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:37:17.633310 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:37:17.658748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:37:17.659468 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/schema.yml
[0m16:37:17.674347 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'orders' in the 'models' section of file 'models/schema.yml'
[0m16:37:17.716700 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.coffee_shop.relationships_orders_customer_id__id__ref_customers_.4282b0c525' (models/schema.yml) depends on a node named 'orders' in package '' which was not found
[0m16:37:17.727796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c22b87af-e24b-4307-b2ee-c1ec4e3f841c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c675184c0>]}
[0m16:37:17.729930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c22b87af-e24b-4307-b2ee-c1ec4e3f841c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6763be50>]}
[0m16:37:17.730557 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:37:17.731292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22b87af-e24b-4307-b2ee-c1ec4e3f841c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6763be80>]}
[0m16:37:17.733148 [info ] [MainThread]: 
[0m16:37:17.734241 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:37:17.735750 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m16:37:17.736306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:18.804293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22b87af-e24b-4307-b2ee-c1ec4e3f841c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6763bd60>]}
[0m16:37:18.805582 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:37:18.806359 [info ] [MainThread]: 
[0m16:37:18.811907 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m16:37:18.812697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m16:37:18.813257 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m16:37:18.816526 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m16:37:18.817397 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 16:37:18.813569 => 16:37:18.817076
[0m16:37:18.817850 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m16:37:18.818411 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 16:37:18.818145 => 16:37:18.818171
[0m16:37:18.819381 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m16:37:18.820535 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m16:37:18.821181 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:37:18.823968 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934'
[0m16:37:18.822335 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:37:18.825316 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m16:37:18.825768 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:37:18.821918 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:37:18.823111 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m16:37:18.824438 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:37:18.833159 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:37:18.834082 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m16:37:18.844738 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m16:37:18.834582 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m16:37:18.845574 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:37:18.846359 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 16:37:18.826063 => 16:37:18.846098
[0m16:37:18.849361 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m16:37:18.859103 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:37:18.859551 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:37:18.860495 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 16:37:18.846822 => 16:37:18.860200
[0m16:37:18.861146 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (compile): 16:37:18.834931 => 16:37:18.860903
[0m16:37:18.863545 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:37:18.862518 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m16:37:18.864705 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 16:37:18.864470 => 16:37:18.864481
[0m16:37:18.864107 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (execute): 16:37:18.863847 => 16:37:18.863861
[0m16:37:18.866774 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:37:18.865749 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m16:37:18.863104 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 16:37:18.849763 => 16:37:18.862871
[0m16:37:18.861909 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 16:37:18.861587 => 16:37:18.861610
[0m16:37:18.867729 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:37:18.868763 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:37:18.869364 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 16:37:18.869078 => 16:37:18.869092
[0m16:37:18.870557 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:37:18.871975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:18.872341 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m16:37:18.872675 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m16:37:18.873002 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934' was properly closed.
[0m16:37:18.873393 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m16:37:18.873746 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m16:37:18.874962 [debug] [MainThread]: Command end result
[0m16:37:18.888068 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m16:37:18.888643 [info ] [MainThread]: Building catalog
[0m16:37:18.889665 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:19.169307 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m16:37:19.184928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:19.185914 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_marcel`.__TABLES__
        where (upper(dataset_id) = upper('dbt_marcel'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m16:37:21.750905 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:06916b48-b05c-4af2-91aa-7cbf04e4e055&page=queryresults
[0m16:37:21.771745 [info ] [MainThread]: Catalog written to /workspaces/aec-self-study-marcel/coffee_shop_marcel/target/catalog.json
[0m16:37:21.773095 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:37:21.772934 after 4.54 seconds
[0m16:37:21.773548 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:37:21.774053 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m16:37:21.774636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c6a666bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c676c2dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c67459810>]}
[0m16:37:21.775130 [debug] [MainThread]: Flushing usage events
[0m16:38:15.056030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d2da6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d1ad3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d1ad3df0>]}


============================== 16:38:15.058819 | 9f0b8eb8-030b-4623-a971-ddeedbc064f9 ==============================
[0m16:38:15.058819 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:38:15.059806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:38:15.412106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f0b8eb8-030b-4623-a971-ddeedbc064f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9cffcf5b0>]}
[0m16:38:15.430036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f0b8eb8-030b-4623-a971-ddeedbc064f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9cfffb280>]}
[0m16:38:15.430949 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:38:15.442143 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:38:15.467365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:38:15.468068 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/schema.yml
[0m16:38:15.540393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f0b8eb8-030b-4623-a971-ddeedbc064f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9cfe280d0>]}
[0m16:38:15.543080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f0b8eb8-030b-4623-a971-ddeedbc064f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9cfd71480>]}
[0m16:38:15.543927 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:38:15.544688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f0b8eb8-030b-4623-a971-ddeedbc064f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9cfd71570>]}
[0m16:38:15.547674 [info ] [MainThread]: 
[0m16:38:15.550783 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:38:15.553108 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m16:38:15.554165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:16.567454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f0b8eb8-030b-4623-a971-ddeedbc064f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9cfd71420>]}
[0m16:38:16.568668 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:38:16.569335 [info ] [MainThread]: 
[0m16:38:16.574636 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m16:38:16.575427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m16:38:16.575898 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m16:38:16.581206 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m16:38:16.582041 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 16:38:16.576199 => 16:38:16.581747
[0m16:38:16.582478 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m16:38:16.583027 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 16:38:16.582769 => 16:38:16.582793
[0m16:38:16.584167 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m16:38:16.585356 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m16:38:16.585803 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:38:16.588313 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934'
[0m16:38:16.588769 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:38:16.587442 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m16:38:16.586204 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:38:16.586599 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:38:16.598603 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934"
[0m16:38:16.599122 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m16:38:16.600024 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d'
[0m16:38:16.604498 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:38:16.603948 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m16:38:16.600868 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1'
[0m16:38:16.613895 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_customer_id.5c9bf9911d"
[0m16:38:16.614825 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:38:16.621113 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 16:38:16.601402 => 16:38:16.620853
[0m16:38:16.621878 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (compile): 16:38:16.604823 => 16:38:16.621599
[0m16:38:16.624345 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_customer_id.c5af1ff4b1"
[0m16:38:16.624754 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m16:38:16.626591 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 16:38:16.626288 => 16:38:16.626305
[0m16:38:16.625711 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:38:16.627676 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m16:38:16.625214 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (compile): 16:38:16.589063 => 16:38:16.624989
[0m16:38:16.628347 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_customer_id.5c9bf9911d (execute): 16:38:16.628053 => 16:38:16.628070
[0m16:38:16.629425 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_monthly_orders_customer_id__id__ref_customers_.4998cb19ea
[0m16:38:16.629987 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 16:38:16.615443 => 16:38:16.629747
[0m16:38:16.630380 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:38:16.631386 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_customers_customer_id.5c9bf9911d
[0m16:38:16.632230 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_monthly_orders_customer_id__id__ref_customers_.4998cb19ea'
[0m16:38:16.632738 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:38:16.633374 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934 (execute): 16:38:16.633117 => 16:38:16.633130
[0m16:38:16.634022 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_monthly_orders_customer_id__id__ref_customers_.4998cb19ea
[0m16:38:16.634625 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 16:38:16.634381 => 16:38:16.634394
[0m16:38:16.642773 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_customers_customer_id.c5af1ff4b1
[0m16:38:16.641759 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_monthly_orders_customer_id__id__ref_customers_.4998cb19ea"
[0m16:38:16.635642 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934
[0m16:38:16.644620 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_monthly_orders_customer_id__id__ref_customers_.4998cb19ea (compile): 16:38:16.635942 => 16:38:16.644323
[0m16:38:16.645488 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_monthly_orders_customer_id__id__ref_customers_.4998cb19ea
[0m16:38:16.646166 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_monthly_orders_customer_id__id__ref_customers_.4998cb19ea (execute): 16:38:16.645912 => 16:38:16.645926
[0m16:38:16.647145 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_monthly_orders_customer_id__id__ref_customers_.4998cb19ea
[0m16:38:16.648574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:16.648931 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m16:38:16.649354 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m16:38:16.649688 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_customers_customer_id__1__2__3.a0b03bf934' was properly closed.
[0m16:38:16.650012 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m16:38:16.650330 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m16:38:16.650648 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_monthly_orders_customer_id__id__ref_customers_.4998cb19ea' was properly closed.
[0m16:38:16.651919 [debug] [MainThread]: Command end result
[0m16:38:16.663158 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m16:38:16.663634 [info ] [MainThread]: Building catalog
[0m16:38:16.664735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:16.963666 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m16:38:16.980228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:16.981260 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_marcel`.__TABLES__
        where (upper(dataset_id) = upper('dbt_marcel'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m16:38:19.460475 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b8877a1d-fa1b-402e-a733-ee80b839bf7f&page=queryresults
[0m16:38:19.480341 [info ] [MainThread]: Catalog written to /workspaces/aec-self-study-marcel/coffee_shop_marcel/target/catalog.json
[0m16:38:19.481633 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:38:19.481463 after 4.43 seconds
[0m16:38:19.482071 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:38:19.482451 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m16:38:19.483087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d2da6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9cffcf5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d2daa380>]}
[0m16:38:19.483698 [debug] [MainThread]: Flushing usage events
[0m16:38:26.877865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba667e6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba65297dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba65297c40>]}


============================== 16:38:26.880668 | 734f51ae-7afe-4d05-ae14-be4c14f03f35 ==============================
[0m16:38:26.880668 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:38:26.881490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:38:27.279222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '734f51ae-7afe-4d05-ae14-be4c14f03f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba665951e0>]}
[0m16:38:27.302014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '734f51ae-7afe-4d05-ae14-be4c14f03f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba637b7250>]}
[0m16:45:29.699426 [error] [MainThread]: Encountered an error:

[0m16:45:29.702262 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 299, in docs_serve
    results = task.run()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m16:45:29.703553 [debug] [MainThread]: Command `dbt docs serve` failed at 16:45:29.703413 after 422.83 seconds
[0m16:45:29.704021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba667e6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba637b4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba637b53f0>]}
[0m16:45:29.704743 [debug] [MainThread]: Flushing usage events
[0m16:46:06.925035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02341ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa021ec3e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa021ec3d90>]}


============================== 16:46:06.927956 | d15e3d49-0475-4cbd-b1f0-3c4cf18a48e6 ==============================
[0m16:46:06.927956 [info ] [MainThread]: Running with dbt=1.5.2
[0m16:46:06.928807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:46:07.344074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd15e3d49-0475-4cbd-b1f0-3c4cf18a48e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0203af010>]}
[0m16:46:07.361820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd15e3d49-0475-4cbd-b1f0-3c4cf18a48e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0203e53c0>]}
[0m16:46:07.362790 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m16:46:07.374563 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m16:46:07.400461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:46:07.400930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:46:07.407521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd15e3d49-0475-4cbd-b1f0-3c4cf18a48e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02019dbd0>]}
[0m16:46:07.415630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd15e3d49-0475-4cbd-b1f0-3c4cf18a48e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0201658d0>]}
[0m16:46:07.416165 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m16:46:07.416737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd15e3d49-0475-4cbd-b1f0-3c4cf18a48e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa020165870>]}
[0m16:46:07.418156 [info ] [MainThread]: 
[0m16:46:07.419380 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:46:07.420788 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:46:07.421468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:08.484720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m16:46:08.485501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:08.681088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd15e3d49-0475-4cbd-b1f0-3c4cf18a48e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa020165180>]}
[0m16:46:08.682390 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:46:08.683684 [info ] [MainThread]: 
[0m16:46:08.690184 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m16:46:08.690827 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_marcel.customers .............................. [RUN]
[0m16:46:08.691831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m16:46:08.692308 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m16:46:08.696034 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m16:46:08.696962 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 16:46:08.692640 => 16:46:08.696612
[0m16:46:08.697456 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m16:46:08.713123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:08.970205 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m16:46:08.971277 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m16:46:17.493827 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:31e283fb-64f4-4ccf-a543-aba621446c82&page=queryresults
[0m16:46:17.512342 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 16:46:08.697764 => 16:46:17.512105
[0m16:46:17.513361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd15e3d49-0475-4cbd-b1f0-3c4cf18a48e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02022bee0>]}
[0m16:46:17.514169 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.82s]
[0m16:46:17.515186 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m16:46:17.518106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:17.518490 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m16:46:17.518875 [info ] [MainThread]: 
[0m16:46:17.519441 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.10 seconds (10.10s).
[0m16:46:17.520420 [debug] [MainThread]: Command end result
[0m16:46:17.539345 [info ] [MainThread]: 
[0m16:46:17.541521 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:46:17.543671 [info ] [MainThread]: 
[0m16:46:17.545027 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:46:17.546392 [debug] [MainThread]: Command `dbt run` succeeded at 16:46:17.546207 after 10.63 seconds
[0m16:46:17.547084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02341ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02483fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02022b460>]}
[0m16:46:17.547870 [debug] [MainThread]: Flushing usage events
[0m18:21:09.026139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd23086bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd21dcfc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd21dcfc10>]}


============================== 18:21:09.042529 | 4a901385-0774-4ebf-8293-6fef1ed0138f ==============================
[0m18:21:09.042529 [info ] [MainThread]: Running with dbt=1.5.2
[0m18:21:09.045988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:21:09.047078 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /workspaces/aec-self-study-marcel/coffee_shop_marcel/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m18:21:09.051506 [debug] [MainThread]: Command `dbt run` failed at 18:21:09.051261 after 0.04 seconds
[0m18:21:09.052242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd23086bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd21dcfb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd21dcfbb0>]}
[0m18:21:09.053015 [debug] [MainThread]: Flushing usage events
[0m11:12:40.691481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516d04ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516bbb7c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516bbb7be0>]}


============================== 11:12:40.732912 | fde2d6d8-3715-4cd1-bbcd-4611866473a8 ==============================
[0m11:12:40.732912 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:12:40.746835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:12:40.747815 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /workspaces/aec-self-study-marcel/coffee_shop_marcel/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m11:12:40.754370 [debug] [MainThread]: Command `dbt run` failed at 11:12:40.754224 after 0.09 seconds
[0m11:12:40.754941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516d04ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516bbb7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516bbb7b80>]}
[0m11:12:40.755940 [debug] [MainThread]: Flushing usage events
[0m11:19:40.771149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c6ce6b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c57b7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c57b7be0>]}


============================== 11:19:40.775278 | 28935d38-89d2-4b88-932b-06da48f68ba1 ==============================
[0m11:19:40.775278 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:19:40.779037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:19:42.290336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28935d38-89d2-4b88-932b-06da48f68ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c3c9dc60>]}
[0m11:19:42.307814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28935d38-89d2-4b88-932b-06da48f68ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c3cd93f0>]}
[0m11:19:42.308766 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:19:42.320185 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m11:19:42.387078 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 0 files added, 0 files changed.
[0m11:19:42.387978 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/customers.sql
[0m11:19:42.388458 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/monthly_orders.sql
[0m11:19:42.393448 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffee_shop
[0m11:19:42.400919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28935d38-89d2-4b88-932b-06da48f68ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c3a8c4f0>]}
[0m11:19:42.408039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28935d38-89d2-4b88-932b-06da48f68ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c3a59570>]}
[0m11:19:42.408624 [info ] [MainThread]: Found 0 models, 0 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:19:42.409201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28935d38-89d2-4b88-932b-06da48f68ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c3a59540>]}
[0m11:19:42.410445 [info ] [MainThread]: 
[0m11:19:42.411143 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:19:42.412235 [debug] [MainThread]: Command end result
[0m11:19:42.419947 [debug] [MainThread]: Command `dbt run` succeeded at 11:19:42.419818 after 1.66 seconds
[0m11:19:42.420378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c6ce6b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c6ba6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5c3a58fa0>]}
[0m11:19:42.420827 [debug] [MainThread]: Flushing usage events
[0m11:47:45.445867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23562eabc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2354fcfc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2354fcfbe0>]}


============================== 11:47:45.448723 | 0c1089a7-f502-42e1-809d-e46df46fe067 ==============================
[0m11:47:45.448723 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:47:45.449574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:47:45.450277 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /workspaces/aec-self-study-marcel/coffee_shop_marcel/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m11:47:45.451203 [debug] [MainThread]: Command `dbt run` failed at 11:47:45.451016 after 0.01 seconds
[0m11:47:45.451872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23562eabc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2354fcfaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2354fcfb80>]}
[0m11:47:45.452505 [debug] [MainThread]: Flushing usage events
[0m11:53:22.779732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37ce9ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37b993d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37b993c70>]}


============================== 11:53:22.782504 | 9ca44f19-dc83-445f-a331-41e16d27489c ==============================
[0m11:53:22.782504 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:53:22.783694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:53:23.134609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ca44f19-dc83-445f-a331-41e16d27489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa379e76fb0>]}
[0m11:53:23.151958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ca44f19-dc83-445f-a331-41e16d27489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa379eb1450>]}
[0m11:53:23.152782 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:53:23.163780 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m11:53:23.188399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m11:53:23.189020 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/customers_test.yml
[0m11:53:23.189523 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/schema.yml
[0m11:53:23.189977 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/monthly_orders.sql
[0m11:53:23.190417 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/customers.sql
[0m11:53:23.219009 [debug] [MainThread]: 1699: static parser successfully parsed monthly_orders.sql
[0m11:53:23.232853 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m11:53:23.302036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ca44f19-dc83-445f-a331-41e16d27489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa379cb0d60>]}
[0m11:53:23.309250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ca44f19-dc83-445f-a331-41e16d27489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa379e03dc0>]}
[0m11:53:23.309916 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:53:23.310631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ca44f19-dc83-445f-a331-41e16d27489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa379e03eb0>]}
[0m11:53:23.312359 [info ] [MainThread]: 
[0m11:53:23.313844 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:53:23.315329 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:53:23.315894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:28.010303 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m11:53:28.011061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:28.250802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ca44f19-dc83-445f-a331-41e16d27489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa379e02230>]}
[0m11:53:28.251939 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:53:28.252756 [info ] [MainThread]: 
[0m11:53:28.269355 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m11:53:28.270057 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customers .............................. [RUN]
[0m11:53:28.271166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m11:53:28.271713 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m11:53:28.279805 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m11:53:28.280672 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 11:53:28.272749 => 11:53:28.280346
[0m11:53:28.281136 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m11:53:28.296452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:28.571446 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m11:53:28.572469 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m11:53:36.525372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:20d94811-ba20-4c2a-a497-ef4434dd4b52&page=queryresults
[0m11:53:36.542879 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 11:53:28.281430 => 11:53:36.542635
[0m11:53:36.543888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca44f19-dc83-445f-a331-41e16d27489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa379781f60>]}
[0m11:53:36.544725 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.27s]
[0m11:53:36.545742 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m11:53:36.546933 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m11:53:36.548046 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_orders .......................... [RUN]
[0m11:53:36.549209 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m11:53:36.549692 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m11:53:36.554419 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m11:53:36.555639 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 11:53:36.550018 => 11:53:36.555265
[0m11:53:36.556250 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m11:53:36.578314 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_orders"
[0m11:53:36.579172 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:53:36.579757 [debug] [Thread-3 (]: On model.coffee_shop.monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customers`
group by 1;


[0m11:53:37.276765 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a4d864b9-a44e-437a-92da-76d9b92f6b55&page=queryresults
[0m11:53:37.280093 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 11:53:36.557872 => 11:53:37.279858
[0m11:53:37.281035 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ca44f19-dc83-445f-a331-41e16d27489c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa379cec880>]}
[0m11:53:37.281774 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m11:53:37.282938 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m11:53:37.285777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:37.286146 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m11:53:37.286516 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m11:53:37.286942 [info ] [MainThread]: 
[0m11:53:37.287764 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 13.97 seconds (13.97s).
[0m11:53:37.289192 [debug] [MainThread]: Command end result
[0m11:53:37.298031 [info ] [MainThread]: 
[0m11:53:37.298694 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:37.299322 [info ] [MainThread]: 
[0m11:53:37.300406 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:53:37.301386 [debug] [MainThread]: Command `dbt run` succeeded at 11:53:37.301257 after 14.53 seconds
[0m11:53:37.301826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa37ce9ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa379eb1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa379781f60>]}
[0m11:53:37.302302 [debug] [MainThread]: Flushing usage events
[0m19:02:37.633592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03d840ec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03d6eb7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03d6eb7d00>]}


============================== 19:02:37.649547 | 07e45a39-3275-47ec-8fe8-bafe6c641754 ==============================
[0m19:02:37.649547 [info ] [MainThread]: Running with dbt=1.5.2
[0m19:02:37.650483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m19:02:39.195782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07e45a39-3275-47ec-8fe8-bafe6c641754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03d53a5ab0>]}
[0m19:02:39.213394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07e45a39-3275-47ec-8fe8-bafe6c641754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03d53d9540>]}
[0m19:02:39.214720 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:02:39.227158 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m19:02:39.294898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:02:39.295458 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:02:39.302598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07e45a39-3275-47ec-8fe8-bafe6c641754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03d5189990>]}
[0m19:02:39.313934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07e45a39-3275-47ec-8fe8-bafe6c641754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03d5155690>]}
[0m19:02:39.314570 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m19:02:39.315437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07e45a39-3275-47ec-8fe8-bafe6c641754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03d5155630>]}
[0m19:02:39.317024 [info ] [MainThread]: 
[0m19:02:39.318085 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:02:39.319484 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m19:02:39.320025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:44.204500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m19:02:44.205424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:02:44.438037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07e45a39-3275-47ec-8fe8-bafe6c641754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03d5154700>]}
[0m19:02:44.439116 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m19:02:44.439899 [info ] [MainThread]: 
[0m19:02:44.455942 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m19:02:44.456669 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customers .............................. [RUN]
[0m19:02:44.457663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m19:02:44.458165 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m19:02:44.461998 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m19:02:44.463402 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 19:02:44.458620 => 19:02:44.462952
[0m19:02:44.464096 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m19:02:44.480385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:02:44.747222 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m19:02:44.748343 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m19:02:54.066811 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:aafebc70-d71e-4c61-aafa-612f35e11ff3&page=queryresults
[0m19:02:54.085161 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 19:02:44.464847 => 19:02:54.084929
[0m19:02:54.086199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07e45a39-3275-47ec-8fe8-bafe6c641754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03d521bdf0>]}
[0m19:02:54.087059 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 9.63s]
[0m19:02:54.088141 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m19:02:54.089280 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m19:02:54.089910 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_orders .......................... [RUN]
[0m19:02:54.091003 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m19:02:54.091514 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m19:02:54.100613 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m19:02:54.101906 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 19:02:54.091857 => 19:02:54.101512
[0m19:02:54.102450 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m19:02:54.124265 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_orders"
[0m19:02:54.125421 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:02:54.126095 [debug] [Thread-3 (]: On model.coffee_shop.monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customers`
group by 1;


[0m19:02:54.871978 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:dac9a8fb-9acf-4968-8890-bf76a40bb507&page=queryresults
[0m19:02:54.875514 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 19:02:54.102802 => 19:02:54.875186
[0m19:02:54.876687 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07e45a39-3275-47ec-8fe8-bafe6c641754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03d51885e0>]}
[0m19:02:54.877607 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 0.79s]
[0m19:02:54.878656 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m19:02:54.880799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:54.881214 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m19:02:54.881607 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m19:02:54.882057 [info ] [MainThread]: 
[0m19:02:54.882660 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 15.56 seconds (15.56s).
[0m19:02:54.883908 [debug] [MainThread]: Command end result
[0m19:02:54.894068 [info ] [MainThread]: 
[0m19:02:54.895002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:02:54.895666 [info ] [MainThread]: 
[0m19:02:54.896288 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:02:54.897224 [debug] [MainThread]: Command `dbt run` succeeded at 19:02:54.897084 after 17.28 seconds
[0m19:02:54.897716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03d840ec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03d8191d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03d5337fa0>]}
[0m19:02:54.898234 [debug] [MainThread]: Flushing usage events
[0m20:32:50.373348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5268a5ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52677cfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52677cfc40>]}


============================== 20:32:50.388559 | d19243b6-2d74-4197-8633-9bb4fa11e2fa ==============================
[0m20:32:50.388559 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:32:50.389494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:32:51.897649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd19243b6-2d74-4197-8633-9bb4fa11e2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265ce37c0>]}
[0m20:32:51.915234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd19243b6-2d74-4197-8633-9bb4fa11e2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265cb78b0>]}
[0m20:32:51.916583 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:32:51.933703 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:32:51.990816 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m20:32:51.991484 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/monthly_orders.sql
[0m20:32:51.991973 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/customers.sql
[0m20:32:51.992435 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/customers.sql
[0m20:32:51.992846 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/monthly_orders.sql
[0m20:32:52.018066 [debug] [MainThread]: 1699: static parser successfully parsed staging/monthly_orders.sql
[0m20:32:52.034849 [debug] [MainThread]: 1699: static parser successfully parsed staging/customers.sql
[0m20:32:52.106142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd19243b6-2d74-4197-8633-9bb4fa11e2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265b22a70>]}
[0m20:32:52.114530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd19243b6-2d74-4197-8633-9bb4fa11e2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265a6d900>]}
[0m20:32:52.115101 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:32:52.115686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd19243b6-2d74-4197-8633-9bb4fa11e2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265a6d8a0>]}
[0m20:32:52.117136 [info ] [MainThread]: 
[0m20:32:52.118089 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:32:52.119289 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m20:32:52.120154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:56.696718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m20:32:56.697808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:32:56.977276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd19243b6-2d74-4197-8633-9bb4fa11e2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265ccf190>]}
[0m20:32:56.979057 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m20:32:56.980426 [info ] [MainThread]: 
[0m20:32:56.996458 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m20:32:56.997163 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.customers .............................. [RUN]
[0m20:32:56.998169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.customers)
[0m20:32:56.998655 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m20:32:57.006918 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m20:32:57.008182 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 20:32:56.998972 => 20:32:57.007932
[0m20:32:57.008694 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m20:32:57.025049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:57.322034 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m20:32:57.322996 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m20:33:05.205708 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d8f37e1c-7704-45a5-af56-c7f69e7fbb46&page=queryresults
[0m20:33:05.224029 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 20:32:57.009074 => 20:33:05.223807
[0m20:33:05.224941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19243b6-2d74-4197-8633-9bb4fa11e2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52655c1ed0>]}
[0m20:33:05.225720 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.customers ......................... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.23s]
[0m20:33:05.226726 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m20:33:05.227784 [debug] [Thread-3 (]: Began running node model.coffee_shop.monthly_orders
[0m20:33:05.228370 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.monthly_orders .......................... [RUN]
[0m20:33:05.229365 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.monthly_orders'
[0m20:33:05.229875 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.monthly_orders
[0m20:33:05.234203 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.monthly_orders"
[0m20:33:05.235171 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (compile): 20:33:05.230172 => 20:33:05.234756
[0m20:33:05.235632 [debug] [Thread-3 (]: Began executing node model.coffee_shop.monthly_orders
[0m20:33:05.255754 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.monthly_orders"
[0m20:33:05.256575 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:33:05.257097 [debug] [Thread-3 (]: On model.coffee_shop.monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`customers`
group by 1;


[0m20:33:06.263062 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0b083e3f-e1db-4b92-bb68-30ed68b81046&page=queryresults
[0m20:33:06.265831 [debug] [Thread-3 (]: Timing info for model.coffee_shop.monthly_orders (execute): 20:33:05.235930 => 20:33:06.265609
[0m20:33:06.266739 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd19243b6-2d74-4197-8633-9bb4fa11e2fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265aff940>]}
[0m20:33:06.267584 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.monthly_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m20:33:06.268561 [debug] [Thread-3 (]: Finished running node model.coffee_shop.monthly_orders
[0m20:33:06.270756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:06.271125 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m20:33:06.271457 [debug] [MainThread]: Connection 'model.coffee_shop.monthly_orders' was properly closed.
[0m20:33:06.271835 [info ] [MainThread]: 
[0m20:33:06.272373 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 14.15 seconds (14.15s).
[0m20:33:06.273620 [debug] [MainThread]: Command end result
[0m20:33:06.287203 [info ] [MainThread]: 
[0m20:33:06.288100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:06.288920 [info ] [MainThread]: 
[0m20:33:06.289812 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:33:06.291075 [debug] [MainThread]: Command `dbt run` succeeded at 20:33:06.290896 after 15.94 seconds
[0m20:33:06.291827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5268a5ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265cb78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5265601cc0>]}
[0m20:33:06.292605 [debug] [MainThread]: Flushing usage events
[0m20:34:51.470059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eea7d2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee9297d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee9297c40>]}


============================== 20:34:51.472829 | bd3281ff-1c7c-48cb-8a9a-194454e4d217 ==============================
[0m20:34:51.472829 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:34:51.473677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:34:51.841298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd3281ff-1c7c-48cb-8a9a-194454e4d217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee77a7850>]}
[0m20:34:51.858733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd3281ff-1c7c-48cb-8a9a-194454e4d217', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee777b550>]}
[0m20:34:51.859585 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:34:51.871391 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:34:51.896869 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m20:34:51.897555 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/stg_coffee_shop_customers.sql
[0m20:34:51.898126 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/customers.sql
[0m20:34:51.923538 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_coffee_shop_customers.sql
[0m20:34:51.937383 [debug] [MainThread]: 1699: static parser successfully parsed staging/monthly_orders.sql
[0m20:34:51.952279 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'customers' in the 'models' section of file 'models/customers_test.yml'
[0m20:34:51.998276 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop.monthly_orders' (models/staging/monthly_orders.sql) depends on a node named 'customers' which was not found
[0m20:34:51.999285 [debug] [MainThread]: Command `dbt run` failed at 20:34:51.999143 after 0.54 seconds
[0m20:34:51.999765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eea7d2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee77457e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ee7745c00>]}
[0m20:34:52.000313 [debug] [MainThread]: Flushing usage events
[0m20:36:23.307420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8281556b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82801cfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82801cfc10>]}


============================== 20:36:23.312074 | 91034c97-30a0-4ba5-ad33-9e60ec737c92 ==============================
[0m20:36:23.312074 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:36:23.313664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:36:23.682960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91034c97-30a0-4ba5-ad33-9e60ec737c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827e6b5c90>]}
[0m20:36:23.700845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91034c97-30a0-4ba5-ad33-9e60ec737c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827e6f0040>]}
[0m20:36:23.701868 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:36:23.713558 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:36:23.738796 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m20:36:23.739438 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/stg_coffee_shop_monthly_orders.sql
[0m20:36:23.739935 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/stg_coffee_shop_customers.sql
[0m20:36:23.740368 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/monthly_orders.sql
[0m20:36:23.740792 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/customers.sql
[0m20:36:23.768688 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_coffee_shop_monthly_orders.sql
[0m20:36:23.782453 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_coffee_shop_customers.sql
[0m20:36:23.797670 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'monthly_orders' in the 'models' section of file 'models/schema.yml'
[0m20:36:23.829855 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'customers' in the 'models' section of file 'models/customers_test.yml'
[0m20:36:23.844770 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop.stg_coffee_shop_monthly_orders' (models/staging/stg_coffee_shop_monthly_orders.sql) depends on a node named 'customers' which was not found
[0m20:36:23.845671 [debug] [MainThread]: Command `dbt run` failed at 20:36:23.845536 after 0.55 seconds
[0m20:36:23.846132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8281556b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827e485660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f827e485a80>]}
[0m20:36:23.846619 [debug] [MainThread]: Flushing usage events
[0m20:37:27.683806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ab8e6c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98aa5cfdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98aa5cfcd0>]}


============================== 20:37:27.686527 | 7a6e25fc-1554-491e-b993-3ba1b505aa28 ==============================
[0m20:37:27.686527 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:37:27.687351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:37:28.042833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a6e25fc-1554-491e-b993-3ba1b505aa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a8abda50>]}
[0m20:37:28.060659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a6e25fc-1554-491e-b993-3ba1b505aa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a8af3400>]}
[0m20:37:28.061495 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:37:28.073825 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:37:28.098678 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 1 files changed.
[0m20:37:28.099237 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/stg_coffee_shop_monthly_orders.sql
[0m20:37:28.099700 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/stg_coffee_shop_customers.sql
[0m20:37:28.100255 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/schema.yml
[0m20:37:28.100645 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/monthly_orders.sql
[0m20:37:28.101073 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/customers.sql
[0m20:37:28.125948 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_coffee_shop_monthly_orders.sql
[0m20:37:28.139595 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_coffee_shop_customers.sql
[0m20:37:28.185555 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'customers' in the 'models' section of file 'models/customers_test.yml'
[0m20:37:28.200648 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop.stg_coffee_shop_monthly_orders' (models/staging/stg_coffee_shop_monthly_orders.sql) depends on a node named 'customers' which was not found
[0m20:37:28.201578 [debug] [MainThread]: Command `dbt run` failed at 20:37:28.201429 after 0.53 seconds
[0m20:37:28.202041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98ab8e6c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a88854e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98a8885900>]}
[0m20:37:28.202527 [debug] [MainThread]: Flushing usage events
[0m20:38:29.886276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59e886c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59d3bfdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59d3bfca0>]}


============================== 20:38:29.889041 | fc2ffefa-8a5b-4522-85ea-11ed3d96b981 ==============================
[0m20:38:29.889041 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:38:29.889892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:38:30.240335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc2ffefa-8a5b-4522-85ea-11ed3d96b981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59b8aae90>]}
[0m20:38:30.258024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc2ffefa-8a5b-4522-85ea-11ed3d96b981', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59b8e14b0>]}
[0m20:38:30.258925 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:38:30.270986 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:38:30.296399 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
[0m20:38:30.297001 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/stg_coffee_shop_monthly_orders.sql
[0m20:38:30.297527 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/stg_coffee_shop_customers.sql
[0m20:38:30.298105 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/schema.yml
[0m20:38:30.298653 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m20:38:30.299038 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/monthly_orders.sql
[0m20:38:30.299423 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/customers.sql
[0m20:38:30.325048 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_coffee_shop_monthly_orders.sql
[0m20:38:30.340860 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_coffee_shop_customers.sql
[0m20:38:30.401473 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop.stg_coffee_shop_monthly_orders' (models/staging/stg_coffee_shop_monthly_orders.sql) depends on a node named 'customers' which was not found
[0m20:38:30.402534 [debug] [MainThread]: Command `dbt run` failed at 20:38:30.402378 after 0.52 seconds
[0m20:38:30.403023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59e886c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59b675780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc59b675ba0>]}
[0m20:38:30.403523 [debug] [MainThread]: Flushing usage events
[0m20:39:09.034243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fe54eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fd097d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fd097c10>]}


============================== 20:39:09.037071 | 3d14df0d-9f74-4a0d-b086-5d1497ded922 ==============================
[0m20:39:09.037071 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:39:09.037918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:39:09.387995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d14df0d-9f74-4a0d-b086-5d1497ded922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fb5ab850>]}
[0m20:39:09.405114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d14df0d-9f74-4a0d-b086-5d1497ded922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fb57b850>]}
[0m20:39:09.405954 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:39:09.416992 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:39:09.442225 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 2 files changed.
[0m20:39:09.442826 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/stg_coffee_shop_customers.sql
[0m20:39:09.443298 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/stg_coffee_shop_monthly_orders.sql
[0m20:39:09.443864 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/schema.yml
[0m20:39:09.444414 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_test.yml
[0m20:39:09.444795 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/monthly_orders.sql
[0m20:39:09.445177 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/customers.sql
[0m20:39:09.470575 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_coffee_shop_customers.sql
[0m20:39:09.484339 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_coffee_shop_monthly_orders.sql
[0m20:39:09.542349 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_customers_.e2f32351e3' (models/schema.yml) depends on a node named 'customers' in package '' which was not found
[0m20:39:09.553501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d14df0d-9f74-4a0d-b086-5d1497ded922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fb3e6b00>]}
[0m20:39:09.561149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d14df0d-9f74-4a0d-b086-5d1497ded922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fb529900>]}
[0m20:39:09.561701 [info ] [MainThread]: Found 2 models, 3 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:39:09.562271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d14df0d-9f74-4a0d-b086-5d1497ded922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fb5299f0>]}
[0m20:39:09.563714 [info ] [MainThread]: 
[0m20:39:09.564640 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:39:09.565868 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m20:39:09.566396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:10.627389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m20:39:10.628269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:10.870249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d14df0d-9f74-4a0d-b086-5d1497ded922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fb528a90>]}
[0m20:39:10.871261 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m20:39:10.871983 [info ] [MainThread]: 
[0m20:39:10.876633 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m20:39:10.877251 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.stg_coffee_shop_customers .............. [RUN]
[0m20:39:10.878239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m20:39:10.878689 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m20:39:10.886545 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m20:39:10.887394 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 20:39:10.878982 => 20:39:10.887051
[0m20:39:10.887856 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m20:39:10.925660 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m20:39:10.926405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:10.926929 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m20:39:18.593947 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e3c50ab9-2097-45cb-8e7b-5201d5092475&page=queryresults
[0m20:39:18.610370 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 20:39:10.888146 => 20:39:18.610142
[0m20:39:18.611356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d14df0d-9f74-4a0d-b086-5d1497ded922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fb3fea70>]}
[0m20:39:18.612182 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.stg_coffee_shop_customers ......... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 7.73s]
[0m20:39:18.614978 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m20:39:18.617887 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m20:39:18.619940 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.stg_coffee_shop_monthly_orders .......... [RUN]
[0m20:39:18.621424 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m20:39:18.622119 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m20:39:18.628644 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m20:39:18.629525 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 20:39:18.622555 => 20:39:18.629153
[0m20:39:18.629994 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m20:39:18.650723 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m20:39:18.651510 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:39:18.652026 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop_monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
group by 1;


[0m20:39:19.353117 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3cdea1f7-cbce-4890-a12a-ca1e48a07e02&page=queryresults
[0m20:39:19.356300 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 20:39:18.630287 => 20:39:19.356076
[0m20:39:19.357329 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d14df0d-9f74-4a0d-b086-5d1497ded922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fb3ff0a0>]}
[0m20:39:19.358199 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_monthly_orders ..... [[32mCREATE VIEW (0 processed)[0m in 0.74s]
[0m20:39:19.359144 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m20:39:19.361367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:19.361779 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m20:39:19.362150 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m20:39:19.362575 [info ] [MainThread]: 
[0m20:39:19.363143 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 9.80 seconds (9.80s).
[0m20:39:19.364523 [debug] [MainThread]: Command end result
[0m20:39:19.373726 [info ] [MainThread]: 
[0m20:39:19.374358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:39:19.374901 [info ] [MainThread]: 
[0m20:39:19.375487 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:39:19.376336 [debug] [MainThread]: Command `dbt run` succeeded at 20:39:19.376206 after 10.35 seconds
[0m20:39:19.376789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fe54eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fae8b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6fae90af0>]}
[0m20:39:19.377263 [debug] [MainThread]: Flushing usage events
[0m20:40:13.894333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d4dbabc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d3897d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d3897c40>]}


============================== 20:40:13.897047 | 45747ded-6f2a-4674-9b04-db5606dbc68a ==============================
[0m20:40:13.897047 [info ] [MainThread]: Running with dbt=1.5.2
[0m20:40:13.897934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:40:14.242500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45747ded-6f2a-4674-9b04-db5606dbc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d1d836a0>]}
[0m20:40:14.259729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45747ded-6f2a-4674-9b04-db5606dbc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d1db7370>]}
[0m20:40:14.260925 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:40:14.271747 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m20:40:14.297161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:40:14.297881 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/schema.yml
[0m20:40:14.322689 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_coffee_shop_monthly_orders.sql
[0m20:40:14.390640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45747ded-6f2a-4674-9b04-db5606dbc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d1bf8d60>]}
[0m20:40:14.398140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45747ded-6f2a-4674-9b04-db5606dbc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d1d31570>]}
[0m20:40:14.398668 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:40:14.399252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45747ded-6f2a-4674-9b04-db5606dbc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d1d31660>]}
[0m20:40:14.400686 [info ] [MainThread]: 
[0m20:40:14.401627 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:40:14.402827 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m20:40:14.403362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:15.433626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m20:40:15.434323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:15.649634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45747ded-6f2a-4674-9b04-db5606dbc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d1d30700>]}
[0m20:40:15.651021 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m20:40:15.652118 [info ] [MainThread]: 
[0m20:40:15.658351 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m20:40:15.659902 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_marcel.stg_coffee_shop_customers .............. [RUN]
[0m20:40:15.660791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m20:40:15.661237 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m20:40:15.664726 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m20:40:15.665965 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 20:40:15.661554 => 20:40:15.665708
[0m20:40:15.666478 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m20:40:15.685494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:15.982370 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m20:40:15.983303 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */

  
    

    create or replace table `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
    
    

    OPTIONS()
    as (
      


select
  orders.customer_id,
  customers.name,
  customers.email,
  min(orders.created_at) as first_order_at,
  count(distinct orders.id) as number_of_orders
from analytics-engineers-club.coffee_shop.customers as customers 
left join  analytics-engineers-club.coffee_shop.orders  as orders on customers.id = orders.customer_id
Group by
  orders.customer_id,
  customers.name,
  customers.email
order by first_order_at
    );
  
[0m20:40:24.011847 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d5a56190-0cd7-4191-a3e8-7f57ae1b1fd4&page=queryresults
[0m20:40:24.030089 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 20:40:15.666892 => 20:40:24.029858
[0m20:40:24.031000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45747ded-6f2a-4674-9b04-db5606dbc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d1682c80>]}
[0m20:40:24.031767 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_marcel.stg_coffee_shop_customers ......... [[32mCREATE TABLE (174.4k rows, 28.2 MiB processed)[0m in 8.37s]
[0m20:40:24.032706 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m20:40:24.033770 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m20:40:24.034380 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.stg_coffee_shop_monthly_orders .......... [RUN]
[0m20:40:24.035390 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m20:40:24.035863 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m20:40:24.039556 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m20:40:24.040479 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 20:40:24.036164 => 20:40:24.040159
[0m20:40:24.040959 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m20:40:24.061681 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m20:40:24.062536 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:40:24.063042 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop_monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
group by 1;


[0m20:40:24.778785 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3922d7d3-45e2-4f08-9d16-05898a7f0b5e&page=queryresults
[0m20:40:24.781567 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 20:40:24.041262 => 20:40:24.781308
[0m20:40:24.782524 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45747ded-6f2a-4674-9b04-db5606dbc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d1bf8a90>]}
[0m20:40:24.783263 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_monthly_orders ..... [[32mCREATE VIEW (0 processed)[0m in 0.75s]
[0m20:40:24.784149 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m20:40:24.786372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:24.786748 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m20:40:24.787126 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m20:40:24.787568 [info ] [MainThread]: 
[0m20:40:24.788144 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.39 seconds (10.39s).
[0m20:40:24.789216 [debug] [MainThread]: Command end result
[0m20:40:24.798957 [info ] [MainThread]: 
[0m20:40:24.799624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:40:24.800171 [info ] [MainThread]: 
[0m20:40:24.800764 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:40:24.801665 [debug] [MainThread]: Command `dbt run` succeeded at 20:40:24.801530 after 10.91 seconds
[0m20:40:24.802114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d4dbabc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d4dbe3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24d1d17880>]}
[0m20:40:24.802596 [debug] [MainThread]: Flushing usage events
[0m11:58:33.775301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c41e46b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c40ad3e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c40ad3dc0>]}


============================== 11:58:33.790205 | 4be0d8a1-201e-4a0c-ae12-8919125922ff ==============================
[0m11:58:33.790205 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:58:33.791913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:58:35.319877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4be0d8a1-201e-4a0c-ae12-8919125922ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3efc6830>]}
[0m11:58:35.339903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4be0d8a1-201e-4a0c-ae12-8919125922ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3eff94e0>]}
[0m11:58:35.340743 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:58:35.351295 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m11:58:35.379120 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading coffee_shop: staging/coffee_shop/src_coffee_shop.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   - name: analytics-engineers-club
    5  |       database: coffee_shop
    6  |       tables:
    7  |         - name: customers
    8  |         - name: orders
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 15
[0m11:58:35.380050 [debug] [MainThread]: Command `dbt docs generate` failed at 11:58:35.379926 after 1.63 seconds
[0m11:58:35.380472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c41e46b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3ed5baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c3ed5ba30>]}
[0m11:58:35.380879 [debug] [MainThread]: Flushing usage events
[0m11:59:53.701096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811519ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8113cb7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8113cb7df0>]}


============================== 11:59:53.703646 | e28d8986-90ab-4296-9bb7-494d02fd94bc ==============================
[0m11:59:53.703646 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:59:53.704508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:59:54.038590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e28d8986-90ab-4296-9bb7-494d02fd94bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81121cf790>]}
[0m11:59:54.056342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e28d8986-90ab-4296-9bb7-494d02fd94bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81121a3880>]}
[0m11:59:54.057060 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:59:54.067506 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m11:59:54.119126 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 0 files changed.
[0m11:59:54.119690 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m11:59:54.120345 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/src_coffee_shop.yml
[0m11:59:54.120780 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m11:59:54.121174 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/stg_coffee_shop_customers.sql
[0m11:59:54.121524 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/stg_coffee_shop_monthly_orders.sql
[0m11:59:54.146310 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m11:59:54.161705 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_customers.sql
[0m11:59:54.253404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e28d8986-90ab-4296-9bb7-494d02fd94bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8111a53e20>]}
[0m11:59:54.255038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e28d8986-90ab-4296-9bb7-494d02fd94bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8111f55ab0>]}
[0m11:59:54.255527 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m11:59:54.256057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e28d8986-90ab-4296-9bb7-494d02fd94bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8111f55a50>]}
[0m11:59:54.257563 [info ] [MainThread]: 
[0m11:59:54.258418 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:59:54.259484 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m11:59:54.259956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:58.575399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e28d8986-90ab-4296-9bb7-494d02fd94bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8111f55990>]}
[0m11:59:58.576372 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:59:58.576936 [info ] [MainThread]: 
[0m11:59:58.592003 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m11:59:58.592752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m11:59:58.593181 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m11:59:58.596684 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m11:59:58.597919 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 11:59:58.593459 => 11:59:58.597682
[0m11:59:58.598388 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m11:59:58.598945 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 11:59:58.598729 => 11:59:58.598744
[0m11:59:58.599998 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m11:59:58.601090 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m11:59:58.602315 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m11:59:58.602746 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m11:59:58.601519 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m11:59:58.604793 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22'
[0m11:59:58.605264 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m11:59:58.609656 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m11:59:58.610739 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m11:59:58.616661 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m11:59:58.615086 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m11:59:58.617877 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m11:59:58.617130 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m11:59:58.615865 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 11:59:58.605552 => 11:59:58.615543
[0m11:59:58.618273 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m11:59:58.614556 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m11:59:58.627377 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m11:59:58.627917 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m11:59:58.636722 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 11:59:58.636479 => 11:59:58.636492
[0m11:59:58.635444 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 11:59:58.618637 => 11:59:58.635114
[0m11:59:58.636151 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 11:59:58.603002 => 11:59:58.635842
[0m11:59:58.638552 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m11:59:58.639049 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 11:59:58.638823 => 11:59:58.638833
[0m11:59:58.634461 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m11:59:58.638116 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m11:59:58.639941 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m11:59:58.637640 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m11:59:58.640708 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 11:59:58.628261 => 11:59:58.640400
[0m11:59:58.641299 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 11:59:58.641068 => 11:59:58.641078
[0m11:59:58.641960 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m11:59:58.644374 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m11:59:58.643569 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m11:59:58.644790 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m11:59:58.642616 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m11:59:58.650640 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m11:59:58.651705 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 11:59:58.651010 => 11:59:58.651023
[0m11:59:58.652578 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 11:59:58.645229 => 11:59:58.652253
[0m11:59:58.653829 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m11:59:58.654310 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m11:59:58.655044 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 11:59:58.654799 => 11:59:58.654809
[0m11:59:58.655941 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m11:59:58.657269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:58.657613 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m11:59:58.657911 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m11:59:58.658188 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m11:59:58.658462 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m11:59:58.658720 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m11:59:58.658990 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m11:59:58.660263 [debug] [MainThread]: Command end result
[0m11:59:58.707555 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m11:59:58.708144 [info ] [MainThread]: Building catalog
[0m11:59:58.709734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:59:59.125160 [debug] [MainThread]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("GET https://bigquery.googleapis.com/bigquery/v2/projects/coffee_shop/datasets?maxResults=10000&prettyPrint=false: Invalid project ID 'coffee_shop'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m12:00:00.141766 [error] [MainThread]: Encountered an error:
Database Error
  Invalid project ID 'coffee_shop'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
[0m12:00:00.142978 [debug] [MainThread]: Command `dbt docs generate` failed at 12:00:00.142817 after 6.45 seconds
[0m12:00:00.143430 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:00:00.143835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f811519ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8111a51ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8111a50ee0>]}
[0m12:00:00.144305 [debug] [MainThread]: Flushing usage events
[0m12:02:20.007844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe28426ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe282d93f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe282d93eb0>]}


============================== 12:02:20.010416 | a7744479-429f-4afe-b375-0c5f4144f0b5 ==============================
[0m12:02:20.010416 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:02:20.011237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:02:20.361942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7744479-429f-4afe-b375-0c5f4144f0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2812ab970>]}
[0m12:02:20.379730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7744479-429f-4afe-b375-0c5f4144f0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe28127b700>]}
[0m12:02:20.380425 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:02:20.390728 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:02:20.414911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:02:20.415528 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/src_coffee_shop.yml
[0m12:02:20.451892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7744479-429f-4afe-b375-0c5f4144f0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe28109cc10>]}
[0m12:02:20.453512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7744479-429f-4afe-b375-0c5f4144f0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe28123ab60>]}
[0m12:02:20.454002 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m12:02:20.454519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7744479-429f-4afe-b375-0c5f4144f0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe28123abf0>]}
[0m12:02:20.455971 [info ] [MainThread]: 
[0m12:02:20.456857 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:02:20.457910 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m12:02:20.458429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:21.448542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7744479-429f-4afe-b375-0c5f4144f0b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe28123aa40>]}
[0m12:02:21.449582 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:02:21.450130 [info ] [MainThread]: 
[0m12:02:21.455003 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m12:02:21.455775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m12:02:21.456335 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m12:02:21.461913 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m12:02:21.462868 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 12:02:21.456606 => 12:02:21.462588
[0m12:02:21.463299 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m12:02:21.463793 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 12:02:21.463555 => 12:02:21.463573
[0m12:02:21.464804 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m12:02:21.465783 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:02:21.466300 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:02:21.467029 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m12:02:21.467425 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:02:21.467812 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:02:21.468602 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22'
[0m12:02:21.469133 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:02:21.469908 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m12:02:21.470658 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m12:02:21.474919 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:02:21.471115 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:02:21.474495 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:02:21.474005 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m12:02:21.487261 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m12:02:21.495169 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m12:02:21.504180 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m12:02:21.506933 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 12:02:21.495512 => 12:02:21.506636
[0m12:02:21.505949 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 12:02:21.475176 => 12:02:21.505672
[0m12:02:21.508553 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:02:21.509100 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 12:02:21.508836 => 12:02:21.508851
[0m12:02:21.510037 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:02:21.505128 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 12:02:21.471471 => 12:02:21.504889
[0m12:02:21.510624 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:02:21.511128 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 12:02:21.510898 => 12:02:21.510908
[0m12:02:21.512022 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:02:21.507655 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 12:02:21.487631 => 12:02:21.507354
[0m12:02:21.513255 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:02:21.512744 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:02:21.514524 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m12:02:21.508055 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:02:21.514945 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:02:21.513787 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 12:02:21.513579 => 12:02:21.513593
[0m12:02:21.525079 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:02:21.523818 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m12:02:21.515489 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 12:02:21.515262 => 12:02:21.515273
[0m12:02:21.526804 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:02:21.527631 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 12:02:21.515773 => 12:02:21.527379
[0m12:02:21.528247 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:02:21.528809 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 12:02:21.528596 => 12:02:21.528605
[0m12:02:21.529710 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:02:21.531297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:21.531649 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m12:02:21.531994 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m12:02:21.532341 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m12:02:21.532676 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m12:02:21.532995 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m12:02:21.533319 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m12:02:21.534571 [debug] [MainThread]: Command end result
[0m12:02:21.545590 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:02:21.546127 [info ] [MainThread]: Building catalog
[0m12:02:21.547655 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:02:22.266406 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
list dataset
[0m12:02:22.267014 [debug] [MainThread]: BigQuery adapter: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/coffeeshop/datasets?maxResults=10000&prettyPrint=false: Not found: Project coffeeshop
[0m12:02:22.267927 [error] [MainThread]: Encountered an error:
Runtime Error
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/coffeeshop/datasets?maxResults=10000&prettyPrint=false: Not found: Project coffeeshop
[0m12:02:22.268858 [debug] [MainThread]: Command `dbt docs generate` failed at 12:02:22.268734 after 2.27 seconds
[0m12:02:22.269200 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:02:22.269593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe28426ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2787666b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe278764250>]}
[0m12:02:22.270016 [debug] [MainThread]: Flushing usage events
[0m12:03:10.011401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff755872c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7543bff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7543bfee0>]}


============================== 12:03:10.014100 | 0f803c56-cdb0-4091-9162-2d39b5a37f2f ==============================
[0m12:03:10.014100 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:03:10.014834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:03:10.364496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f803c56-cdb0-4091-9162-2d39b5a37f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7528aef80>]}
[0m12:03:10.384396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f803c56-cdb0-4091-9162-2d39b5a37f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7528e5450>]}
[0m12:03:10.385160 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:03:10.399293 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:03:10.423246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:03:10.423868 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/src_coffee_shop.yml
[0m12:03:10.456317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f803c56-cdb0-4091-9162-2d39b5a37f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7526cbfd0>]}
[0m12:03:10.457946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f803c56-cdb0-4091-9162-2d39b5a37f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff752672830>]}
[0m12:03:10.458491 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m12:03:10.459224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f803c56-cdb0-4091-9162-2d39b5a37f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7526728c0>]}
[0m12:03:10.460820 [info ] [MainThread]: 
[0m12:03:10.461814 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:03:10.462933 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m12:03:10.463397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:11.369535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f803c56-cdb0-4091-9162-2d39b5a37f2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff75537dd20>]}
[0m12:03:11.370461 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:03:11.371089 [info ] [MainThread]: 
[0m12:03:11.376301 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m12:03:11.377301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m12:03:11.377782 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m12:03:11.385654 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m12:03:11.386503 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 12:03:11.378054 => 12:03:11.386161
[0m12:03:11.386988 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m12:03:11.387489 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 12:03:11.387251 => 12:03:11.387270
[0m12:03:11.388538 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m12:03:11.389731 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:03:11.390182 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:03:11.393049 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22'
[0m12:03:11.394034 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:03:11.392254 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m12:03:11.406334 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:03:11.391195 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:03:11.405863 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m12:03:11.410871 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 12:03:11.394307 => 12:03:11.410544
[0m12:03:11.390650 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:03:11.410004 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m12:03:11.409065 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m12:03:11.411424 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:03:11.412260 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m12:03:11.412696 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:03:11.413578 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 12:03:11.406608 => 12:03:11.413309
[0m12:03:11.422113 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:03:11.414560 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:03:11.421172 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m12:03:11.422714 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 12:03:11.422493 => 12:03:11.422504
[0m12:03:11.433219 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:03:11.431847 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m12:03:11.414125 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 12:03:11.413916 => 12:03:11.413929
[0m12:03:11.434062 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 12:03:11.414850 => 12:03:11.433767
[0m12:03:11.434824 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:03:11.435954 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:03:11.436568 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:03:11.437362 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 12:03:11.422996 => 12:03:11.437071
[0m12:03:11.438258 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m12:03:11.439033 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 12:03:11.438781 => 12:03:11.438791
[0m12:03:11.440983 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:03:11.440002 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:03:11.439503 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:03:11.447776 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 12:03:11.447371 => 12:03:11.447388
[0m12:03:11.453072 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m12:03:11.454355 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:03:11.455608 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 12:03:11.441457 => 12:03:11.455305
[0m12:03:11.456085 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:03:11.456663 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 12:03:11.456449 => 12:03:11.456457
[0m12:03:11.457581 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:03:11.458807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:11.459175 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m12:03:11.459467 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m12:03:11.460006 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m12:03:11.460387 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m12:03:11.460676 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m12:03:11.460942 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m12:03:11.462128 [debug] [MainThread]: Command end result
[0m12:03:11.477186 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:03:11.477527 [info ] [MainThread]: Building catalog
[0m12:03:11.478698 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:03:11.935098 [debug] [MainThread]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("GET https://bigquery.googleapis.com/bigquery/v2/projects/coffee_shop/datasets?maxResults=10000&prettyPrint=false: Invalid project ID 'coffee_shop'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m12:03:12.342514 [error] [MainThread]: Encountered an error:
Database Error
  Invalid project ID 'coffee_shop'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
[0m12:03:12.343625 [debug] [MainThread]: Command `dbt docs generate` failed at 12:03:12.343472 after 2.34 seconds
[0m12:03:12.344011 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:03:12.344468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff755872c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff751dc7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff751dc6590>]}
[0m12:03:12.344895 [debug] [MainThread]: Flushing usage events
[0m12:06:54.700057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704e6eec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704d1bff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704d1bfee0>]}


============================== 12:06:54.702633 | bb3e8240-140c-4cda-aa04-1c694d09befa ==============================
[0m12:06:54.702633 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:06:54.703411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:06:55.026240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb3e8240-140c-4cda-aa04-1c694d09befa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704b6b1ab0>]}
[0m12:06:55.043997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb3e8240-140c-4cda-aa04-1c694d09befa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704b6e54b0>]}
[0m12:06:55.044782 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:06:55.057517 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:06:55.069346 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading coffee_shop: staging/coffee_shop/src_coffee_shop.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | sources:
    4  |   - name: analytics-engineers-club
    5  |     database: analytics-engineers-club: coffee_shop
    6  |     tables:
    7  |       - name: customers
    8  |       - name: orders
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 39
[0m12:06:55.070284 [debug] [MainThread]: Command `dbt docs generate` failed at 12:06:55.070158 after 0.38 seconds
[0m12:06:55.070679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704e6eec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704b460a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f704b4607c0>]}
[0m12:06:55.071095 [debug] [MainThread]: Flushing usage events
[0m12:07:30.257152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ef912c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ee3bfee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ee3bfe80>]}


============================== 12:07:30.259753 | b9322bf5-470c-4da6-9a00-e3215243a00c ==============================
[0m12:07:30.259753 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:07:30.260501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:07:30.579076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9322bf5-470c-4da6-9a00-e3215243a00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ec8db9a0>]}
[0m12:07:30.599295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9322bf5-470c-4da6-9a00-e3215243a00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ec8ab520>]}
[0m12:07:30.600021 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:07:30.610404 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:07:30.634428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:07:30.634817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:07:30.640475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9322bf5-470c-4da6-9a00-e3215243a00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ec6a40d0>]}
[0m12:07:30.642286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9322bf5-470c-4da6-9a00-e3215243a00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ec66ea10>]}
[0m12:07:30.642782 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m12:07:30.643281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9322bf5-470c-4da6-9a00-e3215243a00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ec66eaa0>]}
[0m12:07:30.644776 [info ] [MainThread]: 
[0m12:07:30.645965 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:07:30.647052 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m12:07:30.647523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:31.700829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9322bf5-470c-4da6-9a00-e3215243a00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ec66e8f0>]}
[0m12:07:31.701743 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:07:31.702287 [info ] [MainThread]: 
[0m12:07:31.706287 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m12:07:31.706956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m12:07:31.707363 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m12:07:31.710687 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m12:07:31.711767 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 12:07:31.707617 => 12:07:31.711531
[0m12:07:31.712210 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m12:07:31.712870 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 12:07:31.712559 => 12:07:31.712579
[0m12:07:31.713862 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m12:07:31.714807 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:07:31.716694 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m12:07:31.717109 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:07:31.715586 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:07:31.715917 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:07:31.723945 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m12:07:31.724396 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:07:31.715225 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:07:31.735556 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22'
[0m12:07:31.723171 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m12:07:31.736906 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:07:31.736359 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:07:31.734475 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m12:07:31.722326 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m12:07:31.747245 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m12:07:31.755028 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m12:07:31.756309 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 12:07:31.717363 => 12:07:31.756003
[0m12:07:31.756735 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 12:07:31.724650 => 12:07:31.756543
[0m12:07:31.757560 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 12:07:31.737247 => 12:07:31.757254
[0m12:07:31.758221 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:07:31.758779 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:07:31.759312 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:07:31.760009 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 12:07:31.759762 => 12:07:31.759777
[0m12:07:31.760586 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 12:07:31.747586 => 12:07:31.760363
[0m12:07:31.761007 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 12:07:31.760810 => 12:07:31.760824
[0m12:07:31.761492 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 12:07:31.761265 => 12:07:31.761276
[0m12:07:31.762374 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:07:31.762842 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:07:31.763717 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:07:31.764633 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:07:31.765447 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:07:31.765933 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 12:07:31.765722 => 12:07:31.765733
[0m12:07:31.767870 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m12:07:31.768876 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:07:31.769336 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:07:31.779328 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m12:07:31.780173 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 12:07:31.769833 => 12:07:31.779828
[0m12:07:31.780658 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:07:31.781151 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 12:07:31.780914 => 12:07:31.780926
[0m12:07:31.782027 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:07:31.783238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:31.783563 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m12:07:31.783839 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m12:07:31.784111 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m12:07:31.784439 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m12:07:31.784731 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m12:07:31.785029 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m12:07:31.786268 [debug] [MainThread]: Command end result
[0m12:07:31.796015 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:07:31.796569 [info ] [MainThread]: Building catalog
[0m12:07:31.798121 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:32.240942 [debug] [MainThread]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("GET https://bigquery.googleapis.com/bigquery/v2/projects/coffee_shop/datasets?maxResults=10000&prettyPrint=false: Invalid project ID 'coffee_shop'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m12:07:32.752982 [error] [MainThread]: Encountered an error:
Database Error
  Invalid project ID 'coffee_shop'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
[0m12:07:32.754118 [debug] [MainThread]: Command `dbt docs generate` failed at 12:07:32.753960 after 2.50 seconds
[0m12:07:32.754502 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:07:32.754921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24ef912c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e857e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e857d750>]}
[0m12:07:32.755352 [debug] [MainThread]: Flushing usage events
[0m12:07:51.750191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2d0c16bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2cf6b7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2cf6b7e50>]}


============================== 12:07:51.752819 | 841f76ec-30b9-4dce-af7c-fa3e3e088acc ==============================
[0m12:07:51.752819 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:07:51.753579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:07:52.120940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '841f76ec-30b9-4dce-af7c-fa3e3e088acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2cdbd3be0>]}
[0m12:07:52.138601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '841f76ec-30b9-4dce-af7c-fa3e3e088acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2cdba2f20>]}
[0m12:07:52.139328 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:07:52.150035 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:07:52.174816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:52.175432 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/src_coffee_shop.yml
[0m12:07:52.205620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '841f76ec-30b9-4dce-af7c-fa3e3e088acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2cd9c4ca0>]}
[0m12:07:52.207144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '841f76ec-30b9-4dce-af7c-fa3e3e088acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2cd966bf0>]}
[0m12:07:52.207663 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m12:07:52.208199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '841f76ec-30b9-4dce-af7c-fa3e3e088acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2cd966c80>]}
[0m12:07:52.209663 [info ] [MainThread]: 
[0m12:07:52.210540 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:07:52.211612 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m12:07:52.212090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:53.156264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '841f76ec-30b9-4dce-af7c-fa3e3e088acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2cd966ad0>]}
[0m12:07:53.157206 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:07:53.157760 [info ] [MainThread]: 
[0m12:07:53.162792 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m12:07:53.163512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m12:07:53.164040 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m12:07:53.171144 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m12:07:53.172536 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 12:07:53.164472 => 12:07:53.172187
[0m12:07:53.172986 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m12:07:53.173495 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 12:07:53.173252 => 12:07:53.173271
[0m12:07:53.174535 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m12:07:53.175520 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:07:53.178193 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m12:07:53.178699 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:07:53.175946 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:07:53.183078 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22'
[0m12:07:53.183507 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:07:53.177047 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:07:53.196252 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m12:07:53.196673 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:07:53.195357 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m12:07:53.176453 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:07:53.182226 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m12:07:53.203309 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m12:07:53.204369 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m12:07:53.205208 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 12:07:53.183767 => 12:07:53.204880
[0m12:07:53.206367 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 12:07:53.178981 => 12:07:53.206024
[0m12:07:53.206778 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:07:53.207506 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 12:07:53.196929 => 12:07:53.207173
[0m12:07:53.207883 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:07:53.208350 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:07:53.217213 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m12:07:53.217747 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:07:53.219961 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 12:07:53.219745 => 12:07:53.219754
[0m12:07:53.218978 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 12:07:53.218681 => 12:07:53.218694
[0m12:07:53.218363 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 12:07:53.218114 => 12:07:53.218142
[0m12:07:53.220775 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 12:07:53.208646 => 12:07:53.220467
[0m12:07:53.221627 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:07:53.222568 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:07:53.223512 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:07:53.223965 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:07:53.224862 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:07:53.225663 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 12:07:53.225419 => 12:07:53.225430
[0m12:07:53.226448 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m12:07:53.227384 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:07:53.227831 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:07:53.237158 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m12:07:53.238834 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 12:07:53.228269 => 12:07:53.238490
[0m12:07:53.239521 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:07:53.240360 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 12:07:53.240016 => 12:07:53.240029
[0m12:07:53.241685 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:07:53.243329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:53.243799 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m12:07:53.244275 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m12:07:53.244731 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m12:07:53.245176 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m12:07:53.245635 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m12:07:53.246071 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m12:07:53.248777 [debug] [MainThread]: Command end result
[0m12:07:53.266204 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:07:53.266782 [info ] [MainThread]: Building catalog
[0m12:07:53.268474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:53.675924 [debug] [MainThread]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("GET https://bigquery.googleapis.com/bigquery/v2/projects/coffee_shop_/datasets?maxResults=10000&prettyPrint=false: Invalid project ID 'coffee_shop_'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m12:07:53.873101 [error] [MainThread]: Encountered an error:
Database Error
  Invalid project ID 'coffee_shop_'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
[0m12:07:53.874257 [debug] [MainThread]: Command `dbt docs generate` failed at 12:07:53.874099 after 2.13 seconds
[0m12:07:53.874670 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:07:53.875086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2d0c16bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2cd0bb280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2cd0ba890>]}
[0m12:07:53.875523 [debug] [MainThread]: Flushing usage events
[0m12:10:57.198589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56479ab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5634d3e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5634d3dc0>]}


============================== 12:10:57.201130 | 9648bcde-66c9-497f-9e5f-ac39b1e92cc1 ==============================
[0m12:10:57.201130 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:10:57.201888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:10:57.531809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9648bcde-66c9-497f-9e5f-ac39b1e92cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5619ef880>]}
[0m12:10:57.552438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9648bcde-66c9-497f-9e5f-ac39b1e92cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5619c3880>]}
[0m12:10:57.553162 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:10:57.563354 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:10:57.587732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:10:57.588378 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/src_coffee_shop.yml
[0m12:10:57.625538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9648bcde-66c9-497f-9e5f-ac39b1e92cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5617eca30>]}
[0m12:10:57.627102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9648bcde-66c9-497f-9e5f-ac39b1e92cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe561782980>]}
[0m12:10:57.627640 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m12:10:57.628176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9648bcde-66c9-497f-9e5f-ac39b1e92cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe561782a10>]}
[0m12:10:57.629656 [info ] [MainThread]: 
[0m12:10:57.630524 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:10:57.631602 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m12:10:57.632077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:58.590795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9648bcde-66c9-497f-9e5f-ac39b1e92cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5617b55a0>]}
[0m12:10:58.591687 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:10:58.592333 [info ] [MainThread]: 
[0m12:10:58.596878 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m12:10:58.597568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m12:10:58.597994 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m12:10:58.603812 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m12:10:58.605003 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 12:10:58.598245 => 12:10:58.604718
[0m12:10:58.605467 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m12:10:58.606014 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 12:10:58.605799 => 12:10:58.605815
[0m12:10:58.607080 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m12:10:58.608026 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:10:58.609973 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m12:10:58.610395 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:10:58.608852 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:10:58.613928 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m12:10:58.613118 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m12:10:58.609201 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:10:58.614341 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:10:58.608489 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:10:58.615358 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m12:10:58.630373 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:10:58.615899 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 12:10:58.610640 => 12:10:58.615610
[0m12:10:58.637379 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:10:58.629036 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m12:10:58.636824 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m12:10:58.629906 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22'
[0m12:10:58.637954 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 12:10:58.637735 => 12:10:58.637748
[0m12:10:58.638726 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 12:10:58.616261 => 12:10:58.638413
[0m12:10:58.639502 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:10:58.640299 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 12:10:58.630637 => 12:10:58.639969
[0m12:10:58.641175 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:10:58.641621 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:10:58.649483 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m12:10:58.650028 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:10:58.650837 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:10:58.651321 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 12:10:58.651109 => 12:10:58.651121
[0m12:10:58.652188 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 12:10:58.641908 => 12:10:58.651846
[0m12:10:58.652783 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 12:10:58.652543 => 12:10:58.652554
[0m12:10:58.653701 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m12:10:58.654681 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m12:10:58.655135 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:10:58.657278 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 12:10:58.657027 => 12:10:58.657037
[0m12:10:58.656537 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:10:58.656059 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m12:10:58.658148 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m12:10:58.666714 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m12:10:58.667901 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 12:10:58.658436 => 12:10:58.667563
[0m12:10:58.668767 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:10:58.669304 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 12:10:58.669060 => 12:10:58.669071
[0m12:10:58.670223 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m12:10:58.671485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:58.671820 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m12:10:58.672130 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m12:10:58.672455 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m12:10:58.672765 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m12:10:58.673065 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m12:10:58.673365 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m12:10:58.674609 [debug] [MainThread]: Command end result
[0m12:10:58.684354 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m12:10:58.684808 [info ] [MainThread]: Building catalog
[0m12:10:58.686243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:59.171731 [debug] [MainThread]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest("GET https://bigquery.googleapis.com/bigquery/v2/projects/coffee_shop/datasets?maxResults=10000&prettyPrint=false: Invalid project ID 'coffee_shop'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.")
[0m12:10:59.775575 [error] [MainThread]: Encountered an error:
Database Error
  Invalid project ID 'coffee_shop'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
[0m12:10:59.776822 [debug] [MainThread]: Command `dbt docs generate` failed at 12:10:59.776661 after 2.59 seconds
[0m12:10:59.777216 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:10:59.777618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56479ab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe560f04ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe560f07b50>]}
[0m12:10:59.778048 [debug] [MainThread]: Flushing usage events
[0m13:09:37.285220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f077a45ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0778fb7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0778fb7e50>]}


============================== 13:09:37.298956 | 3a2cf703-df74-4192-8dbf-db1c10c2420c ==============================
[0m13:09:37.298956 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:09:37.299846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:09:38.604703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a2cf703-df74-4192-8dbf-db1c10c2420c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07774d3ca0>]}
[0m13:09:38.622697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a2cf703-df74-4192-8dbf-db1c10c2420c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07774a3400>]}
[0m13:09:38.623871 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:09:38.639988 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:09:38.711654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:09:38.712584 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/src_coffee_shop.yml
[0m13:09:38.746617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a2cf703-df74-4192-8dbf-db1c10c2420c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07772c4d60>]}
[0m13:09:38.748906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a2cf703-df74-4192-8dbf-db1c10c2420c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f077726acb0>]}
[0m13:09:38.749583 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m13:09:38.750188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a2cf703-df74-4192-8dbf-db1c10c2420c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f077726ad40>]}
[0m13:09:38.752427 [info ] [MainThread]: 
[0m13:09:38.754011 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:09:38.755660 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:09:38.756171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:42.701981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a2cf703-df74-4192-8dbf-db1c10c2420c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f077726ab90>]}
[0m13:09:42.703473 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:09:42.704463 [info ] [MainThread]: 
[0m13:09:42.718648 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m13:09:42.719661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m13:09:42.720631 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m13:09:42.727685 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m13:09:42.728623 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 13:09:42.721177 => 13:09:42.728276
[0m13:09:42.729252 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m13:09:42.729829 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 13:09:42.729553 => 13:09:42.729579
[0m13:09:42.730978 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m13:09:42.732054 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:09:42.732519 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:09:42.735182 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22'
[0m13:09:42.733499 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:09:42.734291 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m13:09:42.737004 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:09:42.740236 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m13:09:42.736507 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m13:09:42.733054 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:09:42.735653 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:09:42.740984 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:09:42.741633 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 13:09:42.737362 => 13:09:42.741351
[0m13:09:42.742513 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m13:09:42.763381 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:09:42.762235 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m13:09:42.762846 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:09:42.755026 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m13:09:42.772973 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m13:09:42.773993 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 13:09:42.773579 => 13:09:42.773603
[0m13:09:42.775022 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 13:09:42.742850 => 13:09:42.774667
[0m13:09:42.775727 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 13:09:42.755499 => 13:09:42.775486
[0m13:09:42.776721 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 13:09:42.763687 => 13:09:42.776365
[0m13:09:42.777710 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:09:42.778272 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:09:42.779189 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:09:42.779739 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:09:42.782990 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 13:09:42.782666 => 13:09:42.782678
[0m13:09:42.781538 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 13:09:42.780989 => 13:09:42.781005
[0m13:09:42.782270 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 13:09:42.782003 => 13:09:42.782017
[0m13:09:42.780703 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:09:42.784189 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:09:42.785229 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:09:42.786256 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:09:42.787136 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m13:09:42.788249 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:09:42.797284 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m13:09:42.798236 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 13:09:42.788552 => 13:09:42.797880
[0m13:09:42.798737 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:09:42.799314 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 13:09:42.799039 => 13:09:42.799051
[0m13:09:42.800303 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:09:42.801993 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:42.802404 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m13:09:42.802800 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m13:09:42.803192 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m13:09:42.803586 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m13:09:42.803985 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m13:09:42.804383 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m13:09:42.805850 [debug] [MainThread]: Command end result
[0m13:09:42.849771 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m13:09:42.850405 [info ] [MainThread]: Building catalog
[0m13:09:42.852139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:09:43.320493 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m13:09:43.322728 [debug] [ThreadPool]: Acquiring new bigquery connection 'analytics-engineers-club.information_schema'
[0m13:09:43.338673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:43.341518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:43.342422 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_marcel`.__TABLES__
        where (upper(dataset_id) = upper('dbt_marcel'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m13:09:43.343594 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m13:09:46.088281 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4ddcb192-8972-44f3-8d57-9bef264a4301&page=queryresults
[0m13:09:46.307244 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:83690d60-199a-467d-b0a9-c0f38111e9cb&page=queryresults
[0m13:09:46.336247 [info ] [MainThread]: Catalog written to /workspaces/aec-self-study-marcel/coffee_shop_marcel/target/catalog.json
[0m13:09:46.337606 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:09:46.337423 after 9.07 seconds
[0m13:09:46.338062 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:09:46.338447 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m13:09:46.338830 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.
[0m13:09:46.339292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f077a45ebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f077b887bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07769a21d0>]}
[0m13:09:46.339795 [debug] [MainThread]: Flushing usage events
[0m13:10:16.518948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac5682bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac43cfdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac43cfc40>]}


============================== 13:10:16.521925 | 0a58ba98-8f27-48df-bab6-a7f26ad614b3 ==============================
[0m13:10:16.521925 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:10:16.522898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:10:16.911426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a58ba98-8f27-48df-bab6-a7f26ad614b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac28e7a00>]}
[0m13:10:16.929289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a58ba98-8f27-48df-bab6-a7f26ad614b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac28b3760>]}
[0m13:16:02.963005 [error] [MainThread]: Encountered an error:

[0m13:16:02.984974 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 299, in docs_serve
    results = task.run()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 237, in serve_forever
    self._handle_request_noblock()
  File "/usr/lib/python3.10/socketserver.py", line 316, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/lib/python3.10/socketserver.py", line 347, in process_request
    self.finish_request(request, client_address)
  File "/usr/lib/python3.10/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/lib/python3.10/http/server.py", line 658, in __init__
    super().__init__(*args, **kwargs)
  File "/usr/lib/python3.10/socketserver.py", line 747, in __init__
    self.handle()
  File "/usr/lib/python3.10/http/server.py", line 432, in handle
    self.handle_one_request()
  File "/usr/lib/python3.10/http/server.py", line 400, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
KeyboardInterrupt

[0m13:16:02.986530 [debug] [MainThread]: Command `dbt docs serve` failed at 13:16:02.986353 after 346.48 seconds
[0m13:16:02.987039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac5682bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac28ce5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ac28cd8d0>]}
[0m13:16:02.987594 [debug] [MainThread]: Flushing usage events
[0m13:16:09.244342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37305eac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372f0c3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372f0c3e80>]}


============================== 13:16:09.247421 | 810c4f73-8d25-4771-b48c-4984ca3616b2 ==============================
[0m13:16:09.247421 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:16:09.248376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:16:09.619016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '810c4f73-8d25-4771-b48c-4984ca3616b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372d5df940>]}
[0m13:16:09.636741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '810c4f73-8d25-4771-b48c-4984ca3616b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372d5af5b0>]}
[0m13:16:09.637892 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:16:09.650451 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:16:09.684947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:09.685884 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/src_coffee_shop.yml
[0m13:16:09.719578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '810c4f73-8d25-4771-b48c-4984ca3616b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372d3d0b50>]}
[0m13:16:09.721771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '810c4f73-8d25-4771-b48c-4984ca3616b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372d376b30>]}
[0m13:16:09.722556 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m13:16:09.723119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '810c4f73-8d25-4771-b48c-4984ca3616b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372d374460>]}
[0m13:16:09.724888 [info ] [MainThread]: 
[0m13:16:09.725890 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:16:09.727146 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:16:09.727658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:10.789085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '810c4f73-8d25-4771-b48c-4984ca3616b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372d374490>]}
[0m13:16:10.790291 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:16:10.790888 [info ] [MainThread]: 
[0m13:16:10.796702 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m13:16:10.798810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m13:16:10.799356 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m13:16:10.807410 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m13:16:10.809175 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 13:16:10.799699 => 13:16:10.808744
[0m13:16:10.809782 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m13:16:10.810360 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 13:16:10.810084 => 13:16:10.810109
[0m13:16:10.811522 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m13:16:10.812591 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:16:10.813617 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m13:16:10.814045 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:16:10.817286 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m13:16:10.817759 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:16:10.819686 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22'
[0m13:16:10.818577 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:16:10.820165 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:16:10.818171 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:16:10.821485 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m13:16:10.827377 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 13:16:10.814327 => 13:16:10.827128
[0m13:16:10.836654 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:16:10.835634 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m13:16:10.836156 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:16:10.837242 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 13:16:10.836954 => 13:16:10.836971
[0m13:16:10.834707 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m13:16:10.837727 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:16:10.844643 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m13:16:10.845759 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:16:10.846700 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 13:16:10.821902 => 13:16:10.846353
[0m13:16:10.856155 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m13:16:10.857404 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:16:10.858084 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:16:10.858562 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 13:16:10.838051 => 13:16:10.858344
[0m13:16:10.859612 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m13:16:10.862035 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:16:10.860987 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 13:16:10.860767 => 13:16:10.860779
[0m13:16:10.872717 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:16:10.860446 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 13:16:10.847076 => 13:16:10.860106
[0m13:16:10.871582 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m13:16:10.861538 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:16:10.875133 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 13:16:10.874889 => 13:16:10.874904
[0m13:16:10.874504 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 13:16:10.862366 => 13:16:10.874147
[0m13:16:10.873529 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:16:10.876162 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:16:10.876669 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:16:10.877356 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 13:16:10.877112 => 13:16:10.877125
[0m13:16:10.879251 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:16:10.878249 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 13:16:10.877997 => 13:16:10.878010
[0m13:16:10.880428 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:16:10.882127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:10.882541 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m13:16:10.882975 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m13:16:10.883373 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m13:16:10.883773 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m13:16:10.884232 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m13:16:10.884621 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m13:16:10.886112 [debug] [MainThread]: Command end result
[0m13:16:10.897926 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m13:16:10.898365 [info ] [MainThread]: Building catalog
[0m13:16:10.899590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:16:11.401804 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m13:16:11.413951 [debug] [ThreadPool]: Acquiring new bigquery connection 'analytics-engineers-club.information_schema'
[0m13:16:11.420836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:11.423550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:11.424931 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_marcel`.__TABLES__
        where (upper(dataset_id) = upper('dbt_marcel'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m13:16:11.426425 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m13:16:14.051211 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f3539e27-fe08-4aed-bd58-ffe787a7cbab&page=queryresults
[0m13:16:14.301848 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:939169be-190f-4b08-bb75-31d8a3e87503&page=queryresults
[0m13:16:14.330233 [info ] [MainThread]: Catalog written to /workspaces/aec-self-study-marcel/coffee_shop_marcel/target/catalog.json
[0m13:16:14.333179 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:16:14.332830 after 5.10 seconds
[0m13:16:14.334001 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:16:14.334756 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m13:16:14.335471 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.
[0m13:16:14.337924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37305eac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372d5af700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372caa17b0>]}
[0m13:16:14.338798 [debug] [MainThread]: Flushing usage events
[0m13:16:27.047152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cf3e6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cdec3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cdec3c40>]}


============================== 13:16:27.050045 | 1a3389d6-a85c-44e6-9f84-6cc09fdbeb06 ==============================
[0m13:16:27.050045 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:16:27.050899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:16:27.421712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a3389d6-a85c-44e6-9f84-6cc09fdbeb06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cc3dbaf0>]}
[0m13:16:27.439474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a3389d6-a85c-44e6-9f84-6cc09fdbeb06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cc3a7760>]}
[0m13:16:27.645429 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m13:16:27.646970 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 299, in docs_serve
    results = task.run()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
  File "/usr/lib/python3.10/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/lib/python3.10/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m13:16:27.648050 [debug] [MainThread]: Command `dbt docs serve` failed at 13:16:27.647907 after 0.61 seconds
[0m13:16:27.648511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cf3e6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cc3c2dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6cc3c2cb0>]}
[0m13:16:27.649008 [debug] [MainThread]: Flushing usage events
[0m13:17:01.025627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaddd7ac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadc897f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadc897ee0>]}


============================== 13:17:01.028600 | 0b6ae464-65a7-4d5f-93c2-67e679216f6f ==============================
[0m13:17:01.028600 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:17:01.029483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:17:01.423670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b6ae464-65a7-4d5f-93c2-67e679216f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadad81b70>]}
[0m13:17:01.441321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b6ae464-65a7-4d5f-93c2-67e679216f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadadb9480>]}
[0m13:17:01.442385 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:17:01.454791 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:17:01.482079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:01.482593 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:01.489201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b6ae464-65a7-4d5f-93c2-67e679216f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadab780d0>]}
[0m13:17:01.491033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b6ae464-65a7-4d5f-93c2-67e679216f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadad42800>]}
[0m13:17:01.491567 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m13:17:01.492128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b6ae464-65a7-4d5f-93c2-67e679216f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadad42890>]}
[0m13:17:01.493918 [info ] [MainThread]: 
[0m13:17:01.494895 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:17:01.496141 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:17:01.496668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:02.696684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b6ae464-65a7-4d5f-93c2-67e679216f6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadad426e0>]}
[0m13:17:02.697914 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:17:02.698530 [info ] [MainThread]: 
[0m13:17:02.703516 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m13:17:02.704430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m13:17:02.704936 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m13:17:02.708681 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m13:17:02.709616 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 13:17:02.705277 => 13:17:02.709267
[0m13:17:02.710157 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m13:17:02.710772 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 13:17:02.710454 => 13:17:02.710480
[0m13:17:02.712123 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m13:17:02.713200 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:17:02.713669 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:17:02.716358 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22'
[0m13:17:02.714645 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:17:02.715454 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m13:17:02.714199 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:17:02.719116 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m13:17:02.719592 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:17:02.718238 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:17:02.717748 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m13:17:02.716843 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:17:02.749962 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m13:17:02.737221 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m13:17:02.737791 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:17:02.734162 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m13:17:02.763384 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 13:17:02.734552 => 13:17:02.762942
[0m13:17:02.765552 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:17:02.766493 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 13:17:02.766120 => 13:17:02.766147
[0m13:17:02.768134 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:17:02.764716 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 13:17:02.719933 => 13:17:02.764334
[0m13:17:02.770027 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:17:02.770805 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 13:17:02.770473 => 13:17:02.770488
[0m13:17:02.772522 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:17:02.769418 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:17:02.777421 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m13:17:02.778208 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:17:02.751966 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 13:17:02.738135 => 13:17:02.751555
[0m13:17:02.784289 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:17:02.785227 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 13:17:02.784854 => 13:17:02.784870
[0m13:17:02.775006 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m13:17:02.788217 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 13:17:02.753016 => 13:17:02.787880
[0m13:17:02.788837 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:17:02.789675 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 13:17:02.789325 => 13:17:02.789339
[0m13:17:02.791120 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:17:02.787161 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:17:02.800145 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m13:17:02.801259 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 13:17:02.778772 => 13:17:02.800831
[0m13:17:02.802029 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:17:02.802867 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 13:17:02.802477 => 13:17:02.802494
[0m13:17:02.803874 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:17:02.805387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:02.805808 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m13:17:02.806807 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m13:17:02.807320 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m13:17:02.807842 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m13:17:02.808369 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m13:17:02.808892 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m13:17:02.810920 [debug] [MainThread]: Command end result
[0m13:17:02.821337 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m13:17:02.821852 [info ] [MainThread]: Building catalog
[0m13:17:02.823826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:17:03.332101 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m13:17:03.333430 [debug] [ThreadPool]: Acquiring new bigquery connection 'analytics-engineers-club.information_schema'
[0m13:17:03.362967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:03.364835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:03.365792 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_marcel`.__TABLES__
        where (upper(dataset_id) = upper('dbt_marcel'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m13:17:03.366975 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m13:17:05.777885 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b8ef7f89-33b6-42f5-b138-d8c54119e7ca&page=queryresults
[0m13:17:05.944965 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7a74ef18-9182-403a-8041-66ad3d46affd&page=queryresults
[0m13:17:05.974973 [info ] [MainThread]: Catalog written to /workspaces/aec-self-study-marcel/coffee_shop_marcel/target/catalog.json
[0m13:17:05.976308 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:17:05.976142 after 4.96 seconds
[0m13:17:05.976744 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:17:05.977135 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m13:17:05.977512 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.
[0m13:17:05.977975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaddd7ac80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaddb01f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feadab69ab0>]}
[0m13:17:05.978464 [debug] [MainThread]: Flushing usage events
[0m13:17:11.225643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ed8b2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ec3bfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ec3bfc10>]}


============================== 13:17:11.228623 | 784dfb7a-cc50-4967-a6f2-6397ea05aac4 ==============================
[0m13:17:11.228623 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:17:11.229521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:17:11.619901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '784dfb7a-cc50-4967-a6f2-6397ea05aac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ea8d7850>]}
[0m13:17:11.637462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '784dfb7a-cc50-4967-a6f2-6397ea05aac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ea8a7850>]}
[0m13:18:31.777797 [error] [MainThread]: Encountered an error:

[0m13:18:31.782547 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 299, in docs_serve
    results = task.run()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 237, in serve_forever
    self._handle_request_noblock()
  File "/usr/lib/python3.10/socketserver.py", line 316, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/lib/python3.10/socketserver.py", line 347, in process_request
    self.finish_request(request, client_address)
  File "/usr/lib/python3.10/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/lib/python3.10/http/server.py", line 658, in __init__
    super().__init__(*args, **kwargs)
  File "/usr/lib/python3.10/socketserver.py", line 747, in __init__
    self.handle()
  File "/usr/lib/python3.10/http/server.py", line 432, in handle
    self.handle_one_request()
  File "/usr/lib/python3.10/http/server.py", line 400, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
KeyboardInterrupt

[0m13:18:31.785080 [debug] [MainThread]: Command `dbt docs serve` failed at 13:18:31.784757 after 80.57 seconds
[0m13:18:31.785961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ed8b2bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ea8a7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ea8c2290>]}
[0m13:18:31.786517 [debug] [MainThread]: Flushing usage events
[0m13:18:38.352895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26109aebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260f4b7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260f4b7e50>]}


============================== 13:18:38.355880 | c0abed61-c365-418e-97d4-a63a95b7317e ==============================
[0m13:18:38.355880 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:18:38.356793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:18:38.769536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0abed61-c365-418e-97d4-a63a95b7317e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260d9d3d30>]}
[0m13:18:38.787077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0abed61-c365-418e-97d4-a63a95b7317e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260d9a1b10>]}
[0m13:18:38.788012 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:18:38.799756 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:18:38.832375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:18:38.833290 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/src_coffee_shop.yml
[0m13:18:38.869120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0abed61-c365-418e-97d4-a63a95b7317e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260d7c4df0>]}
[0m13:18:38.871196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0abed61-c365-418e-97d4-a63a95b7317e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260d76ad40>]}
[0m13:18:38.871824 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m13:18:38.872432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0abed61-c365-418e-97d4-a63a95b7317e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260d76add0>]}
[0m13:18:38.874247 [info ] [MainThread]: 
[0m13:18:38.875240 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:18:38.876491 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:18:38.877006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:39.864612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0abed61-c365-418e-97d4-a63a95b7317e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260d76ac20>]}
[0m13:18:39.866039 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:18:39.866743 [info ] [MainThread]: 
[0m13:18:39.879834 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m13:18:39.880786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m13:18:39.881794 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m13:18:39.888992 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m13:18:39.892102 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 13:18:39.882122 => 13:18:39.891592
[0m13:18:39.894801 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m13:18:39.897815 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 13:18:39.897425 => 13:18:39.897455
[0m13:18:39.899973 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m13:18:39.903164 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:18:39.906392 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m13:18:39.908147 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:18:39.905011 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:18:39.913578 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m13:18:39.914423 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:18:39.907530 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:18:39.904184 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:18:39.924179 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22'
[0m13:18:39.924693 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:18:39.912201 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m13:18:39.923067 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m13:18:39.949518 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:18:39.948774 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 13:18:39.908595 => 13:18:39.948332
[0m13:18:39.967972 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:18:39.965665 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m13:18:39.967423 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m13:18:39.968566 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 13:18:39.968287 => 13:18:39.968310
[0m13:18:39.962404 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m13:18:39.969691 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 13:18:39.949990 => 13:18:39.969328
[0m13:18:39.971017 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:18:39.971802 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 13:18:39.915009 => 13:18:39.971441
[0m13:18:39.974058 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:18:39.973518 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:18:39.972430 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:18:39.974547 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 13:18:39.925031 => 13:18:39.974323
[0m13:18:39.975117 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 13:18:39.974864 => 13:18:39.974881
[0m13:18:39.975979 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m13:18:39.978679 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:18:39.976600 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 13:18:39.976352 => 13:18:39.976366
[0m13:18:39.978195 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:18:39.988064 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m13:18:39.977099 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:18:39.989195 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:18:39.990387 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 13:18:39.978982 => 13:18:39.990025
[0m13:18:39.990979 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 13:18:39.990743 => 13:18:39.990754
[0m13:18:39.992752 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:18:39.991687 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:18:39.993603 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 13:18:39.993353 => 13:18:39.993366
[0m13:18:39.994609 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:18:39.996248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:39.996611 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m13:18:39.996946 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m13:18:39.997346 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m13:18:39.997681 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m13:18:39.998005 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m13:18:39.998329 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m13:18:39.999640 [debug] [MainThread]: Command end result
[0m13:18:40.012363 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m13:18:40.012829 [info ] [MainThread]: Building catalog
[0m13:18:40.014081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:40.473363 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m13:18:40.474475 [debug] [ThreadPool]: Acquiring new bigquery connection 'analytics-engineers-club.information_schema'
[0m13:18:40.510028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:40.511666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:40.512594 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m13:18:40.513775 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_marcel`.__TABLES__
        where (upper(dataset_id) = upper('dbt_marcel'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m13:18:42.996896 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:48561408-27cf-4bf6-8889-60e87fe9e66b&page=queryresults
[0m13:18:43.029960 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:45a6cc4d-1465-4e49-89b8-86d5fc9ea2b5&page=queryresults
[0m13:18:43.057190 [info ] [MainThread]: Catalog written to /workspaces/aec-self-study-marcel/coffee_shop_marcel/target/catalog.json
[0m13:18:43.058530 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:18:43.058365 after 4.71 seconds
[0m13:18:43.059001 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:18:43.059432 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m13:18:43.059837 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.
[0m13:18:43.060300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26109aebf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260d9a1b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f260ce66200>]}
[0m13:18:43.060810 [debug] [MainThread]: Flushing usage events
[0m13:19:04.256727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22943eab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2292eb7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2292eb7df0>]}


============================== 13:19:04.259763 | 6c3d8da6-18f6-4f70-b203-65493ee38f35 ==============================
[0m13:19:04.259763 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:19:04.260603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:19:04.646508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c3d8da6-18f6-4f70-b203-65493ee38f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22913b3220>]}
[0m13:19:04.665310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c3d8da6-18f6-4f70-b203-65493ee38f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22913df0a0>]}
[0m13:19:04.666476 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:19:04.678865 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:19:04.706502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:04.707355 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/src_coffee_shop.yml
[0m13:19:04.740054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c3d8da6-18f6-4f70-b203-65493ee38f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22911c8430>]}
[0m13:19:04.742094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c3d8da6-18f6-4f70-b203-65493ee38f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2291166350>]}
[0m13:19:04.742697 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m13:19:04.743280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c3d8da6-18f6-4f70-b203-65493ee38f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22911662f0>]}
[0m13:19:04.745012 [info ] [MainThread]: 
[0m13:19:04.746021 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:19:04.747287 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:19:04.747845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:05.734497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c3d8da6-18f6-4f70-b203-65493ee38f35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2291166230>]}
[0m13:19:05.736297 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:19:05.737686 [info ] [MainThread]: 
[0m13:19:05.745573 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m13:19:05.746889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m13:19:05.747705 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m13:19:05.760753 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m13:19:05.762641 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 13:19:05.748735 => 13:19:05.762249
[0m13:19:05.763446 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m13:19:05.764520 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 13:19:05.763984 => 13:19:05.764184
[0m13:19:05.766563 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m13:19:05.768028 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:19:05.768931 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:19:05.771500 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22'
[0m13:19:05.772221 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:19:05.770184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.coffee_shop.stg_coffee_shop_customers, now model.coffee_shop.stg_coffee_shop_monthly_orders)
[0m13:19:05.782587 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:19:05.787125 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m13:19:05.787658 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:19:05.798203 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m13:19:05.798695 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:19:05.795050 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m13:19:05.806933 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 13:19:05.772702 => 13:19:05.806544
[0m13:19:05.807624 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:19:05.808441 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 13:19:05.808070 => 13:19:05.808091
[0m13:19:05.795527 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:19:05.823941 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m13:19:05.824626 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:19:05.819550 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m13:19:05.796986 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 13:19:05.783086 => 13:19:05.796203
[0m13:19:05.834849 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:19:05.810706 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:19:05.835834 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 13:19:05.799030 => 13:19:05.835474
[0m13:19:05.837522 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:19:05.838339 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 13:19:05.837991 => 13:19:05.838005
[0m13:19:05.839823 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:19:05.836523 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 13:19:05.836199 => 13:19:05.836216
[0m13:19:05.844193 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:19:05.842615 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m13:19:05.845299 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:19:05.847038 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m13:19:05.847485 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:19:05.863105 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m13:19:05.863952 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 13:19:05.825250 => 13:19:05.863608
[0m13:19:05.864785 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:19:05.865532 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 13:19:05.865284 => 13:19:05.865300
[0m13:19:05.866595 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:19:05.867450 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 13:19:05.847785 => 13:19:05.867205
[0m13:19:05.868139 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:19:05.868758 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 13:19:05.868516 => 13:19:05.868530
[0m13:19:05.870019 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:19:05.871687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:05.872055 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m13:19:05.872390 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m13:19:05.872880 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m13:19:05.873292 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m13:19:05.873655 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m13:19:05.875022 [debug] [MainThread]: Command end result
[0m13:19:05.889157 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m13:19:05.889622 [info ] [MainThread]: Building catalog
[0m13:19:05.891741 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:06.371373 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m13:19:06.372470 [debug] [ThreadPool]: Acquiring new bigquery connection 'analytics-engineers-club.information_schema'
[0m13:19:06.388408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:06.391230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:06.392117 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_marcel`.__TABLES__
        where (upper(dataset_id) = upper('dbt_marcel'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m13:19:06.393305 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m13:19:08.850078 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:92ba4d58-a115-4a8b-bb68-adea9a1200a8&page=queryresults
[0m13:19:09.537525 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:dfd5f740-f6af-4a1b-b8e8-b4d51a594b66&page=queryresults
[0m13:19:09.564970 [info ] [MainThread]: Catalog written to /workspaces/aec-self-study-marcel/coffee_shop_marcel/target/catalog.json
[0m13:19:09.566313 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:19:09.566147 after 5.32 seconds
[0m13:19:09.566820 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:19:09.567265 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m13:19:09.567657 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.
[0m13:19:09.568124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22943eab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2295813bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22911659f0>]}
[0m13:19:09.568639 [debug] [MainThread]: Flushing usage events
[0m13:19:14.574410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf23cab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf0eb7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf0eb7be0>]}


============================== 13:19:14.577495 | b43b3ec5-d5fa-4111-bf92-f2a8efb04b3d ==============================
[0m13:19:14.577495 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:19:14.578364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:19:14.965170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b43b3ec5-d5fa-4111-bf92-f2a8efb04b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaef3cba60>]}
[0m13:19:14.983064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b43b3ec5-d5fa-4111-bf92-f2a8efb04b3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaef39b070>]}
[0m13:19:15.192722 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m13:19:15.194335 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 299, in docs_serve
    results = task.run()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
  File "/usr/lib/python3.10/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/lib/python3.10/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m13:19:15.195531 [debug] [MainThread]: Command `dbt docs serve` failed at 13:19:15.195374 after 0.63 seconds
[0m13:19:15.196017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf23cab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaef3b66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaef3b66e0>]}
[0m13:19:15.196553 [debug] [MainThread]: Flushing usage events
[0m13:21:20.013174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71fa8ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71e593ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71e593e80>]}


============================== 13:21:20.016753 | 6173ea94-e48c-49e1-b1df-1a237bc2a9b6 ==============================
[0m13:21:20.016753 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:21:20.017842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:21:20.404321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6173ea94-e48c-49e1-b1df-1a237bc2a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71caabc10>]}
[0m13:21:20.422474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6173ea94-e48c-49e1-b1df-1a237bc2a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71ca79540>]}
[0m13:21:20.423382 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m13:21:20.434676 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m13:21:20.461862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:20.462353 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:20.468861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6173ea94-e48c-49e1-b1df-1a237bc2a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71c8740d0>]}
[0m13:21:20.470750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6173ea94-e48c-49e1-b1df-1a237bc2a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71ca3ed70>]}
[0m13:21:20.471273 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m13:21:20.471834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6173ea94-e48c-49e1-b1df-1a237bc2a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71ca3ee00>]}
[0m13:21:20.473632 [info ] [MainThread]: 
[0m13:21:20.474876 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:21:20.476187 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m13:21:20.476703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:21.758257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6173ea94-e48c-49e1-b1df-1a237bc2a9b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71ca3ec50>]}
[0m13:21:21.759578 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:21:21.760232 [info ] [MainThread]: 
[0m13:21:21.765824 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m13:21:21.766762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m13:21:21.767245 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m13:21:21.770916 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m13:21:21.771914 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 13:21:21.767549 => 13:21:21.771560
[0m13:21:21.772696 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m13:21:21.773296 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 13:21:21.772995 => 13:21:21.773021
[0m13:21:21.774303 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m13:21:21.775310 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:21:21.776627 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m13:21:21.777076 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:21:21.775774 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:21:21.782696 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22'
[0m13:21:21.781183 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:21:21.781699 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:21:21.785090 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m13:21:21.780472 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m13:21:21.784225 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m13:21:21.786472 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:21:21.783356 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:21:21.785599 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:21:21.797993 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 13:21:21.777370 => 13:21:21.797705
[0m13:21:21.812041 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m13:21:21.812591 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m13:21:21.819537 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m13:21:21.820138 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:21:21.822130 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 13:21:21.821765 => 13:21:21.821789
[0m13:21:21.823220 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m13:21:21.821181 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 13:21:21.786857 => 13:21:21.820795
[0m13:21:21.826031 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:21:21.824915 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 13:21:21.792403 => 13:21:21.824676
[0m13:21:21.825536 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:21:21.828032 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m13:21:21.828517 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:21:21.827137 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:21:21.826597 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 13:21:21.826332 => 13:21:21.826345
[0m13:21:21.840841 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 13:21:21.840589 => 13:21:21.840603
[0m13:21:21.840205 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m13:21:21.823993 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 13:21:21.812906 => 13:21:21.823663
[0m13:21:21.843968 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:21:21.844757 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 13:21:21.844429 => 13:21:21.844443
[0m13:21:21.846285 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m13:21:21.843055 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m13:21:21.845404 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 13:21:21.828815 => 13:21:21.845077
[0m13:21:21.841875 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m13:21:21.847159 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:21:21.848013 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 13:21:21.847771 => 13:21:21.847782
[0m13:21:21.849007 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m13:21:21.850617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:21.850979 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m13:21:21.851307 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m13:21:21.851629 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m13:21:21.851950 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m13:21:21.852269 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m13:21:21.852587 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m13:21:21.854008 [debug] [MainThread]: Command end result
[0m13:21:21.870362 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m13:21:21.870895 [info ] [MainThread]: Building catalog
[0m13:21:21.872376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:22.365281 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m13:21:22.366358 [debug] [ThreadPool]: Acquiring new bigquery connection 'analytics-engineers-club.information_schema'
[0m13:21:22.385327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:22.385979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:22.388946 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_marcel`.__TABLES__
        where (upper(dataset_id) = upper('dbt_marcel'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m13:21:22.386959 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m13:21:24.947483 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:86a48fb6-6dad-4bc8-aafe-e1998135f98e&page=queryresults
[0m13:21:25.163011 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a05d5bd8-342d-4a04-b317-b937d3070c74&page=queryresults
[0m13:21:25.193200 [info ] [MainThread]: Catalog written to /workspaces/aec-self-study-marcel/coffee_shop_marcel/target/catalog.json
[0m13:21:25.194617 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:21:25.194443 after 5.19 seconds
[0m13:21:25.195072 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:21:25.195452 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m13:21:25.195821 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.
[0m13:21:25.196274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71fa8ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc714718ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc71c90db40>]}
[0m13:21:25.196760 [debug] [MainThread]: Flushing usage events
[0m13:21:34.590693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0daef02b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dad9bfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dad9bfbb0>]}


============================== 13:21:34.593610 | 660ba8fa-e7cb-4e55-a3bd-e1662a45d431 ==============================
[0m13:21:34.593610 [info ] [MainThread]: Running with dbt=1.5.2
[0m13:21:34.594498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:21:34.970860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '660ba8fa-e7cb-4e55-a3bd-e1662a45d431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dabeb6920>]}
[0m13:21:34.989027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '660ba8fa-e7cb-4e55-a3bd-e1662a45d431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0dabee3a30>]}
[0m23:37:06.075364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794f98ab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794e4c3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794e4c3be0>]}


============================== 23:37:06.093934 | 3a1d7770-ef56-43e7-b061-59be729dc436 ==============================
[0m23:37:06.093934 [info ] [MainThread]: Running with dbt=1.5.2
[0m23:37:06.094945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:37:07.796352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a1d7770-ef56-43e7-b061-59be729dc436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794c9d7970>]}
[0m23:37:07.819375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a1d7770-ef56-43e7-b061-59be729dc436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794c9ab670>]}
[0m23:37:07.820777 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m23:37:07.836327 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m23:37:07.917782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:37:07.918807 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:37:07.945455 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:37:08.025255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a1d7770-ef56-43e7-b061-59be729dc436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794c816b30>]}
[0m23:37:08.035786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a1d7770-ef56-43e7-b061-59be729dc436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794c776bf0>]}
[0m23:37:08.036557 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m23:37:08.037370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a1d7770-ef56-43e7-b061-59be729dc436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794c774520>]}
[0m23:37:08.039584 [info ] [MainThread]: 
[0m23:37:08.040677 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:37:08.042747 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m23:37:08.043523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:12.930275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m23:37:12.931212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:13.172651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a1d7770-ef56-43e7-b061-59be729dc436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794c776140>]}
[0m23:37:13.174731 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m23:37:13.176401 [info ] [MainThread]: 
[0m23:37:13.196051 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m23:37:13.197714 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m23:37:13.200298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m23:37:13.201106 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m23:37:13.206783 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:37:13.208533 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 23:37:13.201630 => 23:37:13.208162
[0m23:37:13.209245 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m23:37:13.238787 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 23:37:13.209759 => 23:37:13.238409
[0m23:37:13.242457 [debug] [Thread-1 (]: Compilation Error in model stg_coffee_shop_customers (models/staging/coffee_shop/stg_coffee_shop_customers.sql)
  Trying to create view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`, but it currently exists as a table. Either drop `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
  > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model stg_coffee_shop_customers (models/staging/coffee_shop/stg_coffee_shop_customers.sql)
[0m23:37:13.243268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a1d7770-ef56-43e7-b061-59be729dc436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794c7adc60>]}
[0m23:37:13.244121 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dbt_marcel.stg_coffee_shop_customers ...... [[31mERROR[0m in 0.04s]
[0m23:37:13.245185 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m23:37:13.246254 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:37:13.246800 [info ] [Thread-3 (]: 2 of 2 SKIP relation dbt_marcel.stg_coffee_shop_monthly_orders ................. [[33mSKIP[0m]
[0m23:37:13.247528 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:37:13.249899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:13.250289 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m23:37:13.250753 [info ] [MainThread]: 
[0m23:37:13.251492 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m23:37:13.252820 [debug] [MainThread]: Command end result
[0m23:37:13.262381 [info ] [MainThread]: 
[0m23:37:13.263160 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:37:13.263728 [info ] [MainThread]: 
[0m23:37:13.264337 [error] [MainThread]: [33mCompilation Error in model stg_coffee_shop_customers (models/staging/coffee_shop/stg_coffee_shop_customers.sql)[0m
[0m23:37:13.264903 [error] [MainThread]:   Trying to create view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`, but it currently exists as a table. Either drop `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
[0m23:37:13.265442 [error] [MainThread]:   
[0m23:37:13.265980 [error] [MainThread]:   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
[0m23:37:13.266515 [error] [MainThread]:   > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
[0m23:37:13.267337 [error] [MainThread]:   > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m23:37:13.267980 [error] [MainThread]:   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
[0m23:37:13.268578 [error] [MainThread]:   > called by model stg_coffee_shop_customers (models/staging/coffee_shop/stg_coffee_shop_customers.sql)
[0m23:37:13.269397 [info ] [MainThread]: 
[0m23:37:13.270159 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m23:37:13.271397 [debug] [MainThread]: Command `dbt run` failed at 23:37:13.271203 after 7.22 seconds
[0m23:37:13.271974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794f98ab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794c9d5cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794c7659c0>]}
[0m23:37:13.272559 [debug] [MainThread]: Flushing usage events
[0m23:37:48.190591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef19cebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef04b7d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef04b7c40>]}


============================== 23:37:48.193586 | 0fd523bc-7390-48b6-986c-bcc611b4a96e ==============================
[0m23:37:48.193586 [info ] [MainThread]: Running with dbt=1.5.2
[0m23:37:48.194504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:37:48.615159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fd523bc-7390-48b6-986c-bcc611b4a96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eee9a5c00>]}
[0m23:37:48.633095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fd523bc-7390-48b6-986c-bcc611b4a96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eee9d9480>]}
[0m23:37:48.634349 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m23:37:48.646995 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m23:37:48.675494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:37:48.676094 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:37:48.683169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fd523bc-7390-48b6-986c-bcc611b4a96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eee7a00d0>]}
[0m23:37:48.693567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fd523bc-7390-48b6-986c-bcc611b4a96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eee76a800>]}
[0m23:37:48.694318 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m23:37:48.695101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fd523bc-7390-48b6-986c-bcc611b4a96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eee76a890>]}
[0m23:37:48.696975 [info ] [MainThread]: 
[0m23:37:48.698051 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:37:48.699502 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m23:37:48.700193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:37:49.851174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m23:37:49.851930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:37:50.100384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fd523bc-7390-48b6-986c-bcc611b4a96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eee769ae0>]}
[0m23:37:50.101735 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m23:37:50.102684 [info ] [MainThread]: 
[0m23:37:50.108974 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m23:37:50.109916 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m23:37:50.111266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m23:37:50.111761 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m23:37:50.115314 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:37:50.116527 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 23:37:50.112067 => 23:37:50.116123
[0m23:37:50.117109 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m23:37:50.139090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:37:50.473362 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:37:50.474855 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
)

renamed as (
  select *
  from source
)

select *
renamed;


[0m23:37:50.661885 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got identifier "renamed" at [10:1]')
[0m23:37:51.408105 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6e504618-91c1-409c-8044-c861a71120de&page=queryresults
[0m23:37:51.409675 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 23:37:50.117406 => 23:37:51.409347
[0m23:37:51.427627 [debug] [Thread-1 (]: Database Error in model stg_coffee_shop_customers (models/staging/coffee_shop/stg_coffee_shop_customers.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got identifier "renamed" at [10:1]
  compiled Code at target/run/coffee_shop/models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:37:51.428547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fd523bc-7390-48b6-986c-bcc611b4a96e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eee9da890>]}
[0m23:37:51.429484 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dbt_marcel.stg_coffee_shop_customers ...... [[31mERROR[0m in 1.32s]
[0m23:37:51.430414 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m23:37:51.431764 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:37:51.432485 [info ] [Thread-3 (]: 2 of 2 SKIP relation dbt_marcel.stg_coffee_shop_monthly_orders ................. [[33mSKIP[0m]
[0m23:37:51.433340 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:37:51.435814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:37:51.436203 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m23:37:51.436739 [info ] [MainThread]: 
[0m23:37:51.437640 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m23:37:51.438629 [debug] [MainThread]: Command end result
[0m23:37:51.455101 [info ] [MainThread]: 
[0m23:37:51.455944 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:37:51.456576 [info ] [MainThread]: 
[0m23:37:51.457145 [error] [MainThread]: [33mDatabase Error in model stg_coffee_shop_customers (models/staging/coffee_shop/stg_coffee_shop_customers.sql)[0m
[0m23:37:51.457683 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got identifier "renamed" at [10:1]
[0m23:37:51.458224 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:37:51.458760 [info ] [MainThread]: 
[0m23:37:51.459345 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m23:37:51.460246 [debug] [MainThread]: Command `dbt run` failed at 23:37:51.460089 after 3.28 seconds
[0m23:37:51.460747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef19cebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eee8219f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7eee8221d0>]}
[0m23:37:51.461390 [debug] [MainThread]: Flushing usage events
[0m23:38:34.128405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c34cabc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c21cfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c21cfc40>]}


============================== 23:38:34.131914 | fd1d8ca0-8776-4458-8093-5750927f2a2a ==============================
[0m23:38:34.131914 [info ] [MainThread]: Running with dbt=1.5.2
[0m23:38:34.132997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:38:34.524072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd1d8ca0-8776-4458-8093-5750927f2a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c06baf20>]}
[0m23:38:34.541867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd1d8ca0-8776-4458-8093-5750927f2a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c06f4070>]}
[0m23:38:34.542987 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m23:38:34.555630 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m23:38:34.583064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:38:34.583984 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:38:34.621638 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:38:34.751782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd1d8ca0-8776-4458-8093-5750927f2a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c053e020>]}
[0m23:38:34.761159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd1d8ca0-8776-4458-8093-5750927f2a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c04802b0>]}
[0m23:38:34.761877 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m23:38:34.762528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd1d8ca0-8776-4458-8093-5750927f2a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c04829b0>]}
[0m23:38:34.764298 [info ] [MainThread]: 
[0m23:38:34.765337 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:38:34.766725 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m23:38:34.767294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:35.851474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m23:38:35.852587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:36.069509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd1d8ca0-8776-4458-8093-5750927f2a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c0481c90>]}
[0m23:38:36.071155 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m23:38:36.072461 [info ] [MainThread]: 
[0m23:38:36.081696 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m23:38:36.083206 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m23:38:36.085873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m23:38:36.086976 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m23:38:36.094360 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:38:36.096275 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 23:38:36.087577 => 23:38:36.095848
[0m23:38:36.097052 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m23:38:36.151029 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:38:36.152756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:36.153614 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
),

renamed as (
  select *
  from source
)

select *
renamed;


[0m23:38:36.435035 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got identifier "renamed" at [16:1]')
[0m23:38:36.649748 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:714b0557-69d7-4f8b-9bcc-56c899dda40b&page=queryresults
[0m23:38:36.651170 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 23:38:36.097615 => 23:38:36.650837
[0m23:38:36.654942 [debug] [Thread-1 (]: Database Error in model stg_coffee_shop_customers (models/staging/coffee_shop/stg_coffee_shop_customers.sql)
  Syntax error: Expected end of input but got identifier "renamed" at [16:1]
  compiled Code at target/run/coffee_shop/models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:38:36.655654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd1d8ca0-8776-4458-8093-5750927f2a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c06f5330>]}
[0m23:38:36.657367 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dbt_marcel.stg_coffee_shop_customers ...... [[31mERROR[0m in 0.57s]
[0m23:38:36.658219 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m23:38:36.659685 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:38:36.660314 [info ] [Thread-3 (]: 2 of 2 SKIP relation dbt_marcel.stg_coffee_shop_monthly_orders ................. [[33mSKIP[0m]
[0m23:38:36.661051 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:38:36.663582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:36.663971 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m23:38:36.664466 [info ] [MainThread]: 
[0m23:38:36.665163 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m23:38:36.666422 [debug] [MainThread]: Command end result
[0m23:38:36.676302 [info ] [MainThread]: 
[0m23:38:36.677038 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:38:36.677673 [info ] [MainThread]: 
[0m23:38:36.678254 [error] [MainThread]: [33mDatabase Error in model stg_coffee_shop_customers (models/staging/coffee_shop/stg_coffee_shop_customers.sql)[0m
[0m23:38:36.678821 [error] [MainThread]:   Syntax error: Expected end of input but got identifier "renamed" at [16:1]
[0m23:38:36.679382 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:38:36.679949 [info ] [MainThread]: 
[0m23:38:36.680598 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m23:38:36.681820 [debug] [MainThread]: Command `dbt run` failed at 23:38:36.681677 after 2.57 seconds
[0m23:38:36.682394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c34cabc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c06d2e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33c34ce3b0>]}
[0m23:38:36.683516 [debug] [MainThread]: Flushing usage events
[0m23:41:47.533887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32adc2ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ac6b7df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ac6b7cd0>]}


============================== 23:41:47.537138 | 0ba9738f-84b0-43ed-b7f4-032c331f50b5 ==============================
[0m23:41:47.537138 [info ] [MainThread]: Running with dbt=1.5.2
[0m23:41:47.538043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:41:47.921652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ba9738f-84b0-43ed-b7f4-032c331f50b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32aabaf160>]}
[0m23:41:47.939634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ba9738f-84b0-43ed-b7f4-032c331f50b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32aabda050>]}
[0m23:41:47.940867 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m23:41:47.953592 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m23:41:47.980984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:41:47.982023 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:41:48.009609 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:41:48.087252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ba9738f-84b0-43ed-b7f4-032c331f50b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32aaa259c0>]}
[0m23:41:48.096063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ba9738f-84b0-43ed-b7f4-032c331f50b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32aa966260>]}
[0m23:41:48.096826 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m23:41:48.097499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba9738f-84b0-43ed-b7f4-032c331f50b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32aa966200>]}
[0m23:41:48.099196 [info ] [MainThread]: 
[0m23:41:48.100200 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:41:48.101702 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m23:41:48.102265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:49.218853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m23:41:49.219812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:41:49.437785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ba9738f-84b0-43ed-b7f4-032c331f50b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32aa9652d0>]}
[0m23:41:49.439486 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m23:41:49.440783 [info ] [MainThread]: 
[0m23:41:49.449964 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m23:41:49.450772 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m23:41:49.451896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m23:41:49.452449 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m23:41:49.456526 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:41:49.457733 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 23:41:49.452797 => 23:41:49.457363
[0m23:41:49.459035 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m23:41:49.495386 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:41:49.496537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:49.497230 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
),
renamed as (
  select *
  from source
)

select *
renamed;


[0m23:41:49.747334 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got identifier "renamed" at [15:1]')
[0m23:41:50.753782 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a341aff7-3d2e-44da-8c17-6a069923bee4&page=queryresults
[0m23:41:50.755496 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 23:41:49.459359 => 23:41:50.755096
[0m23:41:50.759974 [debug] [Thread-1 (]: Database Error in model stg_coffee_shop_customers (models/staging/coffee_shop/stg_coffee_shop_customers.sql)
  Syntax error: Expected end of input but got identifier "renamed" at [15:1]
  compiled Code at target/run/coffee_shop/models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:41:50.761146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ba9738f-84b0-43ed-b7f4-032c331f50b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32aa4bcaf0>]}
[0m23:41:50.762815 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dbt_marcel.stg_coffee_shop_customers ...... [[31mERROR[0m in 1.31s]
[0m23:41:50.763666 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m23:41:50.764936 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:41:50.765519 [info ] [Thread-3 (]: 2 of 2 SKIP relation dbt_marcel.stg_coffee_shop_monthly_orders ................. [[33mSKIP[0m]
[0m23:41:50.766176 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:41:50.768574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:50.768988 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m23:41:50.769519 [info ] [MainThread]: 
[0m23:41:50.770116 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m23:41:50.771168 [debug] [MainThread]: Command end result
[0m23:41:50.780657 [info ] [MainThread]: 
[0m23:41:50.781622 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:41:50.782284 [info ] [MainThread]: 
[0m23:41:50.782876 [error] [MainThread]: [33mDatabase Error in model stg_coffee_shop_customers (models/staging/coffee_shop/stg_coffee_shop_customers.sql)[0m
[0m23:41:50.783454 [error] [MainThread]:   Syntax error: Expected end of input but got identifier "renamed" at [15:1]
[0m23:41:50.784024 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:41:50.784634 [info ] [MainThread]: 
[0m23:41:50.785236 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m23:41:50.786160 [debug] [MainThread]: Command `dbt run` failed at 23:41:50.786022 after 3.26 seconds
[0m23:41:50.786692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32adc2ec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32aabda050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32aaa128c0>]}
[0m23:41:50.787408 [debug] [MainThread]: Flushing usage events
[0m23:43:57.398787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c24872bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c235cfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c235cfc40>]}


============================== 23:43:57.402305 | 860da9c3-7552-4b2e-b5ef-48ca57cfaae7 ==============================
[0m23:43:57.402305 [info ] [MainThread]: Running with dbt=1.5.2
[0m23:43:57.403202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:43:57.792855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '860da9c3-7552-4b2e-b5ef-48ca57cfaae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c21ab5c90>]}
[0m23:43:57.810980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '860da9c3-7552-4b2e-b5ef-48ca57cfaae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c21af0040>]}
[0m23:43:57.812157 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m23:43:57.824800 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m23:43:57.852641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:43:57.853579 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:43:57.880733 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:43:57.957370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '860da9c3-7552-4b2e-b5ef-48ca57cfaae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c2193dff0>]}
[0m23:43:57.966749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '860da9c3-7552-4b2e-b5ef-48ca57cfaae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c21880280>]}
[0m23:43:57.967531 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m23:43:57.968238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '860da9c3-7552-4b2e-b5ef-48ca57cfaae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c21882980>]}
[0m23:43:57.970031 [info ] [MainThread]: 
[0m23:43:57.971090 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:43:57.972541 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m23:43:57.973097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:59.130702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m23:43:59.131493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:43:59.348454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '860da9c3-7552-4b2e-b5ef-48ca57cfaae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c21881cc0>]}
[0m23:43:59.349912 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m23:43:59.350869 [info ] [MainThread]: 
[0m23:43:59.357136 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m23:43:59.358503 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m23:43:59.359576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m23:43:59.360087 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m23:43:59.363759 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:43:59.364749 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 23:43:59.360425 => 23:43:59.364390
[0m23:43:59.365390 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m23:43:59.404398 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:43:59.405641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:59.406342 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
),
renamed as (
  select *
  from source
)

select *
renamed;


[0m23:43:59.642417 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got identifier "renamed" at [15:1]')
[0m23:44:00.075707 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c959b578-9229-4f78-b3bf-b5201b23fddd&page=queryresults
[0m23:44:00.077442 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 23:43:59.365697 => 23:44:00.077033
[0m23:44:00.081363 [debug] [Thread-1 (]: Database Error in model stg_coffee_shop_customers (models/staging/coffee_shop/stg_coffee_shop_customers.sql)
  Syntax error: Expected end of input but got identifier "renamed" at [15:1]
  compiled Code at target/run/coffee_shop/models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:44:00.082411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '860da9c3-7552-4b2e-b5ef-48ca57cfaae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c21af0580>]}
[0m23:44:00.083484 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dbt_marcel.stg_coffee_shop_customers ...... [[31mERROR[0m in 0.72s]
[0m23:44:00.084391 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m23:44:00.086079 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:44:00.086658 [info ] [Thread-3 (]: 2 of 2 SKIP relation dbt_marcel.stg_coffee_shop_monthly_orders ................. [[33mSKIP[0m]
[0m23:44:00.087373 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:44:00.091536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:00.092721 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m23:44:00.093340 [info ] [MainThread]: 
[0m23:44:00.094515 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m23:44:00.095535 [debug] [MainThread]: Command end result
[0m23:44:00.106128 [info ] [MainThread]: 
[0m23:44:00.107181 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:44:00.108039 [info ] [MainThread]: 
[0m23:44:00.108777 [error] [MainThread]: [33mDatabase Error in model stg_coffee_shop_customers (models/staging/coffee_shop/stg_coffee_shop_customers.sql)[0m
[0m23:44:00.109537 [error] [MainThread]:   Syntax error: Expected end of input but got identifier "renamed" at [15:1]
[0m23:44:00.110118 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:44:00.110807 [info ] [MainThread]: 
[0m23:44:00.111505 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m23:44:00.112535 [debug] [MainThread]: Command `dbt run` failed at 23:44:00.112385 after 2.72 seconds
[0m23:44:00.113052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c24872bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c21acee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c21929a80>]}
[0m23:44:00.113700 [debug] [MainThread]: Flushing usage events
[0m23:45:05.220754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb99916b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb98393d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb98393c10>]}


============================== 23:45:05.226104 | 75914470-d0b8-4740-8fe0-2dff82cab1f4 ==============================
[0m23:45:05.226104 [info ] [MainThread]: Running with dbt=1.5.2
[0m23:45:05.227299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:45:05.649586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75914470-d0b8-4740-8fe0-2dff82cab1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9687e770>]}
[0m23:45:05.667966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75914470-d0b8-4740-8fe0-2dff82cab1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb968b15a0>]}
[0m23:45:05.669219 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m23:45:05.682053 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m23:45:05.710944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:45:05.711942 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:45:05.739090 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:45:05.816710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75914470-d0b8-4740-8fe0-2dff82cab1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb966fde10>]}
[0m23:45:05.825739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75914470-d0b8-4740-8fe0-2dff82cab1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9683c0a0>]}
[0m23:45:05.826524 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m23:45:05.827194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75914470-d0b8-4740-8fe0-2dff82cab1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9683e7a0>]}
[0m23:45:05.829050 [info ] [MainThread]: 
[0m23:45:05.830087 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:45:05.831502 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m23:45:05.832086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:06.961250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m23:45:06.962114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:07.185045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75914470-d0b8-4740-8fe0-2dff82cab1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9683d900>]}
[0m23:45:07.186223 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m23:45:07.186910 [info ] [MainThread]: 
[0m23:45:07.192124 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m23:45:07.192961 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m23:45:07.194343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m23:45:07.194854 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m23:45:07.198721 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:45:07.199801 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 23:45:07.195166 => 23:45:07.199428
[0m23:45:07.200461 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m23:45:07.238612 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:45:07.239895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:07.240593 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
)

select *
source;


[0m23:45:07.490345 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword SOURCE at [11:1]')
[0m23:45:07.984179 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:bc347446-b79f-440a-83d2-bdbcd243f300&page=queryresults
[0m23:45:07.985977 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 23:45:07.200866 => 23:45:07.985512
[0m23:45:07.991362 [debug] [Thread-1 (]: Database Error in model stg_coffee_shop_customers (models/staging/coffee_shop/stg_coffee_shop_customers.sql)
  Syntax error: Expected end of input but got keyword SOURCE at [11:1]
  compiled Code at target/run/coffee_shop/models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:45:07.993143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75914470-d0b8-4740-8fe0-2dff82cab1f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb96197910>]}
[0m23:45:07.994496 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dbt_marcel.stg_coffee_shop_customers ...... [[31mERROR[0m in 0.80s]
[0m23:45:07.996109 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m23:45:07.998000 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:45:07.998894 [info ] [Thread-3 (]: 2 of 2 SKIP relation dbt_marcel.stg_coffee_shop_monthly_orders ................. [[33mSKIP[0m]
[0m23:45:07.999982 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:45:08.003900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:08.004581 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m23:45:08.005294 [info ] [MainThread]: 
[0m23:45:08.006160 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m23:45:08.007782 [debug] [MainThread]: Command end result
[0m23:45:08.018337 [info ] [MainThread]: 
[0m23:45:08.019230 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:45:08.020130 [info ] [MainThread]: 
[0m23:45:08.021070 [error] [MainThread]: [33mDatabase Error in model stg_coffee_shop_customers (models/staging/coffee_shop/stg_coffee_shop_customers.sql)[0m
[0m23:45:08.021713 [error] [MainThread]:   Syntax error: Expected end of input but got keyword SOURCE at [11:1]
[0m23:45:08.022297 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:45:08.022881 [info ] [MainThread]: 
[0m23:45:08.023602 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m23:45:08.024921 [debug] [MainThread]: Command `dbt run` failed at 23:45:08.024724 after 2.82 seconds
[0m23:45:08.025741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb99916b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb968b15a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb99922380>]}
[0m23:45:08.026541 [debug] [MainThread]: Flushing usage events
[0m23:45:32.451032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09dccbec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09db793e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09db793d00>]}


============================== 23:45:32.454682 | 93b93448-9321-408d-9b87-5775a16e5dc9 ==============================
[0m23:45:32.454682 [info ] [MainThread]: Running with dbt=1.5.2
[0m23:45:32.455844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:45:32.847154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93b93448-9321-408d-9b87-5775a16e5dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d9c7f7c0>]}
[0m23:45:32.865848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93b93448-9321-408d-9b87-5775a16e5dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d9cb3370>]}
[0m23:45:32.866988 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m23:45:32.879399 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m23:45:32.907362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:45:32.908386 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:45:32.935123 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:45:33.019687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93b93448-9321-408d-9b87-5775a16e5dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d9afdcf0>]}
[0m23:45:33.028710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93b93448-9321-408d-9b87-5775a16e5dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d9c3a530>]}
[0m23:45:33.029470 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m23:45:33.030125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93b93448-9321-408d-9b87-5775a16e5dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d9c3a620>]}
[0m23:45:33.031932 [info ] [MainThread]: 
[0m23:45:33.033008 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:45:33.034392 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m23:45:33.034941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:45:34.296650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m23:45:34.297546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:45:34.537228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93b93448-9321-408d-9b87-5775a16e5dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d9c396c0>]}
[0m23:45:34.538588 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m23:45:34.539338 [info ] [MainThread]: 
[0m23:45:34.545068 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m23:45:34.545880 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m23:45:34.546891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m23:45:34.547388 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m23:45:34.551408 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:45:34.553219 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 23:45:34.547696 => 23:45:34.552922
[0m23:45:34.553722 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m23:45:34.593468 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:45:34.594618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:45:34.595300 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
)

select *
from source;


[0m23:45:35.428533 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e7efda0e-2a84-41bb-879c-4cd3a1542389&page=queryresults
[0m23:45:35.446135 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 23:45:34.554053 => 23:45:35.445882
[0m23:45:35.447273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b93448-9321-408d-9b87-5775a16e5dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d9ae2e60>]}
[0m23:45:35.448155 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_customers .......... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m23:45:35.449191 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m23:45:35.450409 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:45:35.451057 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.stg_coffee_shop_monthly_orders .......... [RUN]
[0m23:45:35.452188 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m23:45:35.452716 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:45:35.457701 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m23:45:35.458734 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 23:45:35.453064 => 23:45:35.458358
[0m23:45:35.459294 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:45:35.463365 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m23:45:35.464246 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:45:35.464839 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop_monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
  OPTIONS()
  as select
	date_trunc(first_order_at,month) as date_month,
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
group by 1;


[0m23:45:36.300817 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: first_order_at at [7:20]')
[0m23:45:37.366464 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0f4af882-424c-4108-af1a-c643ab9ae0ce&page=queryresults
[0m23:45:37.367975 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 23:45:35.459602 => 23:45:37.367564
[0m23:45:37.371993 [debug] [Thread-3 (]: Database Error in model stg_coffee_shop_monthly_orders (models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql)
  Unrecognized name: first_order_at at [7:20]
  compiled Code at target/run/coffee_shop/models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m23:45:37.373274 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93b93448-9321-408d-9b87-5775a16e5dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d95b75e0>]}
[0m23:45:37.374469 [error] [Thread-3 (]: 2 of 2 ERROR creating sql view model dbt_marcel.stg_coffee_shop_monthly_orders . [[31mERROR[0m in 1.92s]
[0m23:45:37.375794 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:45:37.379335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:45:37.380461 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m23:45:37.381824 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m23:45:37.383360 [info ] [MainThread]: 
[0m23:45:37.383999 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.35 seconds (4.35s).
[0m23:45:37.385055 [debug] [MainThread]: Command end result
[0m23:45:37.394623 [info ] [MainThread]: 
[0m23:45:37.395669 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:45:37.396304 [info ] [MainThread]: 
[0m23:45:37.396904 [error] [MainThread]: [33mDatabase Error in model stg_coffee_shop_monthly_orders (models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql)[0m
[0m23:45:37.397465 [error] [MainThread]:   Unrecognized name: first_order_at at [7:20]
[0m23:45:37.398008 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m23:45:37.398560 [info ] [MainThread]: 
[0m23:45:37.399157 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m23:45:37.400108 [debug] [MainThread]: Command `dbt run` failed at 23:45:37.399959 after 4.96 seconds
[0m23:45:37.400745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09dccbec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d9cb3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d9c39cf0>]}
[0m23:45:37.401422 [debug] [MainThread]: Flushing usage events
[0m23:47:23.396560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2c37ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2b0d3d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2b0d3c40>]}


============================== 23:47:23.399607 | a0e28f36-3cd1-41cf-abad-f0ab61b1da08 ==============================
[0m23:47:23.399607 [info ] [MainThread]: Running with dbt=1.5.2
[0m23:47:23.400519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:47:23.791813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0e28f36-3cd1-41cf-abad-f0ab61b1da08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f295bdb10>]}
[0m23:47:23.809636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0e28f36-3cd1-41cf-abad-f0ab61b1da08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f295f5570>]}
[0m23:47:23.810748 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m23:47:23.822929 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m23:47:23.850021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:47:23.850953 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:47:23.851576 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m23:47:23.878640 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_customers.sql
[0m23:47:23.894025 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m23:47:23.970565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0e28f36-3cd1-41cf-abad-f0ab61b1da08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f29442e30>]}
[0m23:47:23.979650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0e28f36-3cd1-41cf-abad-f0ab61b1da08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f293867d0>]}
[0m23:47:23.980430 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m23:47:23.981104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0e28f36-3cd1-41cf-abad-f0ab61b1da08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f29386770>]}
[0m23:47:23.982862 [info ] [MainThread]: 
[0m23:47:23.983898 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:47:23.985318 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m23:47:23.985897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:25.152037 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m23:47:25.153746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:25.444700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0e28f36-3cd1-41cf-abad-f0ab61b1da08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f29385570>]}
[0m23:47:25.446266 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m23:47:25.447249 [info ] [MainThread]: 
[0m23:47:25.452422 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m23:47:25.453944 [debug] [Thread-2 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:47:25.453278 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m23:47:25.456100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m23:47:25.456795 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m23:47:25.463050 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:47:25.454657 [info ] [Thread-2 (]: 2 of 2 START sql view model dbt_marcel.stg_coffee_shop_monthly_orders .......... [RUN]
[0m23:47:25.464360 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_aec-students, now model.coffee_shop.stg_coffee_shop_monthly_orders)
[0m23:47:25.464949 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:47:25.467358 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m23:47:25.468304 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 23:47:25.465530 => 23:47:25.467897
[0m23:47:25.468882 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 23:47:25.457153 => 23:47:25.468628
[0m23:47:25.469384 [debug] [Thread-2 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:47:25.469929 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m23:47:25.514209 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m23:47:25.515093 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:47:25.516520 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:47:25.517567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:47:25.518084 [debug] [Thread-2 (]: On model.coffee_shop.stg_coffee_shop_monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
  OPTIONS()
  as --test;


[0m23:47:25.518661 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
),

renamed as (
  select *
  from source
)

select *
from renamed;


[0m23:47:25.850854 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or keyword SELECT or keyword WITH but got end of script at [7:1]')
[0m23:47:26.386184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:150a9cdf-3a08-4918-a8ee-7ea538771bb1&page=queryresults
[0m23:47:26.407706 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 23:47:25.496530 => 23:47:26.407434
[0m23:47:26.409007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0e28f36-3cd1-41cf-abad-f0ab61b1da08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2941cc10>]}
[0m23:47:26.410045 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_customers .......... [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m23:47:26.411090 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m23:47:26.953504 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:bc4957df-1464-4508-9fae-62326e41772a&page=queryresults
[0m23:47:26.955131 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 23:47:25.470269 => 23:47:26.954736
[0m23:47:26.960039 [debug] [Thread-2 (]: Database Error in model stg_coffee_shop_monthly_orders (models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got end of script at [7:1]
  compiled Code at target/run/coffee_shop/models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m23:47:26.960859 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0e28f36-3cd1-41cf-abad-f0ab61b1da08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2941ca60>]}
[0m23:47:26.961944 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model dbt_marcel.stg_coffee_shop_monthly_orders . [[31mERROR[0m in 1.50s]
[0m23:47:26.962936 [debug] [Thread-2 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:47:26.965436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:26.965881 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m23:47:26.966287 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m23:47:26.966762 [info ] [MainThread]: 
[0m23:47:26.967383 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m23:47:26.968845 [debug] [MainThread]: Command end result
[0m23:47:26.980086 [info ] [MainThread]: 
[0m23:47:26.981294 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:47:26.982137 [info ] [MainThread]: 
[0m23:47:26.982817 [error] [MainThread]: [33mDatabase Error in model stg_coffee_shop_monthly_orders (models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql)[0m
[0m23:47:26.983482 [error] [MainThread]:   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got end of script at [7:1]
[0m23:47:26.984071 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m23:47:26.984685 [info ] [MainThread]: 
[0m23:47:26.985678 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m23:47:26.986889 [debug] [MainThread]: Command `dbt run` failed at 23:47:26.986673 after 3.60 seconds
[0m23:47:26.987865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f2c37ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f295f5570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f293cf040>]}
[0m23:47:26.988521 [debug] [MainThread]: Flushing usage events
[0m23:48:31.352844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947fc7abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947e793d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947e793c40>]}


============================== 23:48:31.355875 | ecb05514-9bb6-4e0b-a7f6-46c6561f854a ==============================
[0m23:48:31.355875 [info ] [MainThread]: Running with dbt=1.5.2
[0m23:48:31.356768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:48:31.801312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecb05514-9bb6-4e0b-a7f6-46c6561f854a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947cca7b20>]}
[0m23:48:31.840153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecb05514-9bb6-4e0b-a7f6-46c6561f854a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947cc77070>]}
[0m23:48:31.842215 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m23:48:31.866021 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m23:48:31.898050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:48:31.898992 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m23:48:31.925333 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m23:48:31.994817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecb05514-9bb6-4e0b-a7f6-46c6561f854a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947cafb7f0>]}
[0m23:48:32.003546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecb05514-9bb6-4e0b-a7f6-46c6561f854a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947cc3ec50>]}
[0m23:48:32.004289 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m23:48:32.005049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb05514-9bb6-4e0b-a7f6-46c6561f854a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947cc3c580>]}
[0m23:48:32.006899 [info ] [MainThread]: 
[0m23:48:32.007901 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:48:32.009762 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m23:48:32.010305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:33.095045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m23:48:33.095915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:48:33.291051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb05514-9bb6-4e0b-a7f6-46c6561f854a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947cc3e290>]}
[0m23:48:33.292375 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m23:48:33.293140 [info ] [MainThread]: 
[0m23:48:33.302130 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m23:48:33.303263 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m23:48:33.306240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m23:48:33.307057 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m23:48:33.313575 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:48:33.315668 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 23:48:33.307631 => 23:48:33.315281
[0m23:48:33.316469 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m23:48:33.365287 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:48:33.366690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:33.367411 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
),

renamed as (
  select *
  from source
)

select *
from renamed;


[0m23:48:34.202050 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:adb58cd1-8ddd-44fd-8b79-09def2b2703d&page=queryresults
[0m23:48:34.221195 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 23:48:33.317035 => 23:48:34.220823
[0m23:48:34.228091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb05514-9bb6-4e0b-a7f6-46c6561f854a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947ca8be50>]}
[0m23:48:34.229614 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_customers .......... [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m23:48:34.231132 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m23:48:34.232614 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:48:34.233856 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.stg_coffee_shop_monthly_orders .......... [RUN]
[0m23:48:34.235552 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m23:48:34.236424 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:48:34.242414 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m23:48:34.244195 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 23:48:34.237018 => 23:48:34.243832
[0m23:48:34.244915 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:48:34.249521 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m23:48:34.250423 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:48:34.251019 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop_monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
  OPTIONS()
  as select
	
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`;


[0m23:48:35.005363 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:114e324c-43f5-431b-ae35-e64487ab0eeb&page=queryresults
[0m23:48:35.008386 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 23:48:34.245387 => 23:48:35.008129
[0m23:48:35.009430 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb05514-9bb6-4e0b-a7f6-46c6561f854a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947c599cf0>]}
[0m23:48:35.010239 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_monthly_orders ..... [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m23:48:35.011181 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:48:35.013590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:35.013986 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m23:48:35.014378 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m23:48:35.014837 [info ] [MainThread]: 
[0m23:48:35.015974 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m23:48:35.017744 [debug] [MainThread]: Command end result
[0m23:48:35.026371 [info ] [MainThread]: 
[0m23:48:35.027190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:48:35.027780 [info ] [MainThread]: 
[0m23:48:35.028392 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:48:35.029323 [debug] [MainThread]: Command `dbt run` succeeded at 23:48:35.029187 after 3.68 seconds
[0m23:48:35.029822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947fc7abc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947ca8be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947cca5db0>]}
[0m23:48:35.030342 [debug] [MainThread]: Flushing usage events
[0m23:48:58.144570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc28e32b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc278c3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc278c3df0>]}


============================== 23:48:58.147598 | 3c5caf32-e2bf-463c-9229-8b8df9f444c6 ==============================
[0m23:48:58.147598 [info ] [MainThread]: Running with dbt=1.5.2
[0m23:48:58.148523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:48:58.593541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c5caf32-e2bf-463c-9229-8b8df9f444c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc25dbf5e0>]}
[0m23:48:58.611253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c5caf32-e2bf-463c-9229-8b8df9f444c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc25deb340>]}
[0m23:48:58.612402 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m23:48:58.624424 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m23:48:58.651710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:48:58.652489 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:48:58.659868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c5caf32-e2bf-463c-9229-8b8df9f444c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc25ba6830>]}
[0m23:48:58.662013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c5caf32-e2bf-463c-9229-8b8df9f444c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc25b724d0>]}
[0m23:48:58.662643 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m23:48:58.663209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c5caf32-e2bf-463c-9229-8b8df9f444c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc25b725c0>]}
[0m23:48:58.665042 [info ] [MainThread]: 
[0m23:48:58.666035 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:48:58.667340 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m23:48:58.667848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:59.769732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c5caf32-e2bf-463c-9229-8b8df9f444c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc25b72680>]}
[0m23:48:59.771259 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m23:48:59.772212 [info ] [MainThread]: 
[0m23:48:59.779901 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m23:48:59.781012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m23:48:59.781594 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m23:48:59.785542 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m23:48:59.786652 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 23:48:59.781934 => 23:48:59.786162
[0m23:48:59.787145 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m23:48:59.787729 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 23:48:59.787451 => 23:48:59.787477
[0m23:48:59.788827 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m23:48:59.789926 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:48:59.790405 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m23:48:59.793234 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22'
[0m23:48:59.791256 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m23:48:59.792166 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m23:48:59.795148 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:48:59.793713 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m23:48:59.794648 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m23:48:59.798706 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m23:48:59.790843 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m23:48:59.812999 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m23:48:59.815105 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m23:48:59.814523 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 23:48:59.795448 => 23:48:59.814021
[0m23:48:59.811062 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m23:48:59.828023 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m23:48:59.829122 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:48:59.843493 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 23:48:59.842702 => 23:48:59.842733
[0m23:48:59.846225 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m23:48:59.847590 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m23:48:59.849631 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m23:48:59.850852 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m23:48:59.834279 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m23:48:59.870022 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 23:48:59.815533 => 23:48:59.869632
[0m23:48:59.870712 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m23:48:59.871491 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 23:48:59.871143 => 23:48:59.871167
[0m23:48:59.861125 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 23:48:59.799150 => 23:48:59.860650
[0m23:48:59.873499 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m23:48:59.874067 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 23:48:59.873812 => 23:48:59.873825
[0m23:48:59.875103 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m23:48:59.873012 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m23:48:59.868325 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m23:48:59.885418 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 23:48:59.834673 => 23:48:59.884991
[0m23:48:59.886240 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m23:48:59.887183 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 23:48:59.886823 => 23:48:59.886843
[0m23:48:59.888839 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m23:48:59.893010 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m23:48:59.895060 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 23:48:59.851551 => 23:48:59.894701
[0m23:48:59.895788 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m23:48:59.896680 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 23:48:59.896347 => 23:48:59.896365
[0m23:48:59.898080 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m23:48:59.900156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:59.901283 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m23:48:59.901914 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m23:48:59.902546 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m23:48:59.903140 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m23:48:59.903763 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m23:48:59.904396 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m23:48:59.906523 [debug] [MainThread]: Command end result
[0m23:49:00.005744 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m23:49:00.006901 [info ] [MainThread]: Building catalog
[0m23:49:00.009341 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:49:00.486033 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m23:49:00.487280 [debug] [ThreadPool]: Acquiring new bigquery connection 'analytics-engineers-club.information_schema'
[0m23:49:00.504611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:00.507958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:00.509007 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_marcel`.__TABLES__
        where (upper(dataset_id) = upper('dbt_marcel'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m23:49:00.510215 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m23:49:02.958441 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:905b1625-1dc3-483a-be68-1d5680f2fcbc&page=queryresults
[0m23:49:03.094327 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:64a66f8d-a3b9-4e32-bb11-ba4a88437d17&page=queryresults
[0m23:49:03.122344 [info ] [MainThread]: Catalog written to /workspaces/aec-self-study-marcel/coffee_shop_marcel/target/catalog.json
[0m23:49:03.123738 [debug] [MainThread]: Command `dbt docs generate` succeeded at 23:49:03.123554 after 4.99 seconds
[0m23:49:03.124200 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m23:49:03.124645 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m23:49:03.125020 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.
[0m23:49:03.125486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc28e32b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2a253bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc25c250f0>]}
[0m23:49:03.125991 [debug] [MainThread]: Flushing usage events
[0m23:49:15.630522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd95eebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd80b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd80b7c10>]}


============================== 23:49:15.633715 | d2b68854-140b-4460-a214-e56f02d5a072 ==============================
[0m23:49:15.633715 [info ] [MainThread]: Running with dbt=1.5.2
[0m23:49:15.634608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m23:49:16.076411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2b68854-140b-4460-a214-e56f02d5a072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd65a5b70>]}
[0m23:49:16.094304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2b68854-140b-4460-a214-e56f02d5a072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd65dd510>]}
[0m23:51:30.018291 [error] [MainThread]: Encountered an error:

[0m23:51:30.043653 [error] [MainThread]: Traceback (most recent call last):
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/cli/main.py", line 299, in docs_serve
    results = task.run()
  File "/home/vscode/.local/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m23:51:30.045139 [debug] [MainThread]: Command `dbt docs serve` failed at 23:51:30.044956 after 134.42 seconds
[0m23:51:30.045650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd95eebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd65dc3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fd65dc520>]}
[0m23:51:30.046257 [debug] [MainThread]: Flushing usage events
[0m00:18:23.176397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40e1e52c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40e0dd3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40e0dd3ca0>]}


============================== 00:18:23.179598 | 592e73c2-1ec7-460f-8708-b92944df5edf ==============================
[0m00:18:23.179598 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:18:23.180510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:18:23.628065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '592e73c2-1ec7-460f-8708-b92944df5edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40defc2950>]}
[0m00:18:23.645844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '592e73c2-1ec7-460f-8708-b92944df5edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40deff72b0>]}
[0m00:18:23.647001 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:18:23.659961 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:18:23.694889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:18:23.695492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:18:23.702796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '592e73c2-1ec7-460f-8708-b92944df5edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40dedb28f0>]}
[0m00:18:23.712559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '592e73c2-1ec7-460f-8708-b92944df5edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40ded825f0>]}
[0m00:18:23.713279 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:18:23.714034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '592e73c2-1ec7-460f-8708-b92944df5edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40ded82590>]}
[0m00:18:23.715797 [info ] [MainThread]: 
[0m00:18:23.716889 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:18:23.718323 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m00:18:23.719065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:25.698859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m00:18:25.700012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:18:26.169058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '592e73c2-1ec7-460f-8708-b92944df5edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40ded81660>]}
[0m00:18:26.170348 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m00:18:26.171113 [info ] [MainThread]: 
[0m00:18:26.176279 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m00:18:26.177082 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m00:18:26.178320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m00:18:26.178810 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m00:18:26.183569 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m00:18:26.184710 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 00:18:26.179115 => 00:18:26.184346
[0m00:18:26.185417 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m00:18:26.218488 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m00:18:26.219866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:26.220549 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
),

renamed as (
  select *
  from source
)

select *
from renamed;


[0m00:18:26.978571 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:734f6205-8232-4b77-8691-bedcf6b0f655&page=queryresults
[0m00:18:26.997412 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 00:18:26.185815 => 00:18:26.997167
[0m00:18:26.998496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '592e73c2-1ec7-460f-8708-b92944df5edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40deff7670>]}
[0m00:18:26.999369 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_customers .......... [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m00:18:27.000348 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m00:18:27.001494 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:18:27.002122 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.stg_coffee_shop_monthly_orders .......... [RUN]
[0m00:18:27.003218 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m00:18:27.003708 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:18:27.012943 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m00:18:27.014084 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 00:18:27.004039 => 00:18:27.013626
[0m00:18:27.014580 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:18:27.018750 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m00:18:27.019776 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:18:27.020336 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop_monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
  OPTIONS()
  as select
	
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`;


[0m00:18:28.023454 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ec97efe3-fb77-49f2-81b8-7358a531910b&page=queryresults
[0m00:18:28.027098 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 00:18:27.014913 => 00:18:28.026810
[0m00:18:28.028195 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '592e73c2-1ec7-460f-8708-b92944df5edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40ded9b520>]}
[0m00:18:28.029035 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_monthly_orders ..... [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m00:18:28.029952 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:18:28.032136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:28.032558 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m00:18:28.032930 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m00:18:28.033386 [info ] [MainThread]: 
[0m00:18:28.033948 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m00:18:28.035351 [debug] [MainThread]: Command end result
[0m00:18:28.044878 [info ] [MainThread]: 
[0m00:18:28.045650 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:18:28.046273 [info ] [MainThread]: 
[0m00:18:28.046857 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:18:28.047726 [debug] [MainThread]: Command `dbt run` succeeded at 00:18:28.047595 after 4.88 seconds
[0m00:18:28.048177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40e1e52c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40ded9b520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40dee43520>]}
[0m00:18:28.048710 [debug] [MainThread]: Flushing usage events
[0m00:18:37.468471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53f6866bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53f5393d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53f5393c40>]}


============================== 00:18:37.471512 | b9b36681-ed6a-41ad-9dad-53c7432f2290 ==============================
[0m00:18:37.471512 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:18:37.472349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:18:37.929382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9b36681-ed6a-41ad-9dad-53c7432f2290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53f38a7af0>]}
[0m00:18:37.947378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9b36681-ed6a-41ad-9dad-53c7432f2290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53f3877070>]}
[0m00:18:37.948589 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:18:37.961081 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:18:37.991813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:18:37.992487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:18:37.999700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9b36681-ed6a-41ad-9dad-53c7432f2290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53f36700d0>]}
[0m00:18:38.009413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9b36681-ed6a-41ad-9dad-53c7432f2290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53f383ebf0>]}
[0m00:18:38.010162 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:18:38.010825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b36681-ed6a-41ad-9dad-53c7432f2290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53f383ec80>]}
[0m00:18:38.012739 [info ] [MainThread]: 
[0m00:18:38.013785 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:18:38.015271 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m00:18:38.016489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:39.062812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9b36681-ed6a-41ad-9dad-53c7432f2290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53f383ead0>]}
[0m00:18:39.064213 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m00:18:39.065320 [info ] [MainThread]: 
[0m00:18:39.070991 [debug] [Thread-1 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m00:18:39.071739 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m00:18:39.072251 [debug] [Thread-3 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:18:39.073397 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m00:18:39.074382 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_stg_coffee_shop_customers_customer_id__1__2__3  [RUN]
[0m00:18:39.075005 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_coffee_shop_customers_customer_id ............... [RUN]
[0m00:18:39.075734 [info ] [Thread-3 (]: 3 of 4 START test relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_  [RUN]
[0m00:18:39.079709 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m00:18:39.076515 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_coffee_shop_customers_customer_id ................. [RUN]
[0m00:18:39.081757 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m00:18:39.077562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22)
[0m00:18:39.080274 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:18:39.078668 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m00:18:39.082296 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m00:18:39.082854 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m00:18:39.097233 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m00:18:39.097929 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m00:18:39.105372 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m00:18:39.113837 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m00:18:39.126612 [debug] [Thread-3 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 00:18:39.083225 => 00:18:39.126228
[0m00:18:39.129849 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m00:18:39.130723 [debug] [Thread-3 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:18:39.131604 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 00:18:39.098367 => 00:18:39.131246
[0m00:18:39.132728 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 00:18:39.114508 => 00:18:39.132368
[0m00:18:39.141887 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 00:18:39.105792 => 00:18:39.141543
[0m00:18:39.153360 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m00:18:39.153870 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m00:18:39.154440 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m00:18:39.154982 [debug] [Thread-1 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m00:18:39.155975 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:18:39.158899 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m00:18:39.161729 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m00:18:39.164444 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m00:18:39.167020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:18:39.165968 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:18:39.167580 [debug] [Thread-1 (]: On test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_id as value_field,
        count(*) as n_records

    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
    group by customer_id

)

select *
from all_values
where value_field not in (
    '1','2','3'
)



      
    ) dbt_internal_test
[0m00:18:39.165040 [debug] [Thread-3 (]: On test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
    where customer_id is not null
),

parent as (
    select id as to_field
    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:18:39.168388 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:18:39.173308 [debug] [Thread-2 (]: On test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
where customer_id is null



      
    ) dbt_internal_test
[0m00:18:39.168809 [debug] [Thread-4 (]: On test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m00:18:39.853844 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_id at [14:11]')
[0m00:18:39.859313 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_id at [15:7]')
[0m00:18:39.874481 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_id at [14:9]')
[0m00:18:39.880308 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_id at [15:9]')
[0m00:18:40.373621 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fa0d8eb9-4788-48af-9db3-417040607d7a&page=queryresults
[0m00:18:40.374941 [debug] [Thread-3 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 00:18:39.133218 => 00:18:40.374618
[0m00:18:40.378750 [debug] [Thread-3 (]: Database Error in test relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_ (models/schema.yml)
  Unrecognized name: customer_id at [14:11]
  compiled Code at target/run/coffee_shop/models/schema.yml/relationships_stg_coffee_shop__65ce62c470d3edd2c115b74949771b93.sql
[0m00:18:40.379535 [error] [Thread-3 (]: 3 of 4 ERROR relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_  [[31mERROR[0m in 1.30s]
[0m00:18:40.381116 [debug] [Thread-3 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:18:40.550981 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:eefcf576-13f6-404e-b245-f4b3821f11a5&page=queryresults
[0m00:18:40.552479 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 00:18:39.159251 => 00:18:40.552064
[0m00:18:40.554520 [debug] [Thread-2 (]: Database Error in test not_null_stg_coffee_shop_customers_customer_id (models/customers_test.yml)
  Unrecognized name: customer_id at [15:7]
  compiled Code at target/run/coffee_shop/models/customers_test.yml/not_null_stg_coffee_shop_customers_customer_id.sql
[0m00:18:40.555345 [error] [Thread-2 (]: 2 of 4 ERROR not_null_stg_coffee_shop_customers_customer_id .................... [[31mERROR[0m in 1.48s]
[0m00:18:40.556298 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m00:18:40.657016 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:48192ccd-bfc0-4ac7-92d9-3b5b1814e748&page=queryresults
[0m00:18:40.658519 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 00:18:39.162110 => 00:18:40.658120
[0m00:18:40.660625 [debug] [Thread-1 (]: Database Error in test accepted_values_stg_coffee_shop_customers_customer_id__1__2__3 (models/customers_test.yml)
  Unrecognized name: customer_id at [14:9]
  compiled Code at target/run/coffee_shop/models/customers_test.yml/accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.sql
[0m00:18:40.661426 [error] [Thread-1 (]: 1 of 4 ERROR accepted_values_stg_coffee_shop_customers_customer_id__1__2__3 .... [[31mERROR[0m in 1.58s]
[0m00:18:40.662179 [debug] [Thread-1 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m00:18:41.135984 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fa403b84-9f3a-488c-85b9-447e9be134f3&page=queryresults
[0m00:18:41.137486 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 00:18:39.156288 => 00:18:41.137160
[0m00:18:41.139209 [debug] [Thread-4 (]: Database Error in test unique_stg_coffee_shop_customers_customer_id (models/customers_test.yml)
  Unrecognized name: customer_id at [15:9]
  compiled Code at target/run/coffee_shop/models/customers_test.yml/unique_stg_coffee_shop_customers_customer_id.sql
[0m00:18:41.139915 [error] [Thread-4 (]: 4 of 4 ERROR unique_stg_coffee_shop_customers_customer_id ...................... [[31mERROR[0m in 2.06s]
[0m00:18:41.140711 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m00:18:41.145631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:41.146186 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m00:18:41.146599 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m00:18:41.146979 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m00:18:41.147347 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m00:18:41.147799 [info ] [MainThread]: 
[0m00:18:41.148727 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m00:18:41.149925 [debug] [MainThread]: Command end result
[0m00:18:41.159016 [info ] [MainThread]: 
[0m00:18:41.159969 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:18:41.160568 [info ] [MainThread]: 
[0m00:18:41.161142 [error] [MainThread]: [33mDatabase Error in test relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_ (models/schema.yml)[0m
[0m00:18:41.161681 [error] [MainThread]:   Unrecognized name: customer_id at [14:11]
[0m00:18:41.162219 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/schema.yml/relationships_stg_coffee_shop__65ce62c470d3edd2c115b74949771b93.sql
[0m00:18:41.162760 [info ] [MainThread]: 
[0m00:18:41.163298 [error] [MainThread]: [33mDatabase Error in test not_null_stg_coffee_shop_customers_customer_id (models/customers_test.yml)[0m
[0m00:18:41.163823 [error] [MainThread]:   Unrecognized name: customer_id at [15:7]
[0m00:18:41.164398 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers_test.yml/not_null_stg_coffee_shop_customers_customer_id.sql
[0m00:18:41.165062 [info ] [MainThread]: 
[0m00:18:41.165722 [error] [MainThread]: [33mDatabase Error in test accepted_values_stg_coffee_shop_customers_customer_id__1__2__3 (models/customers_test.yml)[0m
[0m00:18:41.166471 [error] [MainThread]:   Unrecognized name: customer_id at [14:9]
[0m00:18:41.167029 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers_test.yml/accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.sql
[0m00:18:41.167568 [info ] [MainThread]: 
[0m00:18:41.168102 [error] [MainThread]: [33mDatabase Error in test unique_stg_coffee_shop_customers_customer_id (models/customers_test.yml)[0m
[0m00:18:41.168651 [error] [MainThread]:   Unrecognized name: customer_id at [15:9]
[0m00:18:41.169225 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers_test.yml/unique_stg_coffee_shop_customers_customer_id.sql
[0m00:18:41.169864 [info ] [MainThread]: 
[0m00:18:41.170498 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:18:41.171733 [debug] [MainThread]: Command `dbt test` failed at 00:18:41.171552 after 3.71 seconds
[0m00:18:41.172323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53f6866bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53f38a7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53f3747610>]}
[0m00:18:41.172854 [debug] [MainThread]: Flushing usage events
[0m00:22:29.921873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262770ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26261b7dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26261b7ca0>]}


============================== 00:22:29.925208 | d5485848-5ee4-463c-8b54-c4b35dba0210 ==============================
[0m00:22:29.925208 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:22:29.926053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:22:30.370422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5485848-5ee4-463c-8b54-c4b35dba0210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26246cbac0>]}
[0m00:22:30.389024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5485848-5ee4-463c-8b54-c4b35dba0210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262469f640>]}
[0m00:22:30.390155 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:22:30.402774 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:22:30.438498 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m00:22:30.439688 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/customers_test.yml
[0m00:22:30.521724 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_customers.sql
[0m00:22:30.616979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5485848-5ee4-463c-8b54-c4b35dba0210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2624525c00>]}
[0m00:22:30.626159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5485848-5ee4-463c-8b54-c4b35dba0210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262446abc0>]}
[0m00:22:30.626860 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:22:30.627566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5485848-5ee4-463c-8b54-c4b35dba0210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26244684f0>]}
[0m00:22:30.629284 [info ] [MainThread]: 
[0m00:22:30.630296 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:22:30.631816 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m00:22:30.632475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:31.732139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m00:22:31.732963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:22:31.987689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5485848-5ee4-463c-8b54-c4b35dba0210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262446a170>]}
[0m00:22:31.989123 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m00:22:31.990111 [info ] [MainThread]: 
[0m00:22:31.995574 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m00:22:31.996972 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m00:22:31.997982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m00:22:31.998505 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m00:22:32.002168 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m00:22:32.003181 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 00:22:31.998847 => 00:22:32.002820
[0m00:22:32.003842 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m00:22:32.041270 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m00:22:32.042568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:32.043200 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
),

renamed as (
  select *
  from source
)

select *
from renamed;


[0m00:22:32.822954 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0ae8624c-ab1b-4404-a27d-4bd55c25c4c0&page=queryresults
[0m00:22:32.842275 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 00:22:32.004186 => 00:22:32.842028
[0m00:22:32.843367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5485848-5ee4-463c-8b54-c4b35dba0210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262445bdf0>]}
[0m00:22:32.844264 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_customers .......... [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m00:22:32.845225 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m00:22:32.846278 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:22:32.847062 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.stg_coffee_shop_monthly_orders .......... [RUN]
[0m00:22:32.848065 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m00:22:32.848594 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:22:32.851893 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m00:22:32.853059 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 00:22:32.848899 => 00:22:32.852529
[0m00:22:32.853714 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:22:32.858230 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m00:22:32.859208 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:22:32.859763 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop_monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
  OPTIONS()
  as select
	
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`;


[0m00:22:33.612007 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:127df5b8-21a0-43e7-b59b-301484a467b0&page=queryresults
[0m00:22:33.615400 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 00:22:32.854086 => 00:22:33.615112
[0m00:22:33.616413 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5485848-5ee4-463c-8b54-c4b35dba0210', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262445bdf0>]}
[0m00:22:33.617208 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_monthly_orders ..... [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m00:22:33.618107 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:22:33.620576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:33.620996 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m00:22:33.621402 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m00:22:33.621860 [info ] [MainThread]: 
[0m00:22:33.622718 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m00:22:33.623974 [debug] [MainThread]: Command end result
[0m00:22:33.634485 [info ] [MainThread]: 
[0m00:22:33.635248 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:22:33.635815 [info ] [MainThread]: 
[0m00:22:33.636425 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:22:33.637329 [debug] [MainThread]: Command `dbt run` succeeded at 00:22:33.637196 after 3.72 seconds
[0m00:22:33.637815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f262770ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26244953c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26246c9f00>]}
[0m00:22:33.638324 [debug] [MainThread]: Flushing usage events
[0m00:22:39.625556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9632c0ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96316c3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96316c3c10>]}


============================== 00:22:39.628709 | eb80ebd0-446e-4b80-a5f2-815c68101b06 ==============================
[0m00:22:39.628709 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:22:39.629897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:22:40.015859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb80ebd0-446e-4b80-a5f2-815c68101b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962fbdbc10>]}
[0m00:22:40.034089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb80ebd0-446e-4b80-a5f2-815c68101b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962fbaba90>]}
[0m00:22:40.035249 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:22:40.047413 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:22:40.077106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:22:40.077775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:22:40.084846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb80ebd0-446e-4b80-a5f2-815c68101b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962f9a40d0>]}
[0m00:22:40.094453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb80ebd0-446e-4b80-a5f2-815c68101b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962f976cb0>]}
[0m00:22:40.095136 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:22:40.095771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb80ebd0-446e-4b80-a5f2-815c68101b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962f976d40>]}
[0m00:22:40.097579 [info ] [MainThread]: 
[0m00:22:40.098590 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:22:40.100068 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m00:22:40.101025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:41.224877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb80ebd0-446e-4b80-a5f2-815c68101b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962f976b90>]}
[0m00:22:41.226223 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m00:22:41.227032 [info ] [MainThread]: 
[0m00:22:41.232471 [debug] [Thread-1 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m00:22:41.234897 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_stg_coffee_shop_customers_customer_id__1__2__3  [RUN]
[0m00:22:41.235885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22)
[0m00:22:41.234339 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m00:22:41.236944 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_coffee_shop_customers_customer_id ................. [RUN]
[0m00:22:41.233712 [debug] [Thread-3 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:22:41.238588 [info ] [Thread-3 (]: 3 of 4 START test relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_  [RUN]
[0m00:22:41.239559 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m00:22:41.236408 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m00:22:41.233058 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m00:22:41.254393 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_coffee_shop_customers_customer_id ............... [RUN]
[0m00:22:41.240039 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:22:41.253717 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m00:22:41.238051 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7'
[0m00:22:41.255563 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19'
[0m00:22:41.265756 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m00:22:41.266700 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m00:22:41.267406 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m00:22:41.275343 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m00:22:41.280622 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (compile): 00:22:41.240685 => 00:22:41.280150
[0m00:22:41.287519 [debug] [Thread-3 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 00:22:41.255944 => 00:22:41.287220
[0m00:22:41.290695 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m00:22:41.291734 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (compile): 00:22:41.268029 => 00:22:41.291365
[0m00:22:41.292485 [debug] [Thread-1 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m00:22:41.293030 [debug] [Thread-3 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:22:41.294034 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m00:22:41.301940 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (compile): 00:22:41.275755 => 00:22:41.301551
[0m00:22:41.327460 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m00:22:41.329200 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"
[0m00:22:41.332423 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"
[0m00:22:41.333122 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m00:22:41.334092 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:22:41.342544 [debug] [Thread-3 (]: On test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
    where customer_id is not null
),

parent as (
    select id as to_field
    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:22:41.341296 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"
[0m00:22:41.341942 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:22:41.346623 [debug] [Thread-4 (]: On test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m00:22:41.345980 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:22:41.337768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:22:41.349010 [debug] [Thread-2 (]: On test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
where customer_id is null



      
    ) dbt_internal_test
[0m00:22:41.350564 [debug] [Thread-1 (]: On test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        customer_id as value_field,
        count(*) as n_records

    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
    group by customer_id

)

select *
from all_values
where value_field not in (
    '1','2','3'
)



      
    ) dbt_internal_test
[0m00:22:42.049690 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_id at [15:7]')
[0m00:22:42.089689 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_id at [15:9]')
[0m00:22:42.104809 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_id at [14:9]')
[0m00:22:42.142293 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_id at [14:11]')
[0m00:22:42.611327 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:199c8fe7-6b03-46c8-85af-96c3c52fb9c3&page=queryresults
[0m00:22:42.612735 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19 (execute): 00:22:41.338437 => 00:22:42.612402
[0m00:22:42.616186 [debug] [Thread-2 (]: Database Error in test not_null_stg_coffee_shop_customers_customer_id (models/staging/coffee_shop/customers_test.yml)
  Unrecognized name: customer_id at [15:7]
  compiled Code at target/run/coffee_shop/models/staging/coffee_shop/customers_test.yml/not_null_stg_coffee_shop_customers_customer_id.sql
[0m00:22:42.616955 [error] [Thread-2 (]: 2 of 4 ERROR not_null_stg_coffee_shop_customers_customer_id .................... [[31mERROR[0m in 1.36s]
[0m00:22:42.618078 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19
[0m00:22:42.793722 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f692e682-4962-4616-9cb5-705186187bf0&page=queryresults
[0m00:22:42.795412 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7 (execute): 00:22:41.329662 => 00:22:42.795003
[0m00:22:42.797651 [debug] [Thread-4 (]: Database Error in test unique_stg_coffee_shop_customers_customer_id (models/staging/coffee_shop/customers_test.yml)
  Unrecognized name: customer_id at [15:9]
  compiled Code at target/run/coffee_shop/models/staging/coffee_shop/customers_test.yml/unique_stg_coffee_shop_customers_customer_id.sql
[0m00:22:42.798535 [error] [Thread-4 (]: 4 of 4 ERROR unique_stg_coffee_shop_customers_customer_id ...................... [[31mERROR[0m in 1.56s]
[0m00:22:42.799437 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7
[0m00:22:42.814495 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7b09707c-244c-4af1-b547-3e717475dc6d&page=queryresults
[0m00:22:42.815793 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22 (execute): 00:22:41.294507 => 00:22:42.815521
[0m00:22:42.819531 [debug] [Thread-1 (]: Database Error in test accepted_values_stg_coffee_shop_customers_customer_id__1__2__3 (models/staging/coffee_shop/customers_test.yml)
  Unrecognized name: customer_id at [14:9]
  compiled Code at target/run/coffee_shop/models/staging/coffee_shop/customers_test.yml/accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.sql
[0m00:22:42.821451 [error] [Thread-1 (]: 1 of 4 ERROR accepted_values_stg_coffee_shop_customers_customer_id__1__2__3 .... [[31mERROR[0m in 1.59s]
[0m00:22:42.823643 [debug] [Thread-1 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22
[0m00:22:43.249669 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ace1faff-9cd4-4324-8144-0be5684c0b34&page=queryresults
[0m00:22:43.251220 [debug] [Thread-3 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 00:22:41.302238 => 00:22:43.250819
[0m00:22:43.253211 [debug] [Thread-3 (]: Database Error in test relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_ (models/schema.yml)
  Unrecognized name: customer_id at [14:11]
  compiled Code at target/run/coffee_shop/models/schema.yml/relationships_stg_coffee_shop__65ce62c470d3edd2c115b74949771b93.sql
[0m00:22:43.253917 [error] [Thread-3 (]: 3 of 4 ERROR relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_  [[31mERROR[0m in 2.01s]
[0m00:22:43.254711 [debug] [Thread-3 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:22:43.257895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:43.258291 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.e3ee874d22' was properly closed.
[0m00:22:43.258679 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_customer_id.d8a55d7bb7' was properly closed.
[0m00:22:43.259056 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m00:22:43.259425 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_customer_id.bbf38bee19' was properly closed.
[0m00:22:43.259870 [info ] [MainThread]: 
[0m00:22:43.260569 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m00:22:43.261498 [debug] [MainThread]: Command end result
[0m00:22:43.272069 [info ] [MainThread]: 
[0m00:22:43.272930 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m00:22:43.273507 [info ] [MainThread]: 
[0m00:22:43.274816 [error] [MainThread]: [33mDatabase Error in test not_null_stg_coffee_shop_customers_customer_id (models/staging/coffee_shop/customers_test.yml)[0m
[0m00:22:43.275372 [error] [MainThread]:   Unrecognized name: customer_id at [15:7]
[0m00:22:43.275916 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/staging/coffee_shop/customers_test.yml/not_null_stg_coffee_shop_customers_customer_id.sql
[0m00:22:43.276502 [info ] [MainThread]: 
[0m00:22:43.277053 [error] [MainThread]: [33mDatabase Error in test unique_stg_coffee_shop_customers_customer_id (models/staging/coffee_shop/customers_test.yml)[0m
[0m00:22:43.277617 [error] [MainThread]:   Unrecognized name: customer_id at [15:9]
[0m00:22:43.278308 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/staging/coffee_shop/customers_test.yml/unique_stg_coffee_shop_customers_customer_id.sql
[0m00:22:43.278881 [info ] [MainThread]: 
[0m00:22:43.279934 [error] [MainThread]: [33mDatabase Error in test accepted_values_stg_coffee_shop_customers_customer_id__1__2__3 (models/staging/coffee_shop/customers_test.yml)[0m
[0m00:22:43.280514 [error] [MainThread]:   Unrecognized name: customer_id at [14:9]
[0m00:22:43.281048 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/staging/coffee_shop/customers_test.yml/accepted_values_stg_coffee_shop_customers_customer_id__1__2__3.sql
[0m00:22:43.281575 [info ] [MainThread]: 
[0m00:22:43.282110 [error] [MainThread]: [33mDatabase Error in test relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_ (models/schema.yml)[0m
[0m00:22:43.282630 [error] [MainThread]:   Unrecognized name: customer_id at [14:11]
[0m00:22:43.283192 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/schema.yml/relationships_stg_coffee_shop__65ce62c470d3edd2c115b74949771b93.sql
[0m00:22:43.283826 [info ] [MainThread]: 
[0m00:22:43.284467 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m00:22:43.285926 [debug] [MainThread]: Command `dbt test` failed at 00:22:43.285784 after 3.67 seconds
[0m00:22:43.286412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9632c0ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962fbd9ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f962f9973d0>]}
[0m00:22:43.286925 [debug] [MainThread]: Flushing usage events
[0m00:23:53.717074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec3b62c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec26c3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec26c3cd0>]}


============================== 00:23:53.720192 | 8ad493da-8ad6-49a8-9269-d1879235ba53 ==============================
[0m00:23:53.720192 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:23:53.721099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:23:54.134569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ad493da-8ad6-49a8-9269-d1879235ba53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec0bb29b0>]}
[0m00:23:54.152524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ad493da-8ad6-49a8-9269-d1879235ba53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec0be73d0>]}
[0m00:23:54.153688 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:23:54.166228 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:23:54.210012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:23:54.211539 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/customers_test.yml
[0m00:23:54.240894 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_customers.sql
[0m00:23:54.353358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ad493da-8ad6-49a8-9269-d1879235ba53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec0a298d0>]}
[0m00:23:54.362644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ad493da-8ad6-49a8-9269-d1879235ba53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec0972620>]}
[0m00:23:54.363390 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:23:54.364155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ad493da-8ad6-49a8-9269-d1879235ba53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec0970040>]}
[0m00:23:54.367722 [info ] [MainThread]: 
[0m00:23:54.369667 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:23:54.375669 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m00:23:54.376750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:55.558729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m00:23:55.559590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:55.797138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ad493da-8ad6-49a8-9269-d1879235ba53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec0971750>]}
[0m00:23:55.798581 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m00:23:55.799408 [info ] [MainThread]: 
[0m00:23:55.806471 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m00:23:55.807499 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m00:23:55.808531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m00:23:55.809024 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m00:23:55.812708 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m00:23:55.813631 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 00:23:55.809330 => 00:23:55.813280
[0m00:23:55.814259 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m00:23:55.851115 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m00:23:55.852472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:55.853116 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
),

renamed as (
  select *
  from source
)

select *
from renamed;


[0m00:23:56.718674 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:207ff45f-0f0c-4978-926b-2dd9c1b06266&page=queryresults
[0m00:23:56.737521 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 00:23:55.814693 => 00:23:56.737277
[0m00:23:56.738604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ad493da-8ad6-49a8-9269-d1879235ba53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec096b490>]}
[0m00:23:56.739504 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_customers .......... [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m00:23:56.740518 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m00:23:56.741654 [debug] [Thread-4 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:23:56.742299 [info ] [Thread-4 (]: 2 of 2 START sql view model dbt_marcel.stg_coffee_shop_monthly_orders .......... [RUN]
[0m00:23:56.743351 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m00:23:56.743829 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:23:56.747786 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m00:23:56.749369 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 00:23:56.744132 => 00:23:56.749090
[0m00:23:56.749882 [debug] [Thread-4 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:23:56.753821 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m00:23:56.754696 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:23:56.755305 [debug] [Thread-4 (]: On model.coffee_shop.stg_coffee_shop_monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
  OPTIONS()
  as select
	
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`;


[0m00:23:57.729547 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6b29dae1-1cc0-4b5a-a402-ddee28bcaf0b&page=queryresults
[0m00:23:57.732567 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 00:23:56.750213 => 00:23:57.732322
[0m00:23:57.733563 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ad493da-8ad6-49a8-9269-d1879235ba53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec04e8df0>]}
[0m00:23:57.734354 [info ] [Thread-4 (]: 2 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_monthly_orders ..... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m00:23:57.735262 [debug] [Thread-4 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:23:57.737502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:57.737886 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m00:23:57.738272 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m00:23:57.738728 [info ] [MainThread]: 
[0m00:23:57.739248 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m00:23:57.740344 [debug] [MainThread]: Command end result
[0m00:23:57.750264 [info ] [MainThread]: 
[0m00:23:57.751186 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:23:57.751790 [info ] [MainThread]: 
[0m00:23:57.752593 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:23:57.753591 [debug] [MainThread]: Command `dbt run` succeeded at 00:23:57.753454 after 4.04 seconds
[0m00:23:57.754088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec3b62c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec0be73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faec0971ff0>]}
[0m00:23:57.754604 [debug] [MainThread]: Flushing usage events
[0m00:24:03.934710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047f8cabc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047e3bfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047e3bfc40>]}


============================== 00:24:03.937934 | a3709302-e93a-4baf-8463-7001a4bdcbf6 ==============================
[0m00:24:03.937934 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:24:03.938751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:24:04.319159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3709302-e93a-4baf-8463-7001a4bdcbf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047c8adc00>]}
[0m00:24:04.345786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3709302-e93a-4baf-8463-7001a4bdcbf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047c8e1480>]}
[0m00:24:04.346889 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:24:04.359160 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:24:04.386149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:24:04.386840 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:24:04.397663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3709302-e93a-4baf-8463-7001a4bdcbf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047c6a00d0>]}
[0m00:24:04.415382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3709302-e93a-4baf-8463-7001a4bdcbf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047c672800>]}
[0m00:24:04.416632 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:24:04.417908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3709302-e93a-4baf-8463-7001a4bdcbf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047c672890>]}
[0m00:24:04.421604 [info ] [MainThread]: 
[0m00:24:04.426054 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:24:04.428183 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m00:24:04.429402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:05.535061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3709302-e93a-4baf-8463-7001a4bdcbf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047c6726e0>]}
[0m00:24:05.536356 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m00:24:05.537206 [info ] [MainThread]: 
[0m00:24:05.542341 [debug] [Thread-1 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea
[0m00:24:05.543114 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_stg_coffee_shop_customers_id__1__2__3 ........ [RUN]
[0m00:24:05.545964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea)
[0m00:24:05.544766 [debug] [Thread-3 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:24:05.547418 [info ] [Thread-3 (]: 3 of 4 START test relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_  [RUN]
[0m00:24:05.548814 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m00:24:05.544095 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e
[0m00:24:05.546678 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea
[0m00:24:05.549666 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6
[0m00:24:05.560599 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_coffee_shop_customers_id .......................... [RUN]
[0m00:24:05.561867 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6'
[0m00:24:05.550158 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:24:05.550698 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_coffee_shop_customers_id ........................ [RUN]
[0m00:24:05.562410 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6
[0m00:24:05.576524 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea"
[0m00:24:05.580890 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m00:24:05.582070 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e'
[0m00:24:05.591647 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e
[0m00:24:05.590760 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea (compile): 00:24:05.551332 => 00:24:05.590344
[0m00:24:05.589623 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6"
[0m00:24:05.597366 [debug] [Thread-1 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea
[0m00:24:05.597939 [debug] [Thread-3 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 00:24:05.567950 => 00:24:05.597677
[0m00:24:05.607304 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e"
[0m00:24:05.630837 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e (compile): 00:24:05.592175 => 00:24:05.630475
[0m00:24:05.628870 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea"
[0m00:24:05.629883 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6 (compile): 00:24:05.582516 => 00:24:05.629510
[0m00:24:05.632114 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6
[0m00:24:05.635304 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6"
[0m00:24:05.631385 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e
[0m00:24:05.613585 [debug] [Thread-3 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:24:05.636158 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:24:05.639293 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e"
[0m00:24:05.639801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:05.642689 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m00:24:05.643315 [debug] [Thread-4 (]: On test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m00:24:05.644094 [debug] [Thread-1 (]: On test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        id as value_field,
        count(*) as n_records

    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
    group by id

)

select *
from all_values
where value_field not in (
    '1','2','3'
)



      
    ) dbt_internal_test
[0m00:24:05.644886 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:24:05.650167 [debug] [Thread-2 (]: On test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
where id is null



      
    ) dbt_internal_test
[0m00:24:05.647947 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:24:05.652986 [debug] [Thread-3 (]: On test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
    where customer_id is not null
),

parent as (
    select id as to_field
    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:24:06.375783 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_id at [14:11]')
[0m00:24:06.795222 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:47d8d75e-fd26-4eb4-910a-a87c41e77a40&page=queryresults
[0m00:24:06.796775 [debug] [Thread-3 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 00:24:05.640202 => 00:24:06.796381
[0m00:24:06.801215 [debug] [Thread-3 (]: Database Error in test relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_ (models/schema.yml)
  Unrecognized name: customer_id at [14:11]
  compiled Code at target/run/coffee_shop/models/schema.yml/relationships_stg_coffee_shop__65ce62c470d3edd2c115b74949771b93.sql
[0m00:24:06.802362 [error] [Thread-3 (]: 3 of 4 ERROR relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_  [[31mERROR[0m in 1.25s]
[0m00:24:06.803260 [debug] [Thread-3 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:24:07.430008 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8da9890e-23b8-4a19-987f-c3f001b15663&page=queryresults
[0m00:24:07.432697 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e (execute): 00:24:05.636662 => 00:24:07.432265
[0m00:24:07.434091 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_coffee_shop_customers_id .............................. [[32mPASS[0m in 1.85s]
[0m00:24:07.436004 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e
[0m00:24:07.865724 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a3bc43a2-275c-4dba-bb97-1078b724522f&page=queryresults
[0m00:24:07.867219 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea (execute): 00:24:05.607923 => 00:24:07.866843
[0m00:24:07.868538 [error] [Thread-1 (]: 1 of 4 FAIL 174397 accepted_values_stg_coffee_shop_customers_id__1__2__3 ....... [[31mFAIL 174397[0m in 2.32s]
[0m00:24:07.869683 [debug] [Thread-1 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea
[0m00:24:07.911326 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a8f278f4-53f2-490b-b5ca-5cb213bda182&page=queryresults
[0m00:24:07.912836 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6 (execute): 00:24:05.632551 => 00:24:07.912467
[0m00:24:07.914142 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_coffee_shop_customers_id ................................ [[32mPASS[0m in 2.35s]
[0m00:24:07.915319 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6
[0m00:24:07.918148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:07.918735 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea' was properly closed.
[0m00:24:07.919196 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m00:24:07.919644 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6' was properly closed.
[0m00:24:07.920116 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e' was properly closed.
[0m00:24:07.920983 [info ] [MainThread]: 
[0m00:24:07.921701 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m00:24:07.924239 [debug] [MainThread]: Command end result
[0m00:24:07.945742 [info ] [MainThread]: 
[0m00:24:07.947087 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:24:07.947944 [info ] [MainThread]: 
[0m00:24:07.948762 [error] [MainThread]: [33mDatabase Error in test relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_ (models/schema.yml)[0m
[0m00:24:07.949521 [error] [MainThread]:   Unrecognized name: customer_id at [14:11]
[0m00:24:07.950242 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/schema.yml/relationships_stg_coffee_shop__65ce62c470d3edd2c115b74949771b93.sql
[0m00:24:07.950959 [info ] [MainThread]: 
[0m00:24:07.951719 [error] [MainThread]: [31mFailure in test accepted_values_stg_coffee_shop_customers_id__1__2__3 (models/staging/coffee_shop/customers_test.yml)[0m
[0m00:24:07.952489 [error] [MainThread]:   Got 174397 results, configured to fail if != 0
[0m00:24:07.956773 [info ] [MainThread]: 
[0m00:24:07.957632 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/staging/coffee_shop/customers_test.yml/accepted_values_stg_coffee_shop_customers_id__1__2__3.sql
[0m00:24:07.958436 [info ] [MainThread]: 
[0m00:24:07.959167 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m00:24:07.960338 [debug] [MainThread]: Command `dbt test` failed at 00:24:07.960091 after 4.03 seconds
[0m00:24:07.961039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047f8cabc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047c693460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047c691930>]}
[0m00:24:07.961604 [debug] [MainThread]: Flushing usage events
[0m00:24:43.953334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6cd732bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6cc297d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6cc297c70>]}


============================== 00:24:43.956638 | f9031258-c62f-4b09-8cf1-771f2e2b93a9 ==============================
[0m00:24:43.956638 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:24:43.957525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:24:44.381055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9031258-c62f-4b09-8cf1-771f2e2b93a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6cd4e1a50>]}
[0m00:24:44.398611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9031258-c62f-4b09-8cf1-771f2e2b93a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ca7b5540>]}
[0m00:24:44.399695 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:24:44.411674 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:24:44.438408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:24:44.438914 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:24:44.445860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9031258-c62f-4b09-8cf1-771f2e2b93a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ca577ee0>]}
[0m00:24:44.454659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9031258-c62f-4b09-8cf1-771f2e2b93a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ca7426b0>]}
[0m00:24:44.455287 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:24:44.455870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9031258-c62f-4b09-8cf1-771f2e2b93a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ca742740>]}
[0m00:24:44.457524 [info ] [MainThread]: 
[0m00:24:44.458498 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:24:44.459823 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m00:24:44.460511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:45.553258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m00:24:45.554118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:45.770904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9031258-c62f-4b09-8cf1-771f2e2b93a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ca7418a0>]}
[0m00:24:45.772136 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m00:24:45.773012 [info ] [MainThread]: 
[0m00:24:45.780203 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m00:24:45.780999 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m00:24:45.782122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m00:24:45.782630 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m00:24:45.786332 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m00:24:45.787401 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 00:24:45.782968 => 00:24:45.787039
[0m00:24:45.788007 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m00:24:45.827345 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m00:24:45.829628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:45.830623 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
),

renamed as (
  select *
  from source
)

select *
from renamed;


[0m00:24:46.547966 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:30b036cc-7280-4418-9e7b-a8434e7e67eb&page=queryresults
[0m00:24:46.566595 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 00:24:45.788473 => 00:24:46.566340
[0m00:24:46.567672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9031258-c62f-4b09-8cf1-771f2e2b93a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ca7b4a90>]}
[0m00:24:46.568577 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_customers .......... [[32mCREATE VIEW (0 processed)[0m in 0.79s]
[0m00:24:46.569634 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m00:24:46.570762 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:24:46.571414 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.stg_coffee_shop_monthly_orders .......... [RUN]
[0m00:24:46.572545 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m00:24:46.573048 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:24:46.586019 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m00:24:46.587232 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 00:24:46.573385 => 00:24:46.586813
[0m00:24:46.587764 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:24:46.591551 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m00:24:46.592451 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:24:46.593007 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop_monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
  OPTIONS()
  as select
	
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`;


[0m00:24:47.266334 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5046a21e-ad75-4c1e-9efc-e944a1cd4490&page=queryresults
[0m00:24:47.269999 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 00:24:46.588071 => 00:24:47.269712
[0m00:24:47.271228 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9031258-c62f-4b09-8cf1-771f2e2b93a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ca55bc40>]}
[0m00:24:47.272187 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_monthly_orders ..... [[32mCREATE VIEW (0 processed)[0m in 0.70s]
[0m00:24:47.273677 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:24:47.275947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:47.276374 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m00:24:47.276746 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m00:24:47.277194 [info ] [MainThread]: 
[0m00:24:47.277767 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m00:24:47.278996 [debug] [MainThread]: Command end result
[0m00:24:47.289437 [info ] [MainThread]: 
[0m00:24:47.290312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:24:47.290898 [info ] [MainThread]: 
[0m00:24:47.291476 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:24:47.292378 [debug] [MainThread]: Command `dbt run` succeeded at 00:24:47.292236 after 3.35 seconds
[0m00:24:47.292850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6cd732bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ca55bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ca602710>]}
[0m00:24:47.293343 [debug] [MainThread]: Flushing usage events
[0m00:24:56.205231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7647f6abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7646ac3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7646ac3c70>]}


============================== 00:24:56.208427 | 1e88cf8d-8a0c-42dc-b264-b75fb8255fb7 ==============================
[0m00:24:56.208427 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:24:56.209307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:24:56.601228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e88cf8d-8a0c-42dc-b264-b75fb8255fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7644fdbb50>]}
[0m00:24:56.619317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e88cf8d-8a0c-42dc-b264-b75fb8255fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7644fab400>]}
[0m00:24:56.620531 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:24:56.633256 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:24:56.661211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:24:56.661819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:24:56.668803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e88cf8d-8a0c-42dc-b264-b75fb8255fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7644da40d0>]}
[0m00:24:56.678620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e88cf8d-8a0c-42dc-b264-b75fb8255fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7644d76bc0>]}
[0m00:24:56.679308 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:24:56.679940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e88cf8d-8a0c-42dc-b264-b75fb8255fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7644d76c50>]}
[0m00:24:56.681753 [info ] [MainThread]: 
[0m00:24:56.682767 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:24:56.684211 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m00:24:56.684859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:57.843835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e88cf8d-8a0c-42dc-b264-b75fb8255fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7644d76b90>]}
[0m00:24:57.845252 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m00:24:57.845899 [info ] [MainThread]: 
[0m00:24:57.851693 [debug] [Thread-1 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea
[0m00:24:57.853209 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_stg_coffee_shop_customers_id__1__2__3 ........ [RUN]
[0m00:24:57.855222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea)
[0m00:24:57.853863 [debug] [Thread-3 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:24:57.854410 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6
[0m00:24:57.855718 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea
[0m00:24:57.852601 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e
[0m00:24:57.871590 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_coffee_shop_customers_id ........................ [RUN]
[0m00:24:57.856306 [info ] [Thread-3 (]: 3 of 4 START test relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_  [RUN]
[0m00:24:57.857080 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_coffee_shop_customers_id .......................... [RUN]
[0m00:24:57.872678 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e'
[0m00:24:57.870974 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea"
[0m00:24:57.873632 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03'
[0m00:24:57.876490 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:24:57.875778 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e
[0m00:24:57.875247 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6'
[0m00:24:57.891293 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6
[0m00:24:57.917505 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea (compile): 00:24:57.857599 => 00:24:57.916903
[0m00:24:57.918391 [debug] [Thread-1 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea
[0m00:24:57.929028 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6"
[0m00:24:57.930254 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6 (compile): 00:24:57.892723 => 00:24:57.929871
[0m00:24:57.930941 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6
[0m00:24:57.937937 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e"
[0m00:24:57.955097 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m00:24:57.972446 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea"
[0m00:24:57.973753 [debug] [Thread-3 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (compile): 00:24:57.876808 => 00:24:57.973320
[0m00:24:57.974619 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e (compile): 00:24:57.884944 => 00:24:57.974262
[0m00:24:57.975526 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6"
[0m00:24:57.976270 [debug] [Thread-3 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:24:57.976862 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e
[0m00:24:57.977809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:57.984728 [debug] [Thread-1 (]: On test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        id as value_field,
        count(*) as n_records

    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
    group by id

)

select *
from all_values
where value_field not in (
    '1','2','3'
)



      
    ) dbt_internal_test
[0m00:24:57.984011 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e"
[0m00:24:57.981094 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"
[0m00:24:57.988827 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:24:57.986885 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:24:57.989733 [debug] [Thread-3 (]: On test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
    where customer_id is not null
),

parent as (
    select id as to_field
    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:24:57.990439 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:24:57.993150 [debug] [Thread-2 (]: On test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
where id is null



      
    ) dbt_internal_test
[0m00:24:57.990874 [debug] [Thread-4 (]: On test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m00:24:58.682481 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: customer_id at [14:11]')
[0m00:24:59.270693 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:31fa32de-e66e-47ce-a617-3e874146d2b0&page=queryresults
[0m00:24:59.272871 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e (execute): 00:24:57.981485 => 00:24:59.272541
[0m00:24:59.274123 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_coffee_shop_customers_id .............................. [[32mPASS[0m in 1.40s]
[0m00:24:59.275370 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e
[0m00:24:59.621363 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9e1fd6e3-e918-436a-8c83-7c02761987b4&page=queryresults
[0m00:24:59.622666 [debug] [Thread-3 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03 (execute): 00:24:57.978305 => 00:24:59.622334
[0m00:24:59.626209 [debug] [Thread-3 (]: Database Error in test relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_ (models/schema.yml)
  Unrecognized name: customer_id at [14:11]
  compiled Code at target/run/coffee_shop/models/schema.yml/relationships_stg_coffee_shop__65ce62c470d3edd2c115b74949771b93.sql
[0m00:24:59.626934 [error] [Thread-3 (]: 3 of 4 ERROR relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_  [[31mERROR[0m in 1.75s]
[0m00:24:59.627911 [debug] [Thread-3 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03
[0m00:24:59.635528 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7ed9cf8c-e537-4053-bda1-6f0ee67ad5f9&page=queryresults
[0m00:24:59.636689 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea (execute): 00:24:57.918869 => 00:24:59.636398
[0m00:24:59.637739 [error] [Thread-1 (]: 1 of 4 FAIL 174397 accepted_values_stg_coffee_shop_customers_id__1__2__3 ....... [[31mFAIL 174397[0m in 1.78s]
[0m00:24:59.638665 [debug] [Thread-1 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea
[0m00:24:59.640208 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fa31763f-23a7-4d63-948c-19bd26ed8f3f&page=queryresults
[0m00:24:59.641140 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6 (execute): 00:24:57.931402 => 00:24:59.640901
[0m00:24:59.642101 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_coffee_shop_customers_id ................................ [[32mPASS[0m in 1.77s]
[0m00:24:59.642957 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6
[0m00:24:59.645987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:59.646611 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea' was properly closed.
[0m00:24:59.647024 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e' was properly closed.
[0m00:24:59.647432 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_.4207ebba03' was properly closed.
[0m00:24:59.647840 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6' was properly closed.
[0m00:24:59.648307 [info ] [MainThread]: 
[0m00:24:59.648900 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m00:24:59.650185 [debug] [MainThread]: Command end result
[0m00:24:59.659235 [info ] [MainThread]: 
[0m00:24:59.659968 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:24:59.660596 [info ] [MainThread]: 
[0m00:24:59.661186 [error] [MainThread]: [33mDatabase Error in test relationships_stg_coffee_shop_monthly_orders_customer_id__id__ref_stg_coffee_shop_customers_ (models/schema.yml)[0m
[0m00:24:59.661743 [error] [MainThread]:   Unrecognized name: customer_id at [14:11]
[0m00:24:59.662294 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/schema.yml/relationships_stg_coffee_shop__65ce62c470d3edd2c115b74949771b93.sql
[0m00:24:59.663018 [info ] [MainThread]: 
[0m00:24:59.663596 [error] [MainThread]: [31mFailure in test accepted_values_stg_coffee_shop_customers_id__1__2__3 (models/staging/coffee_shop/customers_test.yml)[0m
[0m00:24:59.664183 [error] [MainThread]:   Got 174397 results, configured to fail if != 0
[0m00:24:59.664868 [info ] [MainThread]: 
[0m00:24:59.665456 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/staging/coffee_shop/customers_test.yml/accepted_values_stg_coffee_shop_customers_id__1__2__3.sql
[0m00:24:59.666491 [info ] [MainThread]: 
[0m00:24:59.667094 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m00:24:59.668004 [debug] [MainThread]: Command `dbt test` failed at 00:24:59.667868 after 3.47 seconds
[0m00:24:59.668540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7647f6abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7644fab400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76450c41f0>]}
[0m00:24:59.669075 [debug] [MainThread]: Flushing usage events
[0m00:25:33.454952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd8386b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd6ec3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd6ec3c10>]}


============================== 00:25:33.458313 | 37f4fd70-00d2-464e-b69d-00b7a546e40d ==============================
[0m00:25:33.458313 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:25:33.459170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:25:33.840576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37f4fd70-00d2-464e-b69d-00b7a546e40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd53b7640>]}
[0m00:25:33.868362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37f4fd70-00d2-464e-b69d-00b7a546e40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd53e73a0>]}
[0m00:25:33.870079 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:25:33.895883 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:25:33.935413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:25:33.937121 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/schema.yml
[0m00:25:33.969739 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m00:25:34.047691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37f4fd70-00d2-464e-b69d-00b7a546e40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd522fac0>]}
[0m00:25:34.056970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37f4fd70-00d2-464e-b69d-00b7a546e40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd5172500>]}
[0m00:25:34.057756 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:25:34.058456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f4fd70-00d2-464e-b69d-00b7a546e40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd51725f0>]}
[0m00:25:34.061070 [info ] [MainThread]: 
[0m00:25:34.062647 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:25:34.065237 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m00:25:34.066406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:35.315212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m00:25:35.315993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:25:35.558606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f4fd70-00d2-464e-b69d-00b7a546e40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd5171690>]}
[0m00:25:35.559869 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m00:25:35.560846 [info ] [MainThread]: 
[0m00:25:35.567179 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m00:25:35.568533 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m00:25:35.569827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m00:25:35.570381 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m00:25:35.574404 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m00:25:35.575906 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 00:25:35.570703 => 00:25:35.575541
[0m00:25:35.577039 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m00:25:35.620399 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m00:25:35.621863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:35.622570 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
),

renamed as (
  select *
  from source
)

select *
from renamed;


[0m00:25:36.558151 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a08da54a-3e0f-4f50-9599-c57e6450a511&page=queryresults
[0m00:25:36.589107 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 00:25:35.577416 => 00:25:36.588664
[0m00:25:36.590815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f4fd70-00d2-464e-b69d-00b7a546e40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd4ccbd00>]}
[0m00:25:36.592235 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_customers .......... [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m00:25:36.596809 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m00:25:36.599887 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:25:36.601757 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.stg_coffee_shop_monthly_orders .......... [RUN]
[0m00:25:36.603031 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m00:25:36.603555 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:25:36.607502 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m00:25:36.608629 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 00:25:36.603901 => 00:25:36.608263
[0m00:25:36.609385 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:25:36.613776 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m00:25:36.614675 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:25:36.615295 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop_monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
  OPTIONS()
  as select
	
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`;


[0m00:25:37.539352 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e1564c46-e414-4d4a-9f43-c209369791f9&page=queryresults
[0m00:25:37.543047 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 00:25:36.609824 => 00:25:37.542766
[0m00:25:37.544197 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f4fd70-00d2-464e-b69d-00b7a546e40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd51f8eb0>]}
[0m00:25:37.545011 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_monthly_orders ..... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m00:25:37.545897 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:25:37.548193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:25:37.548616 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m00:25:37.548983 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m00:25:37.549434 [info ] [MainThread]: 
[0m00:25:37.550007 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m00:25:37.551120 [debug] [MainThread]: Command end result
[0m00:25:37.559830 [info ] [MainThread]: 
[0m00:25:37.560772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:25:37.561365 [info ] [MainThread]: 
[0m00:25:37.561953 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:25:37.562845 [debug] [MainThread]: Command `dbt run` succeeded at 00:25:37.562704 after 4.12 seconds
[0m00:25:37.563327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd8386b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd52163b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bd824a1a0>]}
[0m00:25:37.563825 [debug] [MainThread]: Flushing usage events
[0m00:25:43.974385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51ee4ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51d9c7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51d9c7c10>]}


============================== 00:25:43.977573 | e8759ae0-d502-49ce-af45-04b15e87ea29 ==============================
[0m00:25:43.977573 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:25:43.978416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:25:44.429703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8759ae0-d502-49ce-af45-04b15e87ea29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51bedf820>]}
[0m00:25:44.465205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8759ae0-d502-49ce-af45-04b15e87ea29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51beaf7c0>]}
[0m00:25:44.466855 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:25:44.484763 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:25:44.527175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:25:44.527829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:25:44.534751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8759ae0-d502-49ce-af45-04b15e87ea29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51bcac0d0>]}
[0m00:25:44.544416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8759ae0-d502-49ce-af45-04b15e87ea29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51bc7a890>]}
[0m00:25:44.545132 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:25:44.545801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8759ae0-d502-49ce-af45-04b15e87ea29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51bc7a920>]}
[0m00:25:44.547624 [info ] [MainThread]: 
[0m00:25:44.548720 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:25:44.550202 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m00:25:44.550887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:25:45.662882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8759ae0-d502-49ce-af45-04b15e87ea29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51bc7a860>]}
[0m00:25:45.664335 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m00:25:45.665072 [info ] [MainThread]: 
[0m00:25:45.670007 [debug] [Thread-1 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea
[0m00:25:45.670510 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e
[0m00:25:45.670969 [debug] [Thread-3 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_.435789e5f1
[0m00:25:45.672425 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6
[0m00:25:45.671725 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_stg_coffee_shop_customers_id__1__2__3 ........ [RUN]
[0m00:25:45.676939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea)
[0m00:25:45.674319 [info ] [Thread-3 (]: 3 of 4 START test relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_  [RUN]
[0m00:25:45.678815 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_.435789e5f1'
[0m00:25:45.675860 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_coffee_shop_customers_id .......................... [RUN]
[0m00:25:45.680902 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6'
[0m00:25:45.673694 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_coffee_shop_customers_id ........................ [RUN]
[0m00:25:45.682265 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e'
[0m00:25:45.682763 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e
[0m00:25:45.677602 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea
[0m00:25:45.679984 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_.435789e5f1
[0m00:25:45.681378 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6
[0m00:25:45.734917 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_.435789e5f1"
[0m00:25:45.726643 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea"
[0m00:25:45.718210 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e"
[0m00:25:45.746585 [debug] [Thread-3 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_.435789e5f1 (compile): 00:25:45.705690 => 00:25:45.746078
[0m00:25:45.754417 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea (compile): 00:25:45.697726 => 00:25:45.754035
[0m00:25:45.753277 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6"
[0m00:25:45.755113 [debug] [Thread-3 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_.435789e5f1
[0m00:25:45.755734 [debug] [Thread-1 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea
[0m00:25:45.756361 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e (compile): 00:25:45.683104 => 00:25:45.756098
[0m00:25:45.783830 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea"
[0m00:25:45.784716 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e
[0m00:25:45.787027 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_.435789e5f1"
[0m00:25:45.787608 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6 (compile): 00:25:45.735549 => 00:25:45.787357
[0m00:25:45.788629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:25:45.791792 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e"
[0m00:25:45.792765 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:25:45.793300 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6
[0m00:25:45.793883 [debug] [Thread-1 (]: On test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        id as value_field,
        count(*) as n_records

    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
    group by id

)

select *
from all_values
where value_field not in (
    '1','2','3'
)



      
    ) dbt_internal_test
[0m00:25:45.794724 [debug] [Thread-3 (]: On test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_.435789e5f1: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_.435789e5f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select id as from_field
    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
    where id is not null
),

parent as (
    select id as to_field
    from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m00:25:45.798029 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6"
[0m00:25:45.798995 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:25:45.804022 [debug] [Thread-2 (]: On test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
where id is null



      
    ) dbt_internal_test
[0m00:25:45.806775 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:25:45.808546 [debug] [Thread-4 (]: On test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m00:25:46.463911 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: id at [14:11]')
[0m00:25:47.103188 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:820a06c9-1a3f-43e3-9847-142ed8af00a0&page=queryresults
[0m00:25:47.105835 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e (execute): 00:25:45.789025 => 00:25:47.105446
[0m00:25:47.109866 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_coffee_shop_customers_id .............................. [[32mPASS[0m in 1.43s]
[0m00:25:47.111039 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e
[0m00:25:47.463308 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6e5f49c8-4a3c-40ee-92f2-816f33b8a138&page=queryresults
[0m00:25:47.464811 [debug] [Thread-1 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea (execute): 00:25:45.767743 => 00:25:47.464474
[0m00:25:47.465936 [error] [Thread-1 (]: 1 of 4 FAIL 174397 accepted_values_stg_coffee_shop_customers_id__1__2__3 ....... [[31mFAIL 174397[0m in 1.79s]
[0m00:25:47.466920 [debug] [Thread-1 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea
[0m00:25:47.625220 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c6983058-607f-49fb-a370-e0b15da86e02&page=queryresults
[0m00:25:47.626807 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6 (execute): 00:25:45.795231 => 00:25:47.626447
[0m00:25:47.628048 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_coffee_shop_customers_id ................................ [[32mPASS[0m in 1.95s]
[0m00:25:47.629135 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6
[0m00:25:47.742397 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:413e65cd-c00e-42ec-8bb3-2923999eac60&page=queryresults
[0m00:25:47.743934 [debug] [Thread-3 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_.435789e5f1 (execute): 00:25:45.756930 => 00:25:47.743547
[0m00:25:47.748267 [debug] [Thread-3 (]: Database Error in test relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_ (models/schema.yml)
  Unrecognized name: id at [14:11]
  compiled Code at target/run/coffee_shop/models/schema.yml/relationships_stg_coffee_shop__0a3cb519581e29ef2b142f44bc4306b9.sql
[0m00:25:47.749393 [error] [Thread-3 (]: 3 of 4 ERROR relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_  [[31mERROR[0m in 2.07s]
[0m00:25:47.750304 [debug] [Thread-3 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_.435789e5f1
[0m00:25:47.753243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:25:47.753693 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop_customers_id__1__2__3.fe2e9705ea' was properly closed.
[0m00:25:47.754129 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_.435789e5f1' was properly closed.
[0m00:25:47.755348 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop_customers_id.88e62bcde6' was properly closed.
[0m00:25:47.755893 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop_customers_id.e4bfb5425e' was properly closed.
[0m00:25:47.757094 [info ] [MainThread]: 
[0m00:25:47.758023 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m00:25:47.759359 [debug] [MainThread]: Command end result
[0m00:25:47.773725 [info ] [MainThread]: 
[0m00:25:47.774835 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:25:47.775487 [info ] [MainThread]: 
[0m00:25:47.776088 [error] [MainThread]: [31mFailure in test accepted_values_stg_coffee_shop_customers_id__1__2__3 (models/staging/coffee_shop/customers_test.yml)[0m
[0m00:25:47.776698 [error] [MainThread]:   Got 174397 results, configured to fail if != 0
[0m00:25:47.777256 [info ] [MainThread]: 
[0m00:25:47.777819 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/staging/coffee_shop/customers_test.yml/accepted_values_stg_coffee_shop_customers_id__1__2__3.sql
[0m00:25:47.778382 [info ] [MainThread]: 
[0m00:25:47.778955 [error] [MainThread]: [33mDatabase Error in test relationships_stg_coffee_shop_monthly_orders_id__id__ref_stg_coffee_shop_customers_ (models/schema.yml)[0m
[0m00:25:47.779518 [error] [MainThread]:   Unrecognized name: id at [14:11]
[0m00:25:47.780213 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/schema.yml/relationships_stg_coffee_shop__0a3cb519581e29ef2b142f44bc4306b9.sql
[0m00:25:47.780838 [info ] [MainThread]: 
[0m00:25:47.781586 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m00:25:47.783003 [debug] [MainThread]: Command `dbt test` failed at 00:25:47.782860 after 3.82 seconds
[0m00:25:47.783626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51ee4ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51bba7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51bba5420>]}
[0m00:25:47.784177 [debug] [MainThread]: Flushing usage events
[0m00:28:27.636360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adfc96b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ade7bfd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ade7bfc10>]}


============================== 00:28:27.639383 | d2e21fe0-e257-4197-b56d-3dd45a4a7ac0 ==============================
[0m00:28:27.639383 [info ] [MainThread]: Running with dbt=1.5.2
[0m00:28:27.640203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m00:28:28.042536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2e21fe0-e257-4197-b56d-3dd45a4a7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adccd3940>]}
[0m00:28:28.060875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2e21fe0-e257-4197-b56d-3dd45a4a7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adcca7550>]}
[0m00:28:28.062022 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:28:28.074498 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m00:28:28.101944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:28:28.102975 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/schema.yml
[0m00:28:28.139886 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m00:28:28.227757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2e21fe0-e257-4197-b56d-3dd45a4a7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adcb2a0e0>]}
[0m00:28:28.237599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2e21fe0-e257-4197-b56d-3dd45a4a7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adca72ad0>]}
[0m00:28:28.238336 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m00:28:28.238998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e21fe0-e257-4197-b56d-3dd45a4a7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adca70400>]}
[0m00:28:28.240828 [info ] [MainThread]: 
[0m00:28:28.241930 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:28:28.244065 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m00:28:28.244665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:28:29.366324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m00:28:29.367194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:28:29.588092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e21fe0-e257-4197-b56d-3dd45a4a7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adca71f00>]}
[0m00:28:29.589799 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m00:28:29.591328 [info ] [MainThread]: 
[0m00:28:29.598464 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m00:28:29.600006 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m00:28:29.601732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m00:28:29.602506 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m00:28:29.608478 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m00:28:29.610341 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 00:28:29.603113 => 00:28:29.609967
[0m00:28:29.611110 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m00:28:29.653952 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m00:28:29.655150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:28:29.655861 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
),

renamed as (
  select *
  from source
)

select *
from renamed;


[0m00:28:30.438324 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1eb3395a-f88f-45dd-85e1-3b01222639bd&page=queryresults
[0m00:28:30.456459 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 00:28:29.611767 => 00:28:30.456172
[0m00:28:30.457528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2e21fe0-e257-4197-b56d-3dd45a4a7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adc5c3c40>]}
[0m00:28:30.458374 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_customers .......... [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m00:28:30.459313 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m00:28:30.460394 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:28:30.461171 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.stg_coffee_shop_monthly_orders .......... [RUN]
[0m00:28:30.462333 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m00:28:30.462844 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:28:30.468981 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m00:28:30.470845 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 00:28:30.463181 => 00:28:30.470454
[0m00:28:30.472462 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:28:30.480564 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m00:28:30.482303 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:28:30.483117 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop_monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
  OPTIONS()
  as select
	
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`;


[0m00:28:31.453059 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3138c2b9-c824-4204-b0f4-efdbfa45bc1a&page=queryresults
[0m00:28:31.456458 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 00:28:30.473881 => 00:28:31.456200
[0m00:28:31.457439 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2e21fe0-e257-4197-b56d-3dd45a4a7ac0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adc5c6f20>]}
[0m00:28:31.458212 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_monthly_orders ..... [[32mCREATE VIEW (0 processed)[0m in 1.00s]
[0m00:28:31.459095 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m00:28:31.461381 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:28:31.461766 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m00:28:31.462154 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m00:28:31.462604 [info ] [MainThread]: 
[0m00:28:31.463204 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m00:28:31.464431 [debug] [MainThread]: Command end result
[0m00:28:31.474072 [info ] [MainThread]: 
[0m00:28:31.475141 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:28:31.475856 [info ] [MainThread]: 
[0m00:28:31.476582 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:28:31.477476 [debug] [MainThread]: Command `dbt run` succeeded at 00:28:31.477345 after 3.85 seconds
[0m00:28:31.477956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adfc96b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adccd3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5adc5c3c40>]}
[0m00:28:31.478476 [debug] [MainThread]: Flushing usage events
[0m11:57:31.375263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb40c226bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb40ad93d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb40ad93c70>]}


============================== 11:57:31.386949 | f17e3435-fd48-48ca-8e30-7dd768386db7 ==============================
[0m11:57:31.386949 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:57:31.387670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:57:32.493500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f17e3435-fd48-48ca-8e30-7dd768386db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb40bd751e0>]}
[0m11:57:32.509917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f17e3435-fd48-48ca-8e30-7dd768386db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4092b31c0>]}
[0m11:57:32.510773 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:57:32.520998 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m11:57:32.589015 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m11:57:32.589722 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop__customers.sql
[0m11:57:32.590138 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m11:57:32.590518 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m11:57:32.590858 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m11:57:32.615020 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__customers.sql
[0m11:57:32.631249 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m11:57:32.654252 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_coffee_shop_customers' in the 'models' section of file 'models/staging/coffee_shop/customers_test.yml'
[0m11:57:32.696015 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_coffee_shop_monthly_orders' in the 'models' section of file 'models/schema.yml'
[0m11:57:32.706418 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop.stg_coffee_shop_monthly__orders' (models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql) depends on a node named 'stg_coffee_shop_customers' which was not found
[0m11:57:32.707270 [debug] [MainThread]: Command `dbt run` failed at 11:57:32.707156 after 1.35 seconds
[0m11:57:32.707661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb40c226bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4090a6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb40924a2c0>]}
[0m11:57:32.708070 [debug] [MainThread]: Flushing usage events
[0m12:01:29.670231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31efecab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ee993d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ee993be0>]}


============================== 12:01:29.672453 | 8baee451-ed17-4c31-aaa6-81cbc407f33f ==============================
[0m12:01:29.672453 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:01:29.673153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:01:29.969586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8baee451-ed17-4c31-aaa6-81cbc407f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ece86dd0>]}
[0m12:01:29.985403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8baee451-ed17-4c31-aaa6-81cbc407f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31eceb2050>]}
[0m12:01:29.986112 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:01:29.996195 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:01:30.017590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:01:30.017965 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:01:30.023629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8baee451-ed17-4c31-aaa6-81cbc407f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ecc6e560>]}
[0m12:01:30.030320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8baee451-ed17-4c31-aaa6-81cbc407f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ece3a230>]}
[0m12:01:30.030854 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m12:01:30.031337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8baee451-ed17-4c31-aaa6-81cbc407f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ece3a260>]}
[0m12:01:30.032627 [info ] [MainThread]: 
[0m12:01:30.033470 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:01:30.034464 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:01:30.034877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:33.718249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m12:01:33.718829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:33.958192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8baee451-ed17-4c31-aaa6-81cbc407f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ece39330>]}
[0m12:01:33.959037 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:01:33.959659 [info ] [MainThread]: 
[0m12:01:33.971109 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m12:01:33.971645 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop_customers ............... [RUN]
[0m12:01:33.972468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop_customers)
[0m12:01:33.973331 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m12:01:33.977794 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m12:01:33.979271 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 12:01:33.973847 => 12:01:33.978965
[0m12:01:33.979704 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m12:01:34.013175 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m12:01:34.014082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:34.014522 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
),

renamed as (
  select *
  from source
)

select *
from renamed;


[0m12:01:34.782860 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1d3baca6-a562-425a-b51b-a25bc0d90c1e&page=queryresults
[0m12:01:34.800912 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 12:01:33.980022 => 12:01:34.800709
[0m12:01:34.801653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baee451-ed17-4c31-aaa6-81cbc407f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31eceb1bd0>]}
[0m12:01:34.802246 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_customers .......... [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m12:01:34.803031 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m12:01:34.803952 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:01:34.804512 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.stg_coffee_shop_monthly_orders .......... [RUN]
[0m12:01:34.805354 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly_orders'
[0m12:01:34.805756 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:01:34.812382 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m12:01:34.813234 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (compile): 12:01:34.805992 => 12:01:34.812864
[0m12:01:34.813641 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:01:34.816364 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_monthly_orders"
[0m12:01:34.817001 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:01:34.817469 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop_monthly_orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_monthly_orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly_orders`
  OPTIONS()
  as select
	
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`stg_coffee_shop_customers`;


[0m12:01:35.905437 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:59b67da2-b20a-4d6d-b978-de613affa654&page=queryresults
[0m12:01:35.907708 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly_orders (execute): 12:01:34.813879 => 12:01:35.907509
[0m12:01:35.908423 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8baee451-ed17-4c31-aaa6-81cbc407f33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ecc619c0>]}
[0m12:01:35.909036 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_monthly_orders ..... [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m12:01:35.909825 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly_orders
[0m12:01:35.911508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:35.911804 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m12:01:35.912074 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly_orders' was properly closed.
[0m12:01:35.912393 [info ] [MainThread]: 
[0m12:01:35.912832 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 5.88 seconds (5.88s).
[0m12:01:35.913965 [debug] [MainThread]: Command end result
[0m12:01:35.922033 [info ] [MainThread]: 
[0m12:01:35.922672 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:01:35.923137 [info ] [MainThread]: 
[0m12:01:35.923643 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:01:35.924366 [debug] [MainThread]: Command `dbt run` succeeded at 12:01:35.924261 after 6.26 seconds
[0m12:01:35.924722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31efecab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ef951e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ece8d7b0>]}
[0m12:01:35.925098 [debug] [MainThread]: Flushing usage events
[0m12:02:43.592748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e9a8ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e85bfd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e85bfc40>]}


============================== 12:02:43.595466 | 47eaa882-73ec-4ee1-8dbe-bf6700c9c42b ==============================
[0m12:02:43.595466 [info ] [MainThread]: Running with dbt=1.5.2
[0m12:02:43.596124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:02:43.902627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47eaa882-73ec-4ee1-8dbe-bf6700c9c42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e6ad3820>]}
[0m12:02:43.918921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47eaa882-73ec-4ee1-8dbe-bf6700c9c42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e6aa77c0>]}
[0m12:02:43.919504 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m12:02:43.928993 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m12:02:43.954490 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m12:02:43.955060 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m12:02:43.955437 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop__customers.sql
[0m12:02:43.955791 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m12:02:43.956189 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m12:02:43.998039 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m12:02:44.017461 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__customers.sql
[0m12:02:44.037357 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_coffee_shop_customers' in the 'models' section of file 'models/staging/coffee_shop/customers_test.yml'
[0m12:02:44.071715 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_coffee_shop_monthly_orders' in the 'models' section of file 'models/schema.yml'
[0m12:02:44.081576 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop.stg_coffee_shop_monthly__orders' (models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql) depends on a node named 'stg_coffee_shop_customers' which was not found
[0m12:02:44.082394 [debug] [MainThread]: Command `dbt run` failed at 12:02:44.082251 after 0.50 seconds
[0m12:02:44.082901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e9a8ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e68e3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2e68d6b00>]}
[0m12:02:44.083390 [debug] [MainThread]: Flushing usage events
[0m11:28:42.730405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e75db6c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e74897dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e74897ca0>]}


============================== 11:28:42.741973 | 0d302c2c-faba-4a1f-b76c-e9485f910a60 ==============================
[0m11:28:42.741973 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:28:42.742645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'profiles_dir': '/home/vscode/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:28:43.810766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d302c2c-faba-4a1f-b76c-e9485f910a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e72d81b10>]}
[0m11:28:43.830581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d302c2c-faba-4a1f-b76c-e9485f910a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e72db7250>]}
[0m11:28:43.831189 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:28:43.840535 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m11:28:43.893684 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m11:28:43.894147 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop__customers.sql
[0m11:28:43.894531 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m11:28:43.894888 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m11:28:43.895369 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m11:28:43.928729 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__customers.sql
[0m11:28:43.941802 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m11:28:43.954757 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_coffee_shop_monthly_orders' in the 'models' section of file 'models/schema.yml'
[0m11:28:43.984375 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_coffee_shop_customers' in the 'models' section of file 'models/staging/coffee_shop/customers_test.yml'
[0m11:28:44.000036 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop.stg_coffee_shop_monthly__orders' (models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql) depends on a node named 'stg_coffee_shop_customers' which was not found
[0m11:28:44.000799 [debug] [MainThread]: Command `dbt run` failed at 11:28:44.000689 after 1.28 seconds
[0m11:28:44.001202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e75db6c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e72baa4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e72d4e4d0>]}
[0m11:28:44.001621 [debug] [MainThread]: Flushing usage events
[0m11:29:51.133846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c95f9ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c94a97dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c94a97ca0>]}


============================== 11:29:51.136054 | 41054238-7fae-4ec0-850e-512261f043b6 ==============================
[0m11:29:51.136054 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:29:51.136686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/vscode/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:29:51.414592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41054238-7fae-4ec0-850e-512261f043b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c92f7afb0>]}
[0m11:29:51.430647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41054238-7fae-4ec0-850e-512261f043b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c92fb53c0>]}
[0m11:29:51.431200 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:29:51.440343 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m11:29:51.460570 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m11:29:51.461040 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/schema.yml
[0m11:29:51.461411 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop__customers.sql
[0m11:29:51.461770 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m11:29:51.462144 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m11:29:51.462445 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m11:29:51.484945 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__customers.sql
[0m11:29:51.498008 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m11:29:51.521341 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_coffee_shop_monthly_orders' in the 'models' section of file 'models/staging/coffee_shop/schema.yml'
[0m11:29:51.569480 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_coffee_shop_customers' in the 'models' section of file 'models/staging/coffee_shop/customers_test.yml'
[0m11:29:51.584322 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop.stg_coffee_shop_monthly__orders' (models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql) depends on a node named 'stg_coffee_shop_customers' which was not found
[0m11:29:51.585340 [debug] [MainThread]: Command `dbt run` failed at 11:29:51.585175 after 0.46 seconds
[0m11:29:51.585878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c95f9ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c92da6740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c92f4e770>]}
[0m11:29:51.586633 [debug] [MainThread]: Flushing usage events
[0m11:36:21.672205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f217a32abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2178db7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2178db7c70>]}


============================== 11:36:21.674349 | 27f18c52-8fb8-4255-9ee5-5a322f5baeb3 ==============================
[0m11:36:21.674349 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:36:21.675014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:36:21.944010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27f18c52-8fb8-4255-9ee5-5a322f5baeb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21772cba60>]}
[0m11:36:21.967815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27f18c52-8fb8-4255-9ee5-5a322f5baeb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f217729f6a0>]}
[0m11:36:21.968414 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:36:21.977223 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m11:36:21.996576 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m11:36:21.996994 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop__customers.sql
[0m11:36:21.997338 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m11:36:21.997713 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/schema.yml
[0m11:36:21.998063 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m11:36:21.998390 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m11:36:22.018481 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__customers.sql
[0m11:36:22.029912 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m11:36:22.041831 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_coffee_shop_monthly_orders' in the 'models' section of file 'models/staging/coffee_shop/schema.yml'
[0m11:36:22.068138 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_coffee_shop_customers' in the 'models' section of file 'models/staging/coffee_shop/customers_test.yml'
[0m11:36:22.079856 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop.stg_coffee_shop_monthly__orders' (models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql) depends on a node named 'stg_coffee_shop_customers' which was not found
[0m11:36:22.080540 [debug] [MainThread]: Command `dbt run` failed at 11:36:22.080438 after 0.41 seconds
[0m11:36:22.080877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f217a32abf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21770ca890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21770768c0>]}
[0m11:36:22.081228 [debug] [MainThread]: Flushing usage events
[0m11:40:40.619819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe021756b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0203cfcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0203cfbb0>]}


============================== 11:40:40.621976 | 6ca18bab-1baf-4b93-9d3b-8d29fd5c145c ==============================
[0m11:40:40.621976 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:40:40.622636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:40:40.915360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ca18bab-1baf-4b93-9d3b-8d29fd5c145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe01e8b6fb0>]}
[0m11:40:40.931798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ca18bab-1baf-4b93-9d3b-8d29fd5c145c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe01e8f13f0>]}
[0m11:40:40.932410 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:40:40.942542 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m11:40:40.963783 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m11:40:40.964252 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m11:40:40.964628 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop__customers.sql
[0m11:40:40.965030 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/schema.yml
[0m11:40:40.965406 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m11:40:40.965707 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m11:40:40.987732 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m11:40:40.999432 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__customers.sql
[0m11:40:41.045507 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_coffee_shop_customers' in the 'models' section of file 'models/staging/coffee_shop/customers_test.yml'
[0m11:40:41.059812 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop.stg_coffee_shop_monthly__orders' (models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql) depends on a node named 'stg_coffee_shop_customers' which was not found
[0m11:40:41.060558 [debug] [MainThread]: Command `dbt run` failed at 11:40:41.060449 after 0.45 seconds
[0m11:40:41.060922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe021756b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe01e6e26e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe01e7fc040>]}
[0m11:40:41.061296 [debug] [MainThread]: Flushing usage events
[0m11:42:07.681927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3761602c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37600c3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37600c3ca0>]}


============================== 11:42:07.683987 | c73f39f4-af55-49d4-88d8-3b03281c9319 ==============================
[0m11:42:07.683987 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:42:07.684596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:42:07.967936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c73f39f4-af55-49d4-88d8-3b03281c9319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375e5b1ab0>]}
[0m11:42:07.983732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c73f39f4-af55-49d4-88d8-3b03281c9319', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375e5e7310>]}
[0m11:42:07.984310 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:42:07.993549 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m11:42:08.013568 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 1 files changed.
[0m11:42:08.014025 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop__customers.sql
[0m11:42:08.014437 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/schema.yml
[0m11:42:08.014817 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m11:42:08.015231 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/customers_test.yml
[0m11:42:08.015558 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m11:42:08.015855 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m11:42:08.037788 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__customers.sql
[0m11:42:08.048471 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m11:42:08.096753 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop.stg_coffee_shop_monthly__orders' (models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql) depends on a node named 'stg_coffee_shop_customers' which was not found
[0m11:42:08.097455 [debug] [MainThread]: Command `dbt run` failed at 11:42:08.097352 after 0.42 seconds
[0m11:42:08.097795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3761602c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375e3d6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f375e382560>]}
[0m11:42:08.098139 [debug] [MainThread]: Flushing usage events
[0m11:42:41.487683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb096f6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb081b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb081b7c70>]}


============================== 11:42:41.490015 | 36eb70c8-7eed-4dd9-bc76-543c51b267ef ==============================
[0m11:42:41.490015 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:42:41.490715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:42:41.771600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36eb70c8-7eed-4dd9-bc76-543c51b267ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb066af5b0>]}
[0m11:42:41.787210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36eb70c8-7eed-4dd9-bc76-543c51b267ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb066db160>]}
[0m11:42:41.787747 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:42:41.797091 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m11:42:41.817437 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 1 files changed.
[0m11:42:41.817909 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/schema.yml
[0m11:42:41.818277 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m11:42:41.818648 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop__customers.sql
[0m11:42:41.819079 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/coffee_shop/customers_test.yml
[0m11:42:41.819419 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_monthly_orders.sql
[0m11:42:41.819711 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m11:42:41.842086 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_monthly__orders.sql
[0m11:42:41.853594 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__customers.sql
[0m11:42:41.913218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36eb70c8-7eed-4dd9-bc76-543c51b267ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0651ee00>]}
[0m11:42:41.918695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36eb70c8-7eed-4dd9-bc76-543c51b267ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0659e3b0>]}
[0m11:42:41.919109 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m11:42:41.919576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36eb70c8-7eed-4dd9-bc76-543c51b267ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0659e4a0>]}
[0m11:42:41.920781 [info ] [MainThread]: 
[0m11:42:41.921527 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:42:41.922434 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:42:41.922875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:45.295564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m11:42:45.296132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:45.501441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36eb70c8-7eed-4dd9-bc76-543c51b267ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb0659d540>]}
[0m11:42:45.502102 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:42:45.502581 [info ] [MainThread]: 
[0m11:42:45.513649 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop__customers
[0m11:42:45.514123 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop__customers .............. [RUN]
[0m11:42:45.514820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop__customers)
[0m11:42:45.515178 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop__customers
[0m11:42:45.520991 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__customers"
[0m11:42:45.521963 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (compile): 11:42:45.515412 => 11:42:45.521751
[0m11:42:45.522366 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop__customers
[0m11:42:45.548582 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__customers"
[0m11:42:45.549178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:45.549594 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop__customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop__customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
),

renamed as (
  select
    
    id,
    name,
    email
  from source
)

select *
from renamed;


[0m11:42:46.390540 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:52c39f18-19d0-4a2b-8f2c-9978a7e70f2b&page=queryresults
[0m11:42:46.402410 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (execute): 11:42:45.522697 => 11:42:46.402218
[0m11:42:46.403100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36eb70c8-7eed-4dd9-bc76-543c51b267ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb05fbee30>]}
[0m11:42:46.403687 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_marcel.stg_coffee_shop__customers ......... [[32mCREATE VIEW (0 processed)[0m in 0.89s]
[0m11:42:46.404382 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop__customers
[0m11:42:46.405192 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly__orders
[0m11:42:46.405607 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.stg_coffee_shop_monthly__orders ......... [RUN]
[0m11:42:46.406324 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly__orders'
[0m11:42:46.406709 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly__orders
[0m11:42:46.409068 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly__orders"
[0m11:42:46.409702 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly__orders (compile): 11:42:46.406924 => 11:42:46.409447
[0m11:42:46.410189 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly__orders
[0m11:42:46.414321 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_monthly__orders"
[0m11:42:46.415332 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:42:46.415873 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop_monthly__orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_monthly__orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly__orders`
  OPTIONS()
  as select
	
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`stg_coffee_shop__customers`;


[0m11:42:47.180734 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7168dfe4-7868-44c0-a029-ddcf79f0171a&page=queryresults
[0m11:42:47.182592 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly__orders (execute): 11:42:46.410550 => 11:42:47.182374
[0m11:42:47.183266 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36eb70c8-7eed-4dd9-bc76-543c51b267ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb05fdf700>]}
[0m11:42:47.183843 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_monthly__orders .... [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m11:42:47.184560 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly__orders
[0m11:42:47.186228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:47.186544 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__customers' was properly closed.
[0m11:42:47.186848 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly__orders' was properly closed.
[0m11:42:47.187190 [info ] [MainThread]: 
[0m11:42:47.187588 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 5.27 seconds (5.27s).
[0m11:42:47.188400 [debug] [MainThread]: Command end result
[0m11:42:47.195187 [info ] [MainThread]: 
[0m11:42:47.195742 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:42:47.196177 [info ] [MainThread]: 
[0m11:42:47.196652 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:42:47.197337 [debug] [MainThread]: Command `dbt run` succeeded at 11:42:47.197233 after 5.72 seconds
[0m11:42:47.197682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb096f6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb095b95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb066b6830>]}
[0m11:42:47.198039 [debug] [MainThread]: Flushing usage events
[0m11:55:54.958891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80da5a2b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d90c3dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d90c3d60>]}


============================== 11:55:54.960876 | 75bcb2da-6b61-454a-bcdb-19e8929bf20e ==============================
[0m11:55:54.960876 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:55:54.961469 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:55:55.275190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75bcb2da-6b61-454a-bcdb-19e8929bf20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d75df9d0>]}
[0m11:55:55.290027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75bcb2da-6b61-454a-bcdb-19e8929bf20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d75af550>]}
[0m11:55:55.290539 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m11:55:55.299822 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m11:55:55.319807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:55.320086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:55.324640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75bcb2da-6b61-454a-bcdb-19e8929bf20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d73a80d0>]}
[0m11:55:55.325837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75bcb2da-6b61-454a-bcdb-19e8929bf20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d73769e0>]}
[0m11:55:55.326219 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m11:55:55.326728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75bcb2da-6b61-454a-bcdb-19e8929bf20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d7376a70>]}
[0m11:55:55.327922 [info ] [MainThread]: 
[0m11:55:55.328604 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:55:55.329433 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_marcel'
[0m11:55:55.329797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:56.119440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75bcb2da-6b61-454a-bcdb-19e8929bf20e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d7376b00>]}
[0m11:55:56.120213 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:55:56.120696 [info ] [MainThread]: 
[0m11:55:56.124008 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop__customers
[0m11:55:56.124632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop__customers)
[0m11:55:56.125003 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop__customers
[0m11:55:56.128011 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__customers"
[0m11:55:56.129085 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (compile): 11:55:56.125330 => 11:55:56.128865
[0m11:55:56.129493 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop__customers
[0m11:55:56.130286 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (execute): 11:55:56.130071 => 11:55:56.130087
[0m11:55:56.131155 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop__customers
[0m11:55:56.131975 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly__orders
[0m11:55:56.132424 [debug] [Thread-4 (]: Began running node test.coffee_shop.accepted_values_stg_coffee_shop__customers_id__1__2__3.a8431e137b
[0m11:55:56.134387 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.accepted_values_stg_coffee_shop__customers_id__1__2__3.a8431e137b'
[0m11:55:56.134804 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.accepted_values_stg_coffee_shop__customers_id__1__2__3.a8431e137b
[0m11:55:56.133751 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_stg_coffee_shop__customers_id.65381787d4
[0m11:55:56.133403 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_stg_coffee_shop__customers_id.2bf5aa959e
[0m11:55:56.133049 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly__orders'
[0m11:55:56.145038 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.accepted_values_stg_coffee_shop__customers_id__1__2__3.a8431e137b"
[0m11:55:56.145719 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_stg_coffee_shop__customers_id.65381787d4'
[0m11:55:56.146407 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_stg_coffee_shop__customers_id.2bf5aa959e'
[0m11:55:56.147853 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_stg_coffee_shop__customers_id.2bf5aa959e
[0m11:55:56.147397 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_stg_coffee_shop__customers_id.65381787d4
[0m11:55:56.146820 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly__orders
[0m11:55:56.148466 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop__customers_id__1__2__3.a8431e137b (compile): 11:55:56.135049 => 11:55:56.148171
[0m11:55:56.156213 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_stg_coffee_shop__customers_id.2bf5aa959e"
[0m11:55:56.161760 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_stg_coffee_shop__customers_id.65381787d4"
[0m11:55:56.163912 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly__orders"
[0m11:55:56.164385 [debug] [Thread-4 (]: Began executing node test.coffee_shop.accepted_values_stg_coffee_shop__customers_id__1__2__3.a8431e137b
[0m11:55:56.165081 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop__customers_id.2bf5aa959e (compile): 11:55:56.148773 => 11:55:56.164815
[0m11:55:56.165927 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly__orders (compile): 11:55:56.162050 => 11:55:56.165651
[0m11:55:56.166564 [debug] [Thread-4 (]: Timing info for test.coffee_shop.accepted_values_stg_coffee_shop__customers_id__1__2__3.a8431e137b (execute): 11:55:56.166264 => 11:55:56.166277
[0m11:55:56.168567 [debug] [Thread-4 (]: Finished running node test.coffee_shop.accepted_values_stg_coffee_shop__customers_id__1__2__3.a8431e137b
[0m11:55:56.166976 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop__customers_id.65381787d4 (compile): 11:55:56.156498 => 11:55:56.166791
[0m11:55:56.167744 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly__orders
[0m11:55:56.169616 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly__orders (execute): 11:55:56.169392 => 11:55:56.169402
[0m11:55:56.169124 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_stg_coffee_shop__customers_id.65381787d4
[0m11:55:56.167367 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_stg_coffee_shop__customers_id.2bf5aa959e
[0m11:55:56.170402 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly__orders
[0m11:55:56.170951 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_stg_coffee_shop__customers_id.65381787d4 (execute): 11:55:56.170748 => 11:55:56.170756
[0m11:55:56.171428 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_stg_coffee_shop__customers_id.2bf5aa959e (execute): 11:55:56.171212 => 11:55:56.171222
[0m11:55:56.172053 [debug] [Thread-8 (]: Began running node test.coffee_shop.relationships_stg_coffee_shop_monthly__orders_customer_id__id__ref_stg_coffee_shop__customers_.882c0df4b1
[0m11:55:56.174355 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly__orders_customer_id__id__ref_stg_coffee_shop__customers_.882c0df4b1'
[0m11:55:56.174748 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.relationships_stg_coffee_shop_monthly__orders_customer_id__id__ref_stg_coffee_shop__customers_.882c0df4b1
[0m11:55:56.173703 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_stg_coffee_shop__customers_id.2bf5aa959e
[0m11:55:56.172907 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_stg_coffee_shop__customers_id.65381787d4
[0m11:55:56.182725 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.relationships_stg_coffee_shop_monthly__orders_customer_id__id__ref_stg_coffee_shop__customers_.882c0df4b1"
[0m11:55:56.183757 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly__orders_customer_id__id__ref_stg_coffee_shop__customers_.882c0df4b1 (compile): 11:55:56.174980 => 11:55:56.183503
[0m11:55:56.184146 [debug] [Thread-8 (]: Began executing node test.coffee_shop.relationships_stg_coffee_shop_monthly__orders_customer_id__id__ref_stg_coffee_shop__customers_.882c0df4b1
[0m11:55:56.184607 [debug] [Thread-8 (]: Timing info for test.coffee_shop.relationships_stg_coffee_shop_monthly__orders_customer_id__id__ref_stg_coffee_shop__customers_.882c0df4b1 (execute): 11:55:56.184384 => 11:55:56.184394
[0m11:55:56.185383 [debug] [Thread-8 (]: Finished running node test.coffee_shop.relationships_stg_coffee_shop_monthly__orders_customer_id__id__ref_stg_coffee_shop__customers_.882c0df4b1
[0m11:55:56.186442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:56.186763 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__customers' was properly closed.
[0m11:55:56.187024 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly__orders' was properly closed.
[0m11:55:56.187281 [debug] [MainThread]: Connection 'test.coffee_shop.accepted_values_stg_coffee_shop__customers_id__1__2__3.a8431e137b' was properly closed.
[0m11:55:56.187538 [debug] [MainThread]: Connection 'test.coffee_shop.unique_stg_coffee_shop__customers_id.65381787d4' was properly closed.
[0m11:55:56.187787 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_stg_coffee_shop__customers_id.2bf5aa959e' was properly closed.
[0m11:55:56.188036 [debug] [MainThread]: Connection 'test.coffee_shop.relationships_stg_coffee_shop_monthly__orders_customer_id__id__ref_stg_coffee_shop__customers_.882c0df4b1' was properly closed.
[0m11:55:56.189123 [debug] [MainThread]: Command end result
[0m11:55:56.233292 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m11:55:56.233690 [info ] [MainThread]: Building catalog
[0m11:55:56.234746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:56.728877 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m11:55:56.729508 [debug] [ThreadPool]: Acquiring new bigquery connection 'analytics-engineers-club.information_schema'
[0m11:55:56.747634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:56.748013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:56.748634 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_marcel`.__TABLES__
        where (upper(dataset_id) = upper('dbt_marcel'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_marcel`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m11:55:56.749542 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m11:55:59.321154 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6237aa57-55e9-4c43-a4dd-f447859206d8&page=queryresults
[0m11:55:59.328571 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e5911d5f-6b9a-4154-abe1-0c0d7b99c537&page=queryresults
[0m11:55:59.347076 [info ] [MainThread]: Catalog written to /workspaces/aec-self-study-marcel/coffee_shop_marcel/target/catalog.json
[0m11:55:59.348051 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:55:59.347947 after 4.39 seconds
[0m11:55:59.348342 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:55:59.348606 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m11:55:59.348871 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.
[0m11:55:59.349191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80da5a2b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80db9c3bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80d738b730>]}
[0m11:55:59.349532 [debug] [MainThread]: Flushing usage events
[0m11:56:14.743733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c481c6bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c46c97dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c46c97c40>]}


============================== 11:56:14.745726 | 61f6aca8-8873-491c-b864-3b149dc1aaf9 ==============================
[0m11:56:14.745726 [info ] [MainThread]: Running with dbt=1.5.2
[0m11:56:14.746347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'profiles_dir': '/home/vscode/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:56:15.007344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61f6aca8-8873-491c-b864-3b149dc1aaf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c451aba00>]}
[0m11:56:15.023110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61f6aca8-8873-491c-b864-3b149dc1aaf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c45177760>]}
[0m21:58:35.321009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fc1fac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fac97dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fac97ca0>]}


============================== 21:58:35.333031 | 26e330bb-06b3-4fbd-a351-9eded5c497a8 ==============================
[0m21:58:35.333031 [info ] [MainThread]: Running with dbt=1.5.2
[0m21:58:35.333682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/vscode/.dbt', 'log_path': '/workspaces/aec-self-study-marcel/coffee_shop_marcel/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m21:58:36.470178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26e330bb-06b3-4fbd-a351-9eded5c497a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f91a7be0>]}
[0m21:58:36.497874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26e330bb-06b3-4fbd-a351-9eded5c497a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f917b070>]}
[0m21:58:36.498884 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:58:36.513518 [debug] [MainThread]: checksum: 2435fa7be9fcfa6ffe15da8f202ddc09867bf7d6308330064299ccb85c8646b5, vars: {}, profile: , target: , version: 1.5.2
[0m21:58:36.574257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:58:36.574586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:58:36.581057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26e330bb-06b3-4fbd-a351-9eded5c497a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f8f740d0>]}
[0m21:58:36.587812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26e330bb-06b3-4fbd-a351-9eded5c497a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f9142b60>]}
[0m21:58:36.588255 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 357 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m21:58:36.588730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26e330bb-06b3-4fbd-a351-9eded5c497a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f9142bf0>]}
[0m21:58:36.589974 [info ] [MainThread]: 
[0m21:58:36.590723 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:58:36.591645 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m21:58:36.592086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:40.037995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_aec-students, now list_aec-students_dbt_marcel)
[0m21:58:40.038876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:40.290229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26e330bb-06b3-4fbd-a351-9eded5c497a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f9142290>]}
[0m21:58:40.290923 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m21:58:40.291382 [info ] [MainThread]: 
[0m21:58:40.303354 [debug] [Thread-1 (]: Began running node model.coffee_shop.stg_coffee_shop__customers
[0m21:58:40.303959 [info ] [Thread-1 (]: 1 of 2 START sql view model dbt_marcel.stg_coffee_shop__customers .............. [RUN]
[0m21:58:40.304673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_aec-students_dbt_marcel, now model.coffee_shop.stg_coffee_shop__customers)
[0m21:58:40.305053 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.stg_coffee_shop__customers
[0m21:58:40.307993 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__customers"
[0m21:58:40.308975 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (compile): 21:58:40.305286 => 21:58:40.308608
[0m21:58:40.309443 [debug] [Thread-1 (]: Began executing node model.coffee_shop.stg_coffee_shop__customers
[0m21:58:40.336779 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__customers"
[0m21:58:40.337387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:40.337806 [debug] [Thread-1 (]: On model.coffee_shop.stg_coffee_shop__customers: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__customers"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop__customers`
  OPTIONS()
  as with source as (
  select * from `analytics-engineers-club`.`coffee_shop`.`customers`
),

renamed as (
  select
    
    id,
    name,
    email
  from source
)

select *
from renamed;


[0m21:58:41.184942 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a4b86996-d82a-4cec-83b1-1eb58c994ed3&page=queryresults
[0m21:58:41.203808 [debug] [Thread-1 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (execute): 21:58:40.309851 => 21:58:41.203608
[0m21:58:41.204536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26e330bb-06b3-4fbd-a351-9eded5c497a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f9192f20>]}
[0m21:58:41.205111 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dbt_marcel.stg_coffee_shop__customers ......... [[32mCREATE VIEW (0 processed)[0m in 0.90s]
[0m21:58:41.205836 [debug] [Thread-1 (]: Finished running node model.coffee_shop.stg_coffee_shop__customers
[0m21:58:41.206691 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_monthly__orders
[0m21:58:41.207178 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_marcel.stg_coffee_shop_monthly__orders ......... [RUN]
[0m21:58:41.208013 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_monthly__orders'
[0m21:58:41.208402 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_monthly__orders
[0m21:58:41.215209 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_monthly__orders"
[0m21:58:41.215987 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly__orders (compile): 21:58:41.208649 => 21:58:41.215684
[0m21:58:41.216375 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_monthly__orders
[0m21:58:41.219045 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_monthly__orders"
[0m21:58:41.219659 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:58:41.220105 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop_monthly__orders: /* {"app": "dbt", "dbt_version": "1.5.2", "profile_name": "coffee_shop_marcel", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_monthly__orders"} */


  create or replace view `aec-students`.`dbt_marcel`.`stg_coffee_shop_monthly__orders`
  OPTIONS()
  as select
	
	count(*) as new_customers
from `aec-students`.`dbt_marcel`.`stg_coffee_shop__customers`;


[0m21:58:41.975895 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:06ba6d3a-b0fd-4962-b249-edd003c18358&page=queryresults
[0m21:58:41.978027 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_monthly__orders (execute): 21:58:41.216624 => 21:58:41.977838
[0m21:58:41.978709 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26e330bb-06b3-4fbd-a351-9eded5c497a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f9190ee0>]}
[0m21:58:41.979281 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_marcel.stg_coffee_shop_monthly__orders .... [[32mCREATE VIEW (0 processed)[0m in 0.77s]
[0m21:58:41.980028 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_monthly__orders
[0m21:58:41.981702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:41.982016 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__customers' was properly closed.
[0m21:58:41.982318 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_monthly__orders' was properly closed.
[0m21:58:41.982666 [info ] [MainThread]: 
[0m21:58:41.983133 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 5.39 seconds (5.39s).
[0m21:58:41.984034 [debug] [MainThread]: Command end result
[0m21:58:41.990909 [info ] [MainThread]: 
[0m21:58:41.991418 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:58:41.991872 [info ] [MainThread]: 
[0m21:58:41.992346 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:58:41.993023 [debug] [MainThread]: Command `dbt run` succeeded at 21:58:41.992921 after 6.69 seconds
[0m21:58:41.993375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13fc1fac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f917b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13f8f5b8e0>]}
[0m21:58:41.993739 [debug] [MainThread]: Flushing usage events
